2025-02-19 14:39 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1050, "Table 'vetusdt-f' already exists")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 35, in change_db_data
    conn.execute(text(text_msg))
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1050, "Table 'vetusdt-f' already exists")
[SQL: CREATE TABLE `crypto_data`.`vetusdt-f`(
                `Datetime` DATETIME NOT NULL,
                `Open` FLOAT NOT NULL,
                `High` FLOAT NOT NULL,
                `Low` FLOAT NOT NULL,
                `Close` FLOAT NOT NULL,
                `Volume` FLOAT NOT NULL,
                `close_time` FLOAT NOT NULL,
                `quote_av` FLOAT NOT NULL,
                `trades` FLOAT NOT NULL,
                `tb_base_av` FLOAT NOT NULL,
                `tb_quote_av` FLOAT NOT NULL,
                `ignore` FLOAT NOT NULL,
                PRIMARY KEY(`Datetime`)
                );]
(Background on this error at: https://sqlalche.me/e/20/e3q8)

2025-02-19 14:39 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2020-02-14 08:03:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2020-02-14 08:03:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2020-02-14 08:03:00', 'Open': 0.007731, 'High': 0.007731, 'Low': 0.007689, 'Close': 0.007689, 'Volume': 70074.0, 'close_time': 1581670000000.0, 'quote_av': 540.701, 'trades': 5.0, 'tb_base_av': 50064.0, 'tb_quote_av': 386.244, 'ignore': 0.0}, {'Datetime': '2020-02-14 08:04:00', 'Open': 0.007689, 'High': 0.007729, 'Low': 0.007685, 'Close': 0.007729, 'Volume': 838629.0, 'close_time': 1581670000000.0, 'quote_av': 6464.46, 'trades': 41.0, 'tb_base_av': 663954.0, 'tb_quote_av': 5121.04, 'ignore': 0.0}, {'Datetime': '2020-02-14 08:05:00', 'Open': 0.007729, 'High': 0.007736, 'Low': 0.007683, 'Close': 0.007724, 'Volume': 602488.0, 'close_time': 1581670000000.0, 'quote_av': 4653.36, 'trades': 69.0, 'tb_base_av': 499488.0, 'tb_quote_av': 3860.27, 'ignore': 0.0}, {'Datetime': '2020-02-14 08:06:00', 'Open': 0.007724, 'High': 0.007749, 'Low': 0.007701, 'Close': 0.007747, 'Volume': 376875.0, 'close_time': 1581670000000.0, 'quote_av': 2908.07, 'trades': 95.0, 'tb_base_av': 144352.0, 'tb_quote_av': 1115.35, 'ignore': 0.0}, {'Datetime': '2020-02-14 08:07:00', 'Open': 0.007747, 'High': 0.007748, 'Low': 0.007746, 'Close': 0.007748, 'Volume': 350974.0, 'close_time': 1581670000000.0, 'quote_av': 2718.67, 'trades': 116.0, 'tb_base_av': 16623.0, 'tb_quote_av': 128.786, 'ignore': 0.0}, {'Datetime': '2020-02-14 08:08:00', 'Open': 0.007748, 'High': 0.007749, 'Low': 0.007719, 'Close': 0.007725, 'Volume': 783338.0, 'close_time': 1581670000000.0, 'quote_av': 6067.9, 'trades': 122.0, 'tb_base_av': 114663.0, 'tb_quote_av': 888.42, 'ignore': 0.0}, {'Datetime': '2020-02-14 08:09:00', 'Open': 0.007725, 'High': 0.007725, 'Low': 0.007709, 'Close': 0.007713, 'Volume': 236534.0, 'close_time': 1581670000000.0, 'quote_av': 1825.12, 'trades': 99.0, 'tb_base_av': 164467.0, 'tb_quote_av': 1269.09, 'ignore': 0.0}, {'Datetime': '2020-02-14 08:10:00', 'Open': 0.007714, 'High': 0.007725, 'Low': 0.007714, 'Close': 0.007716, 'Volume': 107248.0, 'close_time': 1581670000000.0, 'quote_av': 827.355, 'trades': 27.0, 'tb_base_av': 104349.0, 'tb_quote_av': 804.989, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2020-03-20 01:21:00', 'Open': 0.002916, 'High': 0.002916, 'Low': 0.002916, 'Close': 0.002916, 'Volume': 17925.0, 'close_time': 1584670000000.0, 'quote_av': 52.2693, 'trades': 2.0, 'tb_base_av': 17925.0, 'tb_quote_av': 52.2693, 'ignore': 0.0}, {'Datetime': '2020-03-20 01:22:00', 'Open': 0.002916, 'High': 0.002916, 'Low': 0.002911, 'Close': 0.002911, 'Volume': 33823.0, 'close_time': 1584670000000.0, 'quote_av': 98.5563, 'trades': 4.0, 'tb_base_av': 31778.0, 'tb_quote_av': 92.6013, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:39 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2020-03-20 01:23:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2020-03-20 01:23:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2020-03-20 01:23:00', 'Open': 0.002908, 'High': 0.002911, 'Low': 0.002908, 'Close': 0.002911, 'Volume': 45012.0, 'close_time': 1584670000000.0, 'quote_av': 131.017, 'trades': 10.0, 'tb_base_av': 40664.0, 'tb_quote_av': 118.373, 'ignore': 0.0}, {'Datetime': '2020-03-20 01:24:00', 'Open': 0.002909, 'High': 0.002909, 'Low': 0.002909, 'Close': 0.002909, 'Volume': 21338.0, 'close_time': 1584670000000.0, 'quote_av': 62.0722, 'trades': 2.0, 'tb_base_av': 0.0, 'tb_quote_av': 0.0, 'ignore': 0.0}, {'Datetime': '2020-03-20 01:25:00', 'Open': 0.002908, 'High': 0.002908, 'Low': 0.002904, 'Close': 0.002904, 'Volume': 35182.0, 'close_time': 1584670000000.0, 'quote_av': 102.247, 'trades': 4.0, 'tb_base_av': 7704.0, 'tb_quote_av': 22.4032, 'ignore': 0.0}, {'Datetime': '2020-03-20 01:26:00', 'Open': 0.002907, 'High': 0.002907, 'Low': 0.002907, 'Close': 0.002907, 'Volume': 13909.0, 'close_time': 1584670000000.0, 'quote_av': 40.4335, 'trades': 7.0, 'tb_base_av': 13909.0, 'tb_quote_av': 40.4335, 'ignore': 0.0}, {'Datetime': '2020-03-20 01:27:00', 'Open': 0.002907, 'High': 0.00291, 'Low': 0.002907, 'Close': 0.00291, 'Volume': 45013.0, 'close_time': 1584670000000.0, 'quote_av': 130.931, 'trades': 8.0, 'tb_base_av': 43351.0, 'tb_quote_av': 126.1, 'ignore': 0.0}, {'Datetime': '2020-03-20 01:28:00', 'Open': 0.002907, 'High': 0.002909, 'Low': 0.0029, 'Close': 0.0029, 'Volume': 128246.0, 'close_time': 1584670000000.0, 'quote_av': 372.182, 'trades': 7.0, 'tb_base_av': 12060.0, 'tb_quote_av': 35.0825, 'ignore': 0.0}, {'Datetime': '2020-03-20 01:29:00', 'Open': 0.002897, 'High': 0.002897, 'Low': 0.00288, 'Close': 0.00288, 'Volume': 678332.0, 'close_time': 1584670000000.0, 'quote_av': 1959.32, 'trades': 28.0, 'tb_base_av': 118801.0, 'tb_quote_av': 343.278, 'ignore': 0.0}, {'Datetime': '2020-03-20 01:30:00', 'Open': 0.002879, 'High': 0.002879, 'Low': 0.002851, 'Close': 0.002851, 'Volume': 1042260.0, 'close_time': 1584670000000.0, 'quote_av': 2988.47, 'trades': 45.0, 'tb_base_av': 305716.0, 'tb_quote_av': 879.231, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2020-04-23 18:41:00', 'Open': 0.00403, 'High': 0.004035, 'Low': 0.00403, 'Close': 0.004032, 'Volume': 529748.0, 'close_time': 1587670000000.0, 'quote_av': 2135.69, 'trades': 15.0, 'tb_base_av': 523431.0, 'tb_quote_av': 2110.22, 'ignore': 0.0}, {'Datetime': '2020-04-23 18:42:00', 'Open': 0.004032, 'High': 0.004032, 'Low': 0.004032, 'Close': 0.004032, 'Volume': 0.0, 'close_time': 1587670000000.0, 'quote_av': 0.0, 'trades': 0.0, 'tb_base_av': 0.0, 'tb_quote_av': 0.0, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:39 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2020-04-23 18:43:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2020-04-23 18:43:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2020-04-23 18:43:00', 'Open': 0.004032, 'High': 0.004032, 'Low': 0.004032, 'Close': 0.004032, 'Volume': 0.0, 'close_time': 1587670000000.0, 'quote_av': 0.0, 'trades': 0.0, 'tb_base_av': 0.0, 'tb_quote_av': 0.0, 'ignore': 0.0}, {'Datetime': '2020-04-23 18:44:00', 'Open': 0.004034, 'High': 0.004034, 'Low': 0.004034, 'Close': 0.004034, 'Volume': 2804.0, 'close_time': 1587670000000.0, 'quote_av': 11.3113, 'trades': 2.0, 'tb_base_av': 2804.0, 'tb_quote_av': 11.3113, 'ignore': 0.0}, {'Datetime': '2020-04-23 18:45:00', 'Open': 0.004034, 'High': 0.004035, 'Low': 0.004034, 'Close': 0.004035, 'Volume': 79490.0, 'close_time': 1587670000000.0, 'quote_av': 320.71, 'trades': 5.0, 'tb_base_av': 79490.0, 'tb_quote_av': 320.71, 'ignore': 0.0}, {'Datetime': '2020-04-23 18:46:00', 'Open': 0.004034, 'High': 0.004036, 'Low': 0.004033, 'Close': 0.004033, 'Volume': 168313.0, 'close_time': 1587670000000.0, 'quote_av': 679.04, 'trades': 6.0, 'tb_base_av': 68313.0, 'tb_quote_av': 275.649, 'ignore': 0.0}, {'Datetime': '2020-04-23 18:47:00', 'Open': 0.004036, 'High': 0.004036, 'Low': 0.004036, 'Close': 0.004036, 'Volume': 41040.0, 'close_time': 1587670000000.0, 'quote_av': 165.637, 'trades': 2.0, 'tb_base_av': 41040.0, 'tb_quote_av': 165.637, 'ignore': 0.0}, {'Datetime': '2020-04-23 18:48:00', 'Open': 0.004036, 'High': 0.004037, 'Low': 0.004036, 'Close': 0.004037, 'Volume': 442303.0, 'close_time': 1587670000000.0, 'quote_av': 1785.5, 'trades': 6.0, 'tb_base_av': 380907.0, 'tb_quote_av': 1537.7, 'ignore': 0.0}, {'Datetime': '2020-04-23 18:49:00', 'Open': 0.004036, 'High': 0.004036, 'Low': 0.004036, 'Close': 0.004036, 'Volume': 59984.0, 'close_time': 1587670000000.0, 'quote_av': 242.095, 'trades': 4.0, 'tb_base_av': 59984.0, 'tb_quote_av': 242.095, 'ignore': 0.0}, {'Datetime': '2020-04-23 18:50:00', 'Open': 0.004037, 'High': 0.004038, 'Low': 0.004037, 'Close': 0.004038, 'Volume': 70045.0, 'close_time': 1587670000000.0, 'quote_av': 282.842, 'trades': 4.0, 'tb_base_av': 70045.0, 'tb_quote_av': 282.842, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2020-05-28 12:01:00', 'Open': 0.005302, 'High': 0.005306, 'Low': 0.005296, 'Close': 0.005301, 'Volume': 1705550.0, 'close_time': 1590670000000.0, 'quote_av': 9039.9, 'trades': 53.0, 'tb_base_av': 277856.0, 'tb_quote_av': 1473.27, 'ignore': 0.0}, {'Datetime': '2020-05-28 12:02:00', 'Open': 0.005301, 'High': 0.005308, 'Low': 0.005294, 'Close': 0.005307, 'Volume': 2461100.0, 'close_time': 1590670000000.0, 'quote_av': 13045.1, 'trades': 101.0, 'tb_base_av': 1446980.0, 'tb_quote_av': 7667.62, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:39 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2020-05-28 12:03:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2020-05-28 12:03:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2020-05-28 12:03:00', 'Open': 0.005308, 'High': 0.005313, 'Low': 0.005305, 'Close': 0.005308, 'Volume': 1973770.0, 'close_time': 1590670000000.0, 'quote_av': 10476.2, 'trades': 50.0, 'tb_base_av': 576164.0, 'tb_quote_av': 3059.02, 'ignore': 0.0}, {'Datetime': '2020-05-28 12:04:00', 'Open': 0.005307, 'High': 0.005307, 'Low': 0.0053, 'Close': 0.005303, 'Volume': 427924.0, 'close_time': 1590670000000.0, 'quote_av': 2269.7, 'trades': 23.0, 'tb_base_av': 23629.0, 'tb_quote_av': 125.309, 'ignore': 0.0}, {'Datetime': '2020-05-28 12:05:00', 'Open': 0.005303, 'High': 0.005308, 'Low': 0.005303, 'Close': 0.005306, 'Volume': 633151.0, 'close_time': 1590670000000.0, 'quote_av': 3359.28, 'trades': 29.0, 'tb_base_av': 522626.0, 'tb_quote_av': 2773.01, 'ignore': 0.0}, {'Datetime': '2020-05-28 12:06:00', 'Open': 0.005307, 'High': 0.005308, 'Low': 0.005299, 'Close': 0.005302, 'Volume': 1814480.0, 'close_time': 1590670000000.0, 'quote_av': 9620.75, 'trades': 64.0, 'tb_base_av': 795132.0, 'tb_quote_av': 4216.63, 'ignore': 0.0}, {'Datetime': '2020-05-28 12:07:00', 'Open': 0.005302, 'High': 0.005313, 'Low': 0.005298, 'Close': 0.005313, 'Volume': 1571550.0, 'close_time': 1590670000000.0, 'quote_av': 8342.64, 'trades': 65.0, 'tb_base_av': 1138180.0, 'tb_quote_av': 6043.41, 'ignore': 0.0}, {'Datetime': '2020-05-28 12:08:00', 'Open': 0.005317, 'High': 0.005328, 'Low': 0.005226, 'Close': 0.00526, 'Volume': 41764200.0, 'close_time': 1590670000000.0, 'quote_av': 220192.0, 'trades': 1096.0, 'tb_base_av': 14064200.0, 'tb_quote_av': 74083.1, 'ignore': 0.0}, {'Datetime': '2020-05-28 12:09:00', 'Open': 0.005262, 'High': 0.005285, 'Low': 0.00526, 'Close': 0.005277, 'Volume': 5281950.0, 'close_time': 1590670000000.0, 'quote_av': 27864.9, 'trades': 257.0, 'tb_base_av': 3856700.0, 'tb_quote_av': 20347.0, 'ignore': 0.0}, {'Datetime': '2020-05-28 12:10:00', 'Open': 0.005278, 'High': 0.005284, 'Low': 0.005277, 'Close': 0.005282, 'Volume': 3960950.0, 'close_time': 1590670000000.0, 'quote_av': 20917.5, 'trades': 82.0, 'tb_base_av': 2652380.0, 'tb_quote_av': 14009.4, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2020-07-02 05:21:00', 'Open': 0.009375, 'High': 0.00938, 'Low': 0.009373, 'Close': 0.009374, 'Volume': 527408.0, 'close_time': 1593670000000.0, 'quote_av': 4945.07, 'trades': 24.0, 'tb_base_av': 314816.0, 'tb_quote_av': 2952.22, 'ignore': 0.0}, {'Datetime': '2020-07-02 05:22:00', 'Open': 0.009374, 'High': 0.009374, 'Low': 0.009349, 'Close': 0.009353, 'Volume': 1565400.0, 'close_time': 1593670000000.0, 'quote_av': 14658.2, 'trades': 152.0, 'tb_base_av': 288792.0, 'tb_quote_av': 2704.33, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:39 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2020-07-02 05:23:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2020-07-02 05:23:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2020-07-02 05:23:00', 'Open': 0.009354, 'High': 0.009358, 'Low': 0.009346, 'Close': 0.009356, 'Volume': 1865100.0, 'close_time': 1593670000000.0, 'quote_av': 17443.9, 'trades': 69.0, 'tb_base_av': 1336870.0, 'tb_quote_av': 12504.8, 'ignore': 0.0}, {'Datetime': '2020-07-02 05:24:00', 'Open': 0.009356, 'High': 0.009362, 'Low': 0.009355, 'Close': 0.009356, 'Volume': 222281.0, 'close_time': 1593670000000.0, 'quote_av': 2080.01, 'trades': 37.0, 'tb_base_av': 136211.0, 'tb_quote_av': 1274.77, 'ignore': 0.0}, {'Datetime': '2020-07-02 05:25:00', 'Open': 0.009356, 'High': 0.009356, 'Low': 0.00932, 'Close': 0.00934, 'Volume': 4286020.0, 'close_time': 1593670000000.0, 'quote_av': 40000.0, 'trades': 258.0, 'tb_base_av': 713431.0, 'tb_quote_av': 6660.38, 'ignore': 0.0}, {'Datetime': '2020-07-02 05:26:00', 'Open': 0.00934, 'High': 0.009355, 'Low': 0.00933, 'Close': 0.009337, 'Volume': 1886500.0, 'close_time': 1593670000000.0, 'quote_av': 17632.6, 'trades': 125.0, 'tb_base_av': 976961.0, 'tb_quote_av': 9131.5, 'ignore': 0.0}, {'Datetime': '2020-07-02 05:27:00', 'Open': 0.009337, 'High': 0.009348, 'Low': 0.009334, 'Close': 0.009338, 'Volume': 1732600.0, 'close_time': 1593670000000.0, 'quote_av': 16182.5, 'trades': 54.0, 'tb_base_av': 887412.0, 'tb_quote_av': 8288.13, 'ignore': 0.0}, {'Datetime': '2020-07-02 05:28:00', 'Open': 0.009337, 'High': 0.009338, 'Low': 0.009332, 'Close': 0.009332, 'Volume': 501897.0, 'close_time': 1593670000000.0, 'quote_av': 4685.48, 'trades': 39.0, 'tb_base_av': 245184.0, 'tb_quote_av': 2289.22, 'ignore': 0.0}, {'Datetime': '2020-07-02 05:29:00', 'Open': 0.009333, 'High': 0.009342, 'Low': 0.009332, 'Close': 0.009342, 'Volume': 445570.0, 'close_time': 1593670000000.0, 'quote_av': 4159.45, 'trades': 24.0, 'tb_base_av': 345570.0, 'tb_quote_av': 3226.13, 'ignore': 0.0}, {'Datetime': '2020-07-02 05:30:00', 'Open': 0.009341, 'High': 0.009341, 'Low': 0.009338, 'Close': 0.009338, 'Volume': 125655.0, 'close_time': 1593670000000.0, 'quote_av': 1173.55, 'trades': 15.0, 'tb_base_av': 10757.0, 'tb_quote_av': 100.46, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2020-08-05 22:41:00', 'Open': 0.01871, 'High': 0.018712, 'Low': 0.018635, 'Close': 0.018653, 'Volume': 2377670.0, 'close_time': 1596670000000.0, 'quote_av': 44411.5, 'trades': 105.0, 'tb_base_av': 216949.0, 'tb_quote_av': 4054.31, 'ignore': 0.0}, {'Datetime': '2020-08-05 22:42:00', 'Open': 0.018647, 'High': 0.018669, 'Low': 0.018638, 'Close': 0.018669, 'Volume': 486037.0, 'close_time': 1596670000000.0, 'quote_av': 9063.58, 'trades': 26.0, 'tb_base_av': 186314.0, 'tb_quote_av': 3476.0, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:39 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2020-08-05 22:43:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2020-08-05 22:43:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2020-08-05 22:43:00', 'Open': 0.018669, 'High': 0.018715, 'Low': 0.018649, 'Close': 0.018702, 'Volume': 2195660.0, 'close_time': 1596670000000.0, 'quote_av': 41039.7, 'trades': 96.0, 'tb_base_av': 1175340.0, 'tb_quote_av': 21967.6, 'ignore': 0.0}, {'Datetime': '2020-08-05 22:44:00', 'Open': 0.018712, 'High': 0.018716, 'Low': 0.018682, 'Close': 0.018682, 'Volume': 1485140.0, 'close_time': 1596670000000.0, 'quote_av': 27778.8, 'trades': 65.0, 'tb_base_av': 272016.0, 'tb_quote_av': 5087.78, 'ignore': 0.0}, {'Datetime': '2020-08-05 22:45:00', 'Open': 0.018703, 'High': 0.01874, 'Low': 0.018699, 'Close': 0.01871, 'Volume': 2683050.0, 'close_time': 1596670000000.0, 'quote_av': 50225.2, 'trades': 281.0, 'tb_base_av': 1604620.0, 'tb_quote_av': 30040.8, 'ignore': 0.0}, {'Datetime': '2020-08-05 22:46:00', 'Open': 0.018711, 'High': 0.018754, 'Low': 0.01871, 'Close': 0.018741, 'Volume': 1411200.0, 'close_time': 1596670000000.0, 'quote_av': 26442.6, 'trades': 234.0, 'tb_base_av': 777423.0, 'tb_quote_av': 14571.5, 'ignore': 0.0}, {'Datetime': '2020-08-05 22:47:00', 'Open': 0.01874, 'High': 0.018778, 'Low': 0.01874, 'Close': 0.018762, 'Volume': 1298840.0, 'close_time': 1596670000000.0, 'quote_av': 24369.3, 'trades': 131.0, 'tb_base_av': 831154.0, 'tb_quote_av': 15592.5, 'ignore': 0.0}, {'Datetime': '2020-08-05 22:48:00', 'Open': 0.018768, 'High': 0.018782, 'Low': 0.018761, 'Close': 0.018782, 'Volume': 399794.0, 'close_time': 1596670000000.0, 'quote_av': 7504.64, 'trades': 39.0, 'tb_base_av': 201483.0, 'tb_quote_av': 3783.49, 'ignore': 0.0}, {'Datetime': '2020-08-05 22:49:00', 'Open': 0.018778, 'High': 0.018786, 'Low': 0.018762, 'Close': 0.018771, 'Volume': 230185.0, 'close_time': 1596670000000.0, 'quote_av': 4321.25, 'trades': 18.0, 'tb_base_av': 163224.0, 'tb_quote_av': 3064.84, 'ignore': 0.0}, {'Datetime': '2020-08-05 22:50:00', 'Open': 0.018769, 'High': 0.018786, 'Low': 0.01876, 'Close': 0.01877, 'Volume': 633506.0, 'close_time': 1596670000000.0, 'quote_av': 11888.6, 'trades': 30.0, 'tb_base_av': 277051.0, 'tb_quote_av': 5199.58, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2020-09-09 16:01:00', 'Open': 0.012951, 'High': 0.012975, 'Low': 0.012941, 'Close': 0.012961, 'Volume': 1236670.0, 'close_time': 1599670000000.0, 'quote_av': 16026.5, 'trades': 210.0, 'tb_base_av': 664681.0, 'tb_quote_av': 8617.83, 'ignore': 0.0}, {'Datetime': '2020-09-09 16:02:00', 'Open': 0.012958, 'High': 0.012975, 'Low': 0.012938, 'Close': 0.012975, 'Volume': 1390940.0, 'close_time': 1599670000000.0, 'quote_av': 18030.2, 'trades': 111.0, 'tb_base_av': 969870.0, 'tb_quote_av': 12574.7, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:39 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2020-09-09 16:03:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2020-09-09 16:03:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2020-09-09 16:03:00', 'Open': 0.01297, 'High': 0.012977, 'Low': 0.012956, 'Close': 0.012977, 'Volume': 1286750.0, 'close_time': 1599670000000.0, 'quote_av': 16684.1, 'trades': 132.0, 'tb_base_av': 742105.0, 'tb_quote_av': 9624.34, 'ignore': 0.0}, {'Datetime': '2020-09-09 16:04:00', 'Open': 0.012976, 'High': 0.012978, 'Low': 0.012961, 'Close': 0.01297, 'Volume': 356814.0, 'close_time': 1599670000000.0, 'quote_av': 4629.04, 'trades': 78.0, 'tb_base_av': 189598.0, 'tb_quote_av': 2460.36, 'ignore': 0.0}, {'Datetime': '2020-09-09 16:05:00', 'Open': 0.012977, 'High': 0.013, 'Low': 0.012972, 'Close': 0.012988, 'Volume': 1607940.0, 'close_time': 1599670000000.0, 'quote_av': 20872.7, 'trades': 111.0, 'tb_base_av': 587189.0, 'tb_quote_av': 7625.57, 'ignore': 0.0}, {'Datetime': '2020-09-09 16:06:00', 'Open': 0.012978, 'High': 0.012993, 'Low': 0.012949, 'Close': 0.012949, 'Volume': 957717.0, 'close_time': 1599670000000.0, 'quote_av': 12422.3, 'trades': 47.0, 'tb_base_av': 87213.0, 'tb_quote_av': 1132.65, 'ignore': 0.0}, {'Datetime': '2020-09-09 16:07:00', 'Open': 0.012947, 'High': 0.012967, 'Low': 0.012875, 'Close': 0.012875, 'Volume': 1509000.0, 'close_time': 1599670000000.0, 'quote_av': 19483.8, 'trades': 112.0, 'tb_base_av': 328768.0, 'tb_quote_av': 4258.84, 'ignore': 0.0}, {'Datetime': '2020-09-09 16:08:00', 'Open': 0.012875, 'High': 0.012891, 'Low': 0.012776, 'Close': 0.012786, 'Volume': 8867120.0, 'close_time': 1599670000000.0, 'quote_av': 113629.0, 'trades': 343.0, 'tb_base_av': 1707070.0, 'tb_quote_av': 21873.6, 'ignore': 0.0}, {'Datetime': '2020-09-09 16:09:00', 'Open': 0.012797, 'High': 0.01283, 'Low': 0.012764, 'Close': 0.01283, 'Volume': 1975090.0, 'close_time': 1599670000000.0, 'quote_av': 25279.9, 'trades': 133.0, 'tb_base_av': 1215600.0, 'tb_quote_av': 15570.4, 'ignore': 0.0}, {'Datetime': '2020-09-09 16:10:00', 'Open': 0.012812, 'High': 0.01283, 'Low': 0.012811, 'Close': 0.012815, 'Volume': 369032.0, 'close_time': 1599670000000.0, 'quote_av': 4730.5, 'trades': 28.0, 'tb_base_av': 114258.0, 'tb_quote_av': 1465.27, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2020-10-14 09:21:00', 'Open': 0.011373, 'High': 0.011377, 'Low': 0.011366, 'Close': 0.011366, 'Volume': 191562.0, 'close_time': 1602670000000.0, 'quote_av': 2178.56, 'trades': 12.0, 'tb_base_av': 83588.0, 'tb_quote_av': 950.791, 'ignore': 0.0}, {'Datetime': '2020-10-14 09:22:00', 'Open': 0.011366, 'High': 0.011383, 'Low': 0.011366, 'Close': 0.011381, 'Volume': 167628.0, 'close_time': 1602670000000.0, 'quote_av': 1907.35, 'trades': 11.0, 'tb_base_av': 131167.0, 'tb_quote_av': 1492.64, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:39 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2020-10-14 09:23:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2020-10-14 09:23:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2020-10-14 09:23:00', 'Open': 0.01138, 'High': 0.011382, 'Low': 0.011365, 'Close': 0.01137, 'Volume': 181620.0, 'close_time': 1602670000000.0, 'quote_av': 2065.98, 'trades': 9.0, 'tb_base_av': 90078.0, 'tb_quote_av': 1024.98, 'ignore': 0.0}, {'Datetime': '2020-10-14 09:24:00', 'Open': 0.011368, 'High': 0.011381, 'Low': 0.011367, 'Close': 0.011371, 'Volume': 336346.0, 'close_time': 1602670000000.0, 'quote_av': 3826.02, 'trades': 15.0, 'tb_base_av': 188247.0, 'tb_quote_av': 2141.84, 'ignore': 0.0}, {'Datetime': '2020-10-14 09:25:00', 'Open': 0.011376, 'High': 0.011379, 'Low': 0.011365, 'Close': 0.011367, 'Volume': 179966.0, 'close_time': 1602670000000.0, 'quote_av': 2046.99, 'trades': 12.0, 'tb_base_av': 126367.0, 'tb_quote_av': 1437.68, 'ignore': 0.0}, {'Datetime': '2020-10-14 09:26:00', 'Open': 0.011365, 'High': 0.011365, 'Low': 0.011355, 'Close': 0.011355, 'Volume': 133773.0, 'close_time': 1602670000000.0, 'quote_av': 1519.84, 'trades': 24.0, 'tb_base_av': 38913.0, 'tb_quote_av': 442.091, 'ignore': 0.0}, {'Datetime': '2020-10-14 09:27:00', 'Open': 0.011355, 'High': 0.011361, 'Low': 0.011345, 'Close': 0.011348, 'Volume': 572541.0, 'close_time': 1602670000000.0, 'quote_av': 6498.71, 'trades': 24.0, 'tb_base_av': 254793.0, 'tb_quote_av': 2893.03, 'ignore': 0.0}, {'Datetime': '2020-10-14 09:28:00', 'Open': 0.011352, 'High': 0.011355, 'Low': 0.011345, 'Close': 0.011352, 'Volume': 316340.0, 'close_time': 1602670000000.0, 'quote_av': 3590.41, 'trades': 13.0, 'tb_base_av': 152931.0, 'tb_quote_av': 1736.0, 'ignore': 0.0}, {'Datetime': '2020-10-14 09:29:00', 'Open': 0.011352, 'High': 0.011352, 'Low': 0.011345, 'Close': 0.011346, 'Volume': 271054.0, 'close_time': 1602670000000.0, 'quote_av': 3075.98, 'trades': 9.0, 'tb_base_av': 116440.0, 'tb_quote_av': 1321.66, 'ignore': 0.0}, {'Datetime': '2020-10-14 09:30:00', 'Open': 0.011348, 'High': 0.011358, 'Low': 0.011342, 'Close': 0.011342, 'Volume': 257879.0, 'close_time': 1602670000000.0, 'quote_av': 2925.81, 'trades': 22.0, 'tb_base_av': 51618.0, 'tb_quote_av': 585.913, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2020-11-18 02:41:00', 'Open': 0.012235, 'High': 0.012244, 'Low': 0.012227, 'Close': 0.012241, 'Volume': 159276.0, 'close_time': 1605670000000.0, 'quote_av': 1948.96, 'trades': 16.0, 'tb_base_av': 15164.0, 'tb_quote_av': 185.66, 'ignore': 0.0}, {'Datetime': '2020-11-18 02:42:00', 'Open': 0.012246, 'High': 0.012246, 'Low': 0.012217, 'Close': 0.012217, 'Volume': 313242.0, 'close_time': 1605670000000.0, 'quote_av': 3832.31, 'trades': 14.0, 'tb_base_av': 29001.0, 'tb_quote_av': 354.505, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:39 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2020-11-18 02:43:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2020-11-18 02:43:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2020-11-18 02:43:00', 'Open': 0.012226, 'High': 0.012226, 'Low': 0.012218, 'Close': 0.012223, 'Volume': 81833.0, 'close_time': 1605670000000.0, 'quote_av': 1000.35, 'trades': 5.0, 'tb_base_av': 81829.0, 'tb_quote_av': 1000.31, 'ignore': 0.0}, {'Datetime': '2020-11-18 02:44:00', 'Open': 0.012225, 'High': 0.012225, 'Low': 0.012216, 'Close': 0.012216, 'Volume': 289840.0, 'close_time': 1605670000000.0, 'quote_av': 3541.49, 'trades': 16.0, 'tb_base_av': 152544.0, 'tb_quote_av': 1863.79, 'ignore': 0.0}, {'Datetime': '2020-11-18 02:45:00', 'Open': 0.012214, 'High': 0.012214, 'Low': 0.012201, 'Close': 0.012208, 'Volume': 75633.0, 'close_time': 1605670000000.0, 'quote_av': 923.578, 'trades': 21.0, 'tb_base_av': 10000.0, 'tb_quote_av': 122.08, 'ignore': 0.0}, {'Datetime': '2020-11-18 02:46:00', 'Open': 0.012206, 'High': 0.012206, 'Low': 0.0122, 'Close': 0.0122, 'Volume': 282295.0, 'close_time': 1605670000000.0, 'quote_av': 3445.08, 'trades': 15.0, 'tb_base_av': 174462.0, 'tb_quote_av': 2129.17, 'ignore': 0.0}, {'Datetime': '2020-11-18 02:47:00', 'Open': 0.012202, 'High': 0.012207, 'Low': 0.012197, 'Close': 0.012201, 'Volume': 497428.0, 'close_time': 1605670000000.0, 'quote_av': 6068.71, 'trades': 18.0, 'tb_base_av': 190463.0, 'tb_quote_av': 2324.05, 'ignore': 0.0}, {'Datetime': '2020-11-18 02:48:00', 'Open': 0.012199, 'High': 0.012209, 'Low': 0.012199, 'Close': 0.012208, 'Volume': 448073.0, 'close_time': 1605670000000.0, 'quote_av': 5468.12, 'trades': 24.0, 'tb_base_av': 267075.0, 'tb_quote_av': 3259.27, 'ignore': 0.0}, {'Datetime': '2020-11-18 02:49:00', 'Open': 0.012208, 'High': 0.012208, 'Low': 0.012193, 'Close': 0.012196, 'Volume': 236261.0, 'close_time': 1605670000000.0, 'quote_av': 2882.39, 'trades': 26.0, 'tb_base_av': 155545.0, 'tb_quote_av': 1897.65, 'ignore': 0.0}, {'Datetime': '2020-11-18 02:50:00', 'Open': 0.012198, 'High': 0.012198, 'Low': 0.012191, 'Close': 0.012192, 'Volume': 157104.0, 'close_time': 1605670000000.0, 'quote_av': 1915.68, 'trades': 15.0, 'tb_base_av': 60771.0, 'tb_quote_av': 741.104, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2020-12-22 20:01:00', 'Open': 0.015993, 'High': 0.016018, 'Low': 0.015993, 'Close': 0.016014, 'Volume': 573118.0, 'close_time': 1608670000000.0, 'quote_av': 9174.32, 'trades': 64.0, 'tb_base_av': 241606.0, 'tb_quote_av': 3868.39, 'ignore': 0.0}, {'Datetime': '2020-12-22 20:02:00', 'Open': 0.016005, 'High': 0.016025, 'Low': 0.016002, 'Close': 0.016025, 'Volume': 82356.0, 'close_time': 1608670000000.0, 'quote_av': 1318.77, 'trades': 22.0, 'tb_base_av': 18503.0, 'tb_quote_av': 296.409, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:39 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1821, in _execute_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2358, in _handle_dbapi_exception
    raise exc_info[1].with_traceback(exc_info[2])
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1815, in _execute_context
    context = constructor(
              ^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 1509, in _init_compiled
    key: (
KeyboardInterrupt

2025-02-19 14:39 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2021-01-26 13:23:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2021-01-26 13:23:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2021-01-26 13:23:00', 'Open': 0.028714, 'High': 0.028749, 'Low': 0.028676, 'Close': 0.028688, 'Volume': 487881.0, 'close_time': 1611670000000.0, 'quote_av': 14006.2, 'trades': 75.0, 'tb_base_av': 373018.0, 'tb_quote_av': 10709.5, 'ignore': 0.0}, {'Datetime': '2021-01-26 13:24:00', 'Open': 0.028667, 'High': 0.028691, 'Low': 0.028638, 'Close': 0.028649, 'Volume': 328759.0, 'close_time': 1611670000000.0, 'quote_av': 9422.12, 'trades': 52.0, 'tb_base_av': 189189.0, 'tb_quote_av': 5421.66, 'ignore': 0.0}, {'Datetime': '2021-01-26 13:25:00', 'Open': 0.028651, 'High': 0.028659, 'Low': 0.028626, 'Close': 0.028636, 'Volume': 364690.0, 'close_time': 1611670000000.0, 'quote_av': 10445.7, 'trades': 58.0, 'tb_base_av': 246009.0, 'tb_quote_av': 7047.06, 'ignore': 0.0}, {'Datetime': '2021-01-26 13:26:00', 'Open': 0.028627, 'High': 0.028648, 'Low': 0.028571, 'Close': 0.028617, 'Volume': 355738.0, 'close_time': 1611670000000.0, 'quote_av': 10175.1, 'trades': 64.0, 'tb_base_av': 197665.0, 'tb_quote_av': 5655.58, 'ignore': 0.0}, {'Datetime': '2021-01-26 13:27:00', 'Open': 0.028614, 'High': 0.028621, 'Low': 0.028508, 'Close': 0.028559, 'Volume': 1257840.0, 'close_time': 1611670000000.0, 'quote_av': 35920.2, 'trades': 100.0, 'tb_base_av': 838735.0, 'tb_quote_av': 23940.6, 'ignore': 0.0}, {'Datetime': '2021-01-26 13:28:00', 'Open': 0.02855, 'High': 0.028591, 'Low': 0.028502, 'Close': 0.028529, 'Volume': 246388.0, 'close_time': 1611670000000.0, 'quote_av': 7032.51, 'trades': 63.0, 'tb_base_av': 144613.0, 'tb_quote_av': 4128.7, 'ignore': 0.0}, {'Datetime': '2021-01-26 13:29:00', 'Open': 0.028511, 'High': 0.02855, 'Low': 0.028507, 'Close': 0.028518, 'Volume': 456428.0, 'close_time': 1611670000000.0, 'quote_av': 13021.2, 'trades': 72.0, 'tb_base_av': 137583.0, 'tb_quote_av': 3926.03, 'ignore': 0.0}, {'Datetime': '2021-01-26 13:30:00', 'Open': 0.028534, 'High': 0.028665, 'Low': 0.028534, 'Close': 0.02861, 'Volume': 1417230.0, 'close_time': 1611670000000.0, 'quote_av': 40526.6, 'trades': 148.0, 'tb_base_av': 618383.0, 'tb_quote_av': 17686.2, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2021-03-02 06:41:00', 'Open': 0.043896, 'High': 0.044054, 'Low': 0.043894, 'Close': 0.044029, 'Volume': 1253140.0, 'close_time': 1614670000000.0, 'quote_av': 55103.3, 'trades': 131.0, 'tb_base_av': 438783.0, 'tb_quote_av': 19301.6, 'ignore': 0.0}, {'Datetime': '2021-03-02 06:42:00', 'Open': 0.04405, 'High': 0.044063, 'Low': 0.043969, 'Close': 0.044047, 'Volume': 346556.0, 'close_time': 1614670000000.0, 'quote_av': 15257.1, 'trades': 61.0, 'tb_base_av': 204928.0, 'tb_quote_av': 9024.06, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:39 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1821, in _execute_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2358, in _handle_dbapi_exception
    raise exc_info[1].with_traceback(exc_info[2])
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1815, in _execute_context
    context = constructor(
              ^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 1397, in _init_compiled
    compiled.construct_params(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/compiler.py", line 1881, in construct_params
    pd[escaped_name] = params[bindparam.key]
    ~~^^^^^^^^^^^^^^
KeyboardInterrupt

2025-02-19 14:39 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2021-04-06 00:03:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2021-04-06 00:03:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2021-04-06 00:03:00', 'Open': 0.103131, 'High': 0.103177, 'Low': 0.10286, 'Close': 0.10286, 'Volume': 1938630.0, 'close_time': 1617670000000.0, 'quote_av': 199721.0, 'trades': 565.0, 'tb_base_av': 694409.0, 'tb_quote_av': 71546.6, 'ignore': 0.0}, {'Datetime': '2021-04-06 00:04:00', 'Open': 0.102861, 'High': 0.103074, 'Low': 0.102727, 'Close': 0.102899, 'Volume': 1640410.0, 'close_time': 1617670000000.0, 'quote_av': 168865.0, 'trades': 398.0, 'tb_base_av': 1239880.0, 'tb_quote_av': 127656.0, 'ignore': 0.0}, {'Datetime': '2021-04-06 00:05:00', 'Open': 0.102899, 'High': 0.103088, 'Low': 0.10289, 'Close': 0.103053, 'Volume': 1285930.0, 'close_time': 1617670000000.0, 'quote_av': 132424.0, 'trades': 332.0, 'tb_base_av': 601591.0, 'tb_quote_av': 61948.4, 'ignore': 0.0}, {'Datetime': '2021-04-06 00:06:00', 'Open': 0.102998, 'High': 0.103, 'Low': 0.102516, 'Close': 0.102838, 'Volume': 3484960.0, 'close_time': 1617670000000.0, 'quote_av': 358116.0, 'trades': 580.0, 'tb_base_av': 1272300.0, 'tb_quote_av': 130762.0, 'ignore': 0.0}, {'Datetime': '2021-04-06 00:07:00', 'Open': 0.102865, 'High': 0.103211, 'Low': 0.102666, 'Close': 0.102845, 'Volume': 2869120.0, 'close_time': 1617670000000.0, 'quote_av': 295348.0, 'trades': 618.0, 'tb_base_av': 1614690.0, 'tb_quote_av': 166296.0, 'ignore': 0.0}, {'Datetime': '2021-04-06 00:08:00', 'Open': 0.102808, 'High': 0.102808, 'Low': 0.102532, 'Close': 0.102589, 'Volume': 945939.0, 'close_time': 1617670000000.0, 'quote_av': 97112.7, 'trades': 263.0, 'tb_base_av': 333395.0, 'tb_quote_av': 34226.8, 'ignore': 0.0}, {'Datetime': '2021-04-06 00:09:00', 'Open': 0.102577, 'High': 0.102755, 'Low': 0.102505, 'Close': 0.102644, 'Volume': 1123650.0, 'close_time': 1617670000000.0, 'quote_av': 115285.0, 'trades': 281.0, 'tb_base_av': 587289.0, 'tb_quote_av': 60279.7, 'ignore': 0.0}, {'Datetime': '2021-04-06 00:10:00', 'Open': 0.102623, 'High': 0.102623, 'Low': 0.102027, 'Close': 0.102027, 'Volume': 3260700.0, 'close_time': 1617670000000.0, 'quote_av': 333555.0, 'trades': 890.0, 'tb_base_av': 990150.0, 'tb_quote_av': 101307.0, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2021-05-10 17:21:00', 'Open': 0.219399, 'High': 0.219852, 'Low': 0.219197, 'Close': 0.219541, 'Volume': 697345.0, 'close_time': 1620670000000.0, 'quote_av': 153046.0, 'trades': 296.0, 'tb_base_av': 303110.0, 'tb_quote_av': 66541.7, 'ignore': 0.0}, {'Datetime': '2021-05-10 17:22:00', 'Open': 0.219539, 'High': 0.219787, 'Low': 0.219299, 'Close': 0.219384, 'Volume': 771438.0, 'close_time': 1620670000000.0, 'quote_av': 169372.0, 'trades': 255.0, 'tb_base_av': 442681.0, 'tb_quote_av': 97199.8, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:39 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2021-05-10 17:23:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2021-05-10 17:23:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2021-05-10 17:23:00', 'Open': 0.219373, 'High': 0.219397, 'Low': 0.218988, 'Close': 0.21904, 'Volume': 700541.0, 'close_time': 1620670000000.0, 'quote_av': 153503.0, 'trades': 261.0, 'tb_base_av': 307889.0, 'tb_quote_av': 67480.4, 'ignore': 0.0}, {'Datetime': '2021-05-10 17:24:00', 'Open': 0.219013, 'High': 0.219239, 'Low': 0.218758, 'Close': 0.219023, 'Volume': 1618050.0, 'close_time': 1620670000000.0, 'quote_av': 354346.0, 'trades': 384.0, 'tb_base_av': 900475.0, 'tb_quote_av': 197274.0, 'ignore': 0.0}, {'Datetime': '2021-05-10 17:25:00', 'Open': 0.219028, 'High': 0.219086, 'Low': 0.218238, 'Close': 0.218243, 'Volume': 1061930.0, 'close_time': 1620670000000.0, 'quote_av': 232159.0, 'trades': 481.0, 'tb_base_av': 332743.0, 'tb_quote_av': 72763.7, 'ignore': 0.0}, {'Datetime': '2021-05-10 17:26:00', 'Open': 0.218233, 'High': 0.218743, 'Low': 0.218142, 'Close': 0.218597, 'Volume': 1286080.0, 'close_time': 1620670000000.0, 'quote_av': 281007.0, 'trades': 392.0, 'tb_base_av': 744687.0, 'tb_quote_av': 162719.0, 'ignore': 0.0}, {'Datetime': '2021-05-10 17:27:00', 'Open': 0.218623, 'High': 0.218994, 'Low': 0.218392, 'Close': 0.21849, 'Volume': 944468.0, 'close_time': 1620670000000.0, 'quote_av': 206629.0, 'trades': 290.0, 'tb_base_av': 359993.0, 'tb_quote_av': 78739.2, 'ignore': 0.0}, {'Datetime': '2021-05-10 17:28:00', 'Open': 0.218435, 'High': 0.218843, 'Low': 0.218411, 'Close': 0.218511, 'Volume': 585629.0, 'close_time': 1620670000000.0, 'quote_av': 128040.0, 'trades': 176.0, 'tb_base_av': 361850.0, 'tb_quote_av': 79101.8, 'ignore': 0.0}, {'Datetime': '2021-05-10 17:29:00', 'Open': 0.21851, 'High': 0.218893, 'Low': 0.218337, 'Close': 0.218781, 'Volume': 1326730.0, 'close_time': 1620670000000.0, 'quote_av': 290072.0, 'trades': 271.0, 'tb_base_av': 495754.0, 'tb_quote_av': 108433.0, 'ignore': 0.0}, {'Datetime': '2021-05-10 17:30:00', 'Open': 0.218781, 'High': 0.21882, 'Low': 0.218479, 'Close': 0.218804, 'Volume': 972586.0, 'close_time': 1620670000000.0, 'quote_av': 212639.0, 'trades': 229.0, 'tb_base_av': 561553.0, 'tb_quote_av': 122778.0, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2021-06-14 10:41:00', 'Open': 0.11056, 'High': 0.11067, 'Low': 0.11051, 'Close': 0.11053, 'Volume': 318682.0, 'close_time': 1623670000000.0, 'quote_av': 35244.3, 'trades': 97.0, 'tb_base_av': 233344.0, 'tb_quote_av': 25809.4, 'ignore': 0.0}, {'Datetime': '2021-06-14 10:42:00', 'Open': 0.11054, 'High': 0.1106, 'Low': 0.11048, 'Close': 0.11055, 'Volume': 168712.0, 'close_time': 1623670000000.0, 'quote_av': 18650.4, 'trades': 79.0, 'tb_base_av': 97184.0, 'tb_quote_av': 10745.1, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:39 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2021-06-14 10:43:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2021-06-14 10:43:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2021-06-14 10:43:00', 'Open': 0.11056, 'High': 0.11071, 'Low': 0.11051, 'Close': 0.11064, 'Volume': 469110.0, 'close_time': 1623670000000.0, 'quote_av': 51887.2, 'trades': 163.0, 'tb_base_av': 298877.0, 'tb_quote_av': 33058.5, 'ignore': 0.0}, {'Datetime': '2021-06-14 10:44:00', 'Open': 0.11063, 'High': 0.11068, 'Low': 0.11055, 'Close': 0.11066, 'Volume': 146254.0, 'close_time': 1623670000000.0, 'quote_av': 16180.2, 'trades': 65.0, 'tb_base_av': 51430.0, 'tb_quote_av': 5689.67, 'ignore': 0.0}, {'Datetime': '2021-06-14 10:45:00', 'Open': 0.11066, 'High': 0.11085, 'Low': 0.11056, 'Close': 0.11079, 'Volume': 849732.0, 'close_time': 1623670000000.0, 'quote_av': 94061.9, 'trades': 236.0, 'tb_base_av': 456030.0, 'tb_quote_av': 50491.2, 'ignore': 0.0}, {'Datetime': '2021-06-14 10:46:00', 'Open': 0.11078, 'High': 0.11087, 'Low': 0.11075, 'Close': 0.11086, 'Volume': 216985.0, 'close_time': 1623670000000.0, 'quote_av': 24044.3, 'trades': 146.0, 'tb_base_av': 143002.0, 'tb_quote_av': 15847.1, 'ignore': 0.0}, {'Datetime': '2021-06-14 10:47:00', 'Open': 0.11083, 'High': 0.11086, 'Low': 0.11078, 'Close': 0.11085, 'Volume': 163246.0, 'close_time': 1623670000000.0, 'quote_av': 18091.6, 'trades': 94.0, 'tb_base_av': 73582.0, 'tb_quote_av': 8155.39, 'ignore': 0.0}, {'Datetime': '2021-06-14 10:48:00', 'Open': 0.11085, 'High': 0.11089, 'Low': 0.1108, 'Close': 0.11084, 'Volume': 327804.0, 'close_time': 1623670000000.0, 'quote_av': 36335.1, 'trades': 106.0, 'tb_base_av': 102805.0, 'tb_quote_av': 11396.3, 'ignore': 0.0}, {'Datetime': '2021-06-14 10:49:00', 'Open': 0.11082, 'High': 0.11085, 'Low': 0.11072, 'Close': 0.11081, 'Volume': 652771.0, 'close_time': 1623670000000.0, 'quote_av': 72306.1, 'trades': 144.0, 'tb_base_av': 314754.0, 'tb_quote_av': 34871.0, 'ignore': 0.0}, {'Datetime': '2021-06-14 10:50:00', 'Open': 0.11081, 'High': 0.11088, 'Low': 0.11075, 'Close': 0.11083, 'Volume': 407424.0, 'close_time': 1623670000000.0, 'quote_av': 45148.2, 'trades': 111.0, 'tb_base_av': 296470.0, 'tb_quote_av': 32854.1, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2021-07-19 04:01:00', 'Open': 0.06573, 'High': 0.06578, 'Low': 0.0657, 'Close': 0.06575, 'Volume': 1155670.0, 'close_time': 1626670000000.0, 'quote_av': 75995.2, 'trades': 140.0, 'tb_base_av': 1058030.0, 'tb_quote_av': 69575.0, 'ignore': 0.0}, {'Datetime': '2021-07-19 04:02:00', 'Open': 0.06577, 'High': 0.06578, 'Low': 0.06573, 'Close': 0.06574, 'Volume': 254631.0, 'close_time': 1626670000000.0, 'quote_av': 16742.5, 'trades': 92.0, 'tb_base_av': 41344.0, 'tb_quote_av': 2719.16, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:39 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2021-07-19 04:03:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2021-07-19 04:03:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2021-07-19 04:03:00', 'Open': 0.06574, 'High': 0.06578, 'Low': 0.06572, 'Close': 0.06575, 'Volume': 425054.0, 'close_time': 1626670000000.0, 'quote_av': 27950.3, 'trades': 89.0, 'tb_base_av': 236373.0, 'tb_quote_av': 15545.0, 'ignore': 0.0}, {'Datetime': '2021-07-19 04:04:00', 'Open': 0.06574, 'High': 0.06575, 'Low': 0.06564, 'Close': 0.06567, 'Volume': 348165.0, 'close_time': 1626670000000.0, 'quote_av': 22871.0, 'trades': 96.0, 'tb_base_av': 107365.0, 'tb_quote_av': 7052.32, 'ignore': 0.0}, {'Datetime': '2021-07-19 04:05:00', 'Open': 0.06567, 'High': 0.0657, 'Low': 0.06564, 'Close': 0.06568, 'Volume': 247416.0, 'close_time': 1626670000000.0, 'quote_av': 16246.6, 'trades': 87.0, 'tb_base_av': 172202.0, 'tb_quote_av': 11308.0, 'ignore': 0.0}, {'Datetime': '2021-07-19 04:06:00', 'Open': 0.06567, 'High': 0.0657, 'Low': 0.06565, 'Close': 0.06569, 'Volume': 242348.0, 'close_time': 1626670000000.0, 'quote_av': 15915.3, 'trades': 60.0, 'tb_base_av': 135984.0, 'tb_quote_av': 8931.27, 'ignore': 0.0}, {'Datetime': '2021-07-19 04:07:00', 'Open': 0.06569, 'High': 0.06573, 'Low': 0.06564, 'Close': 0.06565, 'Volume': 205198.0, 'close_time': 1626670000000.0, 'quote_av': 13480.8, 'trades': 83.0, 'tb_base_av': 33625.0, 'tb_quote_av': 2209.12, 'ignore': 0.0}, {'Datetime': '2021-07-19 04:08:00', 'Open': 0.06565, 'High': 0.06565, 'Low': 0.06546, 'Close': 0.06548, 'Volume': 597047.0, 'close_time': 1626670000000.0, 'quote_av': 39126.4, 'trades': 179.0, 'tb_base_av': 225905.0, 'tb_quote_av': 14803.8, 'ignore': 0.0}, {'Datetime': '2021-07-19 04:09:00', 'Open': 0.06547, 'High': 0.06556, 'Low': 0.06542, 'Close': 0.0655, 'Volume': 1032070.0, 'close_time': 1626670000000.0, 'quote_av': 67595.7, 'trades': 172.0, 'tb_base_av': 305269.0, 'tb_quote_av': 19995.6, 'ignore': 0.0}, {'Datetime': '2021-07-19 04:10:00', 'Open': 0.06549, 'High': 0.0656, 'Low': 0.06549, 'Close': 0.06554, 'Volume': 366054.0, 'close_time': 1626670000000.0, 'quote_av': 23993.2, 'trades': 114.0, 'tb_base_av': 120061.0, 'tb_quote_av': 7869.53, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2021-08-22 21:21:00', 'Open': 0.12466, 'High': 0.12473, 'Low': 0.12466, 'Close': 0.12472, 'Volume': 47036.0, 'close_time': 1629670000000.0, 'quote_av': 5865.4, 'trades': 50.0, 'tb_base_av': 17801.0, 'tb_quote_av': 2219.6, 'ignore': 0.0}, {'Datetime': '2021-08-22 21:22:00', 'Open': 0.12472, 'High': 0.12472, 'Low': 0.12443, 'Close': 0.12471, 'Volume': 505865.0, 'close_time': 1629670000000.0, 'quote_av': 63028.7, 'trades': 155.0, 'tb_base_av': 210570.0, 'tb_quote_av': 26239.0, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:40 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1050, "Table 'vetusdt-f' already exists")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 35, in change_db_data
    conn.execute(text(text_msg))
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1050, "Table 'vetusdt-f' already exists")
[SQL: CREATE TABLE `crypto_data`.`vetusdt-f`(
                `Datetime` DATETIME NOT NULL,
                `Open` FLOAT NOT NULL,
                `High` FLOAT NOT NULL,
                `Low` FLOAT NOT NULL,
                `Close` FLOAT NOT NULL,
                `Volume` FLOAT NOT NULL,
                `close_time` FLOAT NOT NULL,
                `quote_av` FLOAT NOT NULL,
                `trades` FLOAT NOT NULL,
                `tb_base_av` FLOAT NOT NULL,
                `tb_quote_av` FLOAT NOT NULL,
                `ignore` FLOAT NOT NULL,
                PRIMARY KEY(`Datetime`)
                );]
(Background on this error at: https://sqlalche.me/e/20/e3q8)

2025-02-19 14:40 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2020-02-14 08:03:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2020-02-14 08:03:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2020-02-14 08:03:00', 'Open': 0.007731, 'High': 0.007731, 'Low': 0.007689, 'Close': 0.007689, 'Volume': 70074.0, 'close_time': 1581670000000.0, 'quote_av': 540.701, 'trades': 5.0, 'tb_base_av': 50064.0, 'tb_quote_av': 386.244, 'ignore': 0.0}, {'Datetime': '2020-02-14 08:04:00', 'Open': 0.007689, 'High': 0.007729, 'Low': 0.007685, 'Close': 0.007729, 'Volume': 838629.0, 'close_time': 1581670000000.0, 'quote_av': 6464.46, 'trades': 41.0, 'tb_base_av': 663954.0, 'tb_quote_av': 5121.04, 'ignore': 0.0}, {'Datetime': '2020-02-14 08:05:00', 'Open': 0.007729, 'High': 0.007736, 'Low': 0.007683, 'Close': 0.007724, 'Volume': 602488.0, 'close_time': 1581670000000.0, 'quote_av': 4653.36, 'trades': 69.0, 'tb_base_av': 499488.0, 'tb_quote_av': 3860.27, 'ignore': 0.0}, {'Datetime': '2020-02-14 08:06:00', 'Open': 0.007724, 'High': 0.007749, 'Low': 0.007701, 'Close': 0.007747, 'Volume': 376875.0, 'close_time': 1581670000000.0, 'quote_av': 2908.07, 'trades': 95.0, 'tb_base_av': 144352.0, 'tb_quote_av': 1115.35, 'ignore': 0.0}, {'Datetime': '2020-02-14 08:07:00', 'Open': 0.007747, 'High': 0.007748, 'Low': 0.007746, 'Close': 0.007748, 'Volume': 350974.0, 'close_time': 1581670000000.0, 'quote_av': 2718.67, 'trades': 116.0, 'tb_base_av': 16623.0, 'tb_quote_av': 128.786, 'ignore': 0.0}, {'Datetime': '2020-02-14 08:08:00', 'Open': 0.007748, 'High': 0.007749, 'Low': 0.007719, 'Close': 0.007725, 'Volume': 783338.0, 'close_time': 1581670000000.0, 'quote_av': 6067.9, 'trades': 122.0, 'tb_base_av': 114663.0, 'tb_quote_av': 888.42, 'ignore': 0.0}, {'Datetime': '2020-02-14 08:09:00', 'Open': 0.007725, 'High': 0.007725, 'Low': 0.007709, 'Close': 0.007713, 'Volume': 236534.0, 'close_time': 1581670000000.0, 'quote_av': 1825.12, 'trades': 99.0, 'tb_base_av': 164467.0, 'tb_quote_av': 1269.09, 'ignore': 0.0}, {'Datetime': '2020-02-14 08:10:00', 'Open': 0.007714, 'High': 0.007725, 'Low': 0.007714, 'Close': 0.007716, 'Volume': 107248.0, 'close_time': 1581670000000.0, 'quote_av': 827.355, 'trades': 27.0, 'tb_base_av': 104349.0, 'tb_quote_av': 804.989, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2020-03-20 01:21:00', 'Open': 0.002916, 'High': 0.002916, 'Low': 0.002916, 'Close': 0.002916, 'Volume': 17925.0, 'close_time': 1584670000000.0, 'quote_av': 52.2693, 'trades': 2.0, 'tb_base_av': 17925.0, 'tb_quote_av': 52.2693, 'ignore': 0.0}, {'Datetime': '2020-03-20 01:22:00', 'Open': 0.002916, 'High': 0.002916, 'Low': 0.002911, 'Close': 0.002911, 'Volume': 33823.0, 'close_time': 1584670000000.0, 'quote_av': 98.5563, 'trades': 4.0, 'tb_base_av': 31778.0, 'tb_quote_av': 92.6013, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:40 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2020-03-20 01:23:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2020-03-20 01:23:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2020-03-20 01:23:00', 'Open': 0.002908, 'High': 0.002911, 'Low': 0.002908, 'Close': 0.002911, 'Volume': 45012.0, 'close_time': 1584670000000.0, 'quote_av': 131.017, 'trades': 10.0, 'tb_base_av': 40664.0, 'tb_quote_av': 118.373, 'ignore': 0.0}, {'Datetime': '2020-03-20 01:24:00', 'Open': 0.002909, 'High': 0.002909, 'Low': 0.002909, 'Close': 0.002909, 'Volume': 21338.0, 'close_time': 1584670000000.0, 'quote_av': 62.0722, 'trades': 2.0, 'tb_base_av': 0.0, 'tb_quote_av': 0.0, 'ignore': 0.0}, {'Datetime': '2020-03-20 01:25:00', 'Open': 0.002908, 'High': 0.002908, 'Low': 0.002904, 'Close': 0.002904, 'Volume': 35182.0, 'close_time': 1584670000000.0, 'quote_av': 102.247, 'trades': 4.0, 'tb_base_av': 7704.0, 'tb_quote_av': 22.4032, 'ignore': 0.0}, {'Datetime': '2020-03-20 01:26:00', 'Open': 0.002907, 'High': 0.002907, 'Low': 0.002907, 'Close': 0.002907, 'Volume': 13909.0, 'close_time': 1584670000000.0, 'quote_av': 40.4335, 'trades': 7.0, 'tb_base_av': 13909.0, 'tb_quote_av': 40.4335, 'ignore': 0.0}, {'Datetime': '2020-03-20 01:27:00', 'Open': 0.002907, 'High': 0.00291, 'Low': 0.002907, 'Close': 0.00291, 'Volume': 45013.0, 'close_time': 1584670000000.0, 'quote_av': 130.931, 'trades': 8.0, 'tb_base_av': 43351.0, 'tb_quote_av': 126.1, 'ignore': 0.0}, {'Datetime': '2020-03-20 01:28:00', 'Open': 0.002907, 'High': 0.002909, 'Low': 0.0029, 'Close': 0.0029, 'Volume': 128246.0, 'close_time': 1584670000000.0, 'quote_av': 372.182, 'trades': 7.0, 'tb_base_av': 12060.0, 'tb_quote_av': 35.0825, 'ignore': 0.0}, {'Datetime': '2020-03-20 01:29:00', 'Open': 0.002897, 'High': 0.002897, 'Low': 0.00288, 'Close': 0.00288, 'Volume': 678332.0, 'close_time': 1584670000000.0, 'quote_av': 1959.32, 'trades': 28.0, 'tb_base_av': 118801.0, 'tb_quote_av': 343.278, 'ignore': 0.0}, {'Datetime': '2020-03-20 01:30:00', 'Open': 0.002879, 'High': 0.002879, 'Low': 0.002851, 'Close': 0.002851, 'Volume': 1042260.0, 'close_time': 1584670000000.0, 'quote_av': 2988.47, 'trades': 45.0, 'tb_base_av': 305716.0, 'tb_quote_av': 879.231, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2020-04-23 18:41:00', 'Open': 0.00403, 'High': 0.004035, 'Low': 0.00403, 'Close': 0.004032, 'Volume': 529748.0, 'close_time': 1587670000000.0, 'quote_av': 2135.69, 'trades': 15.0, 'tb_base_av': 523431.0, 'tb_quote_av': 2110.22, 'ignore': 0.0}, {'Datetime': '2020-04-23 18:42:00', 'Open': 0.004032, 'High': 0.004032, 'Low': 0.004032, 'Close': 0.004032, 'Volume': 0.0, 'close_time': 1587670000000.0, 'quote_av': 0.0, 'trades': 0.0, 'tb_base_av': 0.0, 'tb_quote_av': 0.0, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:40 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2020-04-23 18:43:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2020-04-23 18:43:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2020-04-23 18:43:00', 'Open': 0.004032, 'High': 0.004032, 'Low': 0.004032, 'Close': 0.004032, 'Volume': 0.0, 'close_time': 1587670000000.0, 'quote_av': 0.0, 'trades': 0.0, 'tb_base_av': 0.0, 'tb_quote_av': 0.0, 'ignore': 0.0}, {'Datetime': '2020-04-23 18:44:00', 'Open': 0.004034, 'High': 0.004034, 'Low': 0.004034, 'Close': 0.004034, 'Volume': 2804.0, 'close_time': 1587670000000.0, 'quote_av': 11.3113, 'trades': 2.0, 'tb_base_av': 2804.0, 'tb_quote_av': 11.3113, 'ignore': 0.0}, {'Datetime': '2020-04-23 18:45:00', 'Open': 0.004034, 'High': 0.004035, 'Low': 0.004034, 'Close': 0.004035, 'Volume': 79490.0, 'close_time': 1587670000000.0, 'quote_av': 320.71, 'trades': 5.0, 'tb_base_av': 79490.0, 'tb_quote_av': 320.71, 'ignore': 0.0}, {'Datetime': '2020-04-23 18:46:00', 'Open': 0.004034, 'High': 0.004036, 'Low': 0.004033, 'Close': 0.004033, 'Volume': 168313.0, 'close_time': 1587670000000.0, 'quote_av': 679.04, 'trades': 6.0, 'tb_base_av': 68313.0, 'tb_quote_av': 275.649, 'ignore': 0.0}, {'Datetime': '2020-04-23 18:47:00', 'Open': 0.004036, 'High': 0.004036, 'Low': 0.004036, 'Close': 0.004036, 'Volume': 41040.0, 'close_time': 1587670000000.0, 'quote_av': 165.637, 'trades': 2.0, 'tb_base_av': 41040.0, 'tb_quote_av': 165.637, 'ignore': 0.0}, {'Datetime': '2020-04-23 18:48:00', 'Open': 0.004036, 'High': 0.004037, 'Low': 0.004036, 'Close': 0.004037, 'Volume': 442303.0, 'close_time': 1587670000000.0, 'quote_av': 1785.5, 'trades': 6.0, 'tb_base_av': 380907.0, 'tb_quote_av': 1537.7, 'ignore': 0.0}, {'Datetime': '2020-04-23 18:49:00', 'Open': 0.004036, 'High': 0.004036, 'Low': 0.004036, 'Close': 0.004036, 'Volume': 59984.0, 'close_time': 1587670000000.0, 'quote_av': 242.095, 'trades': 4.0, 'tb_base_av': 59984.0, 'tb_quote_av': 242.095, 'ignore': 0.0}, {'Datetime': '2020-04-23 18:50:00', 'Open': 0.004037, 'High': 0.004038, 'Low': 0.004037, 'Close': 0.004038, 'Volume': 70045.0, 'close_time': 1587670000000.0, 'quote_av': 282.842, 'trades': 4.0, 'tb_base_av': 70045.0, 'tb_quote_av': 282.842, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2020-05-28 12:01:00', 'Open': 0.005302, 'High': 0.005306, 'Low': 0.005296, 'Close': 0.005301, 'Volume': 1705550.0, 'close_time': 1590670000000.0, 'quote_av': 9039.9, 'trades': 53.0, 'tb_base_av': 277856.0, 'tb_quote_av': 1473.27, 'ignore': 0.0}, {'Datetime': '2020-05-28 12:02:00', 'Open': 0.005301, 'High': 0.005308, 'Low': 0.005294, 'Close': 0.005307, 'Volume': 2461100.0, 'close_time': 1590670000000.0, 'quote_av': 13045.1, 'trades': 101.0, 'tb_base_av': 1446980.0, 'tb_quote_av': 7667.62, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:40 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2020-05-28 12:03:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2020-05-28 12:03:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2020-05-28 12:03:00', 'Open': 0.005308, 'High': 0.005313, 'Low': 0.005305, 'Close': 0.005308, 'Volume': 1973770.0, 'close_time': 1590670000000.0, 'quote_av': 10476.2, 'trades': 50.0, 'tb_base_av': 576164.0, 'tb_quote_av': 3059.02, 'ignore': 0.0}, {'Datetime': '2020-05-28 12:04:00', 'Open': 0.005307, 'High': 0.005307, 'Low': 0.0053, 'Close': 0.005303, 'Volume': 427924.0, 'close_time': 1590670000000.0, 'quote_av': 2269.7, 'trades': 23.0, 'tb_base_av': 23629.0, 'tb_quote_av': 125.309, 'ignore': 0.0}, {'Datetime': '2020-05-28 12:05:00', 'Open': 0.005303, 'High': 0.005308, 'Low': 0.005303, 'Close': 0.005306, 'Volume': 633151.0, 'close_time': 1590670000000.0, 'quote_av': 3359.28, 'trades': 29.0, 'tb_base_av': 522626.0, 'tb_quote_av': 2773.01, 'ignore': 0.0}, {'Datetime': '2020-05-28 12:06:00', 'Open': 0.005307, 'High': 0.005308, 'Low': 0.005299, 'Close': 0.005302, 'Volume': 1814480.0, 'close_time': 1590670000000.0, 'quote_av': 9620.75, 'trades': 64.0, 'tb_base_av': 795132.0, 'tb_quote_av': 4216.63, 'ignore': 0.0}, {'Datetime': '2020-05-28 12:07:00', 'Open': 0.005302, 'High': 0.005313, 'Low': 0.005298, 'Close': 0.005313, 'Volume': 1571550.0, 'close_time': 1590670000000.0, 'quote_av': 8342.64, 'trades': 65.0, 'tb_base_av': 1138180.0, 'tb_quote_av': 6043.41, 'ignore': 0.0}, {'Datetime': '2020-05-28 12:08:00', 'Open': 0.005317, 'High': 0.005328, 'Low': 0.005226, 'Close': 0.00526, 'Volume': 41764200.0, 'close_time': 1590670000000.0, 'quote_av': 220192.0, 'trades': 1096.0, 'tb_base_av': 14064200.0, 'tb_quote_av': 74083.1, 'ignore': 0.0}, {'Datetime': '2020-05-28 12:09:00', 'Open': 0.005262, 'High': 0.005285, 'Low': 0.00526, 'Close': 0.005277, 'Volume': 5281950.0, 'close_time': 1590670000000.0, 'quote_av': 27864.9, 'trades': 257.0, 'tb_base_av': 3856700.0, 'tb_quote_av': 20347.0, 'ignore': 0.0}, {'Datetime': '2020-05-28 12:10:00', 'Open': 0.005278, 'High': 0.005284, 'Low': 0.005277, 'Close': 0.005282, 'Volume': 3960950.0, 'close_time': 1590670000000.0, 'quote_av': 20917.5, 'trades': 82.0, 'tb_base_av': 2652380.0, 'tb_quote_av': 14009.4, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2020-07-02 05:21:00', 'Open': 0.009375, 'High': 0.00938, 'Low': 0.009373, 'Close': 0.009374, 'Volume': 527408.0, 'close_time': 1593670000000.0, 'quote_av': 4945.07, 'trades': 24.0, 'tb_base_av': 314816.0, 'tb_quote_av': 2952.22, 'ignore': 0.0}, {'Datetime': '2020-07-02 05:22:00', 'Open': 0.009374, 'High': 0.009374, 'Low': 0.009349, 'Close': 0.009353, 'Volume': 1565400.0, 'close_time': 1593670000000.0, 'quote_av': 14658.2, 'trades': 152.0, 'tb_base_av': 288792.0, 'tb_quote_av': 2704.33, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:40 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2020-07-02 05:23:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2020-07-02 05:23:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2020-07-02 05:23:00', 'Open': 0.009354, 'High': 0.009358, 'Low': 0.009346, 'Close': 0.009356, 'Volume': 1865100.0, 'close_time': 1593670000000.0, 'quote_av': 17443.9, 'trades': 69.0, 'tb_base_av': 1336870.0, 'tb_quote_av': 12504.8, 'ignore': 0.0}, {'Datetime': '2020-07-02 05:24:00', 'Open': 0.009356, 'High': 0.009362, 'Low': 0.009355, 'Close': 0.009356, 'Volume': 222281.0, 'close_time': 1593670000000.0, 'quote_av': 2080.01, 'trades': 37.0, 'tb_base_av': 136211.0, 'tb_quote_av': 1274.77, 'ignore': 0.0}, {'Datetime': '2020-07-02 05:25:00', 'Open': 0.009356, 'High': 0.009356, 'Low': 0.00932, 'Close': 0.00934, 'Volume': 4286020.0, 'close_time': 1593670000000.0, 'quote_av': 40000.0, 'trades': 258.0, 'tb_base_av': 713431.0, 'tb_quote_av': 6660.38, 'ignore': 0.0}, {'Datetime': '2020-07-02 05:26:00', 'Open': 0.00934, 'High': 0.009355, 'Low': 0.00933, 'Close': 0.009337, 'Volume': 1886500.0, 'close_time': 1593670000000.0, 'quote_av': 17632.6, 'trades': 125.0, 'tb_base_av': 976961.0, 'tb_quote_av': 9131.5, 'ignore': 0.0}, {'Datetime': '2020-07-02 05:27:00', 'Open': 0.009337, 'High': 0.009348, 'Low': 0.009334, 'Close': 0.009338, 'Volume': 1732600.0, 'close_time': 1593670000000.0, 'quote_av': 16182.5, 'trades': 54.0, 'tb_base_av': 887412.0, 'tb_quote_av': 8288.13, 'ignore': 0.0}, {'Datetime': '2020-07-02 05:28:00', 'Open': 0.009337, 'High': 0.009338, 'Low': 0.009332, 'Close': 0.009332, 'Volume': 501897.0, 'close_time': 1593670000000.0, 'quote_av': 4685.48, 'trades': 39.0, 'tb_base_av': 245184.0, 'tb_quote_av': 2289.22, 'ignore': 0.0}, {'Datetime': '2020-07-02 05:29:00', 'Open': 0.009333, 'High': 0.009342, 'Low': 0.009332, 'Close': 0.009342, 'Volume': 445570.0, 'close_time': 1593670000000.0, 'quote_av': 4159.45, 'trades': 24.0, 'tb_base_av': 345570.0, 'tb_quote_av': 3226.13, 'ignore': 0.0}, {'Datetime': '2020-07-02 05:30:00', 'Open': 0.009341, 'High': 0.009341, 'Low': 0.009338, 'Close': 0.009338, 'Volume': 125655.0, 'close_time': 1593670000000.0, 'quote_av': 1173.55, 'trades': 15.0, 'tb_base_av': 10757.0, 'tb_quote_av': 100.46, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2020-08-05 22:41:00', 'Open': 0.01871, 'High': 0.018712, 'Low': 0.018635, 'Close': 0.018653, 'Volume': 2377670.0, 'close_time': 1596670000000.0, 'quote_av': 44411.5, 'trades': 105.0, 'tb_base_av': 216949.0, 'tb_quote_av': 4054.31, 'ignore': 0.0}, {'Datetime': '2020-08-05 22:42:00', 'Open': 0.018647, 'High': 0.018669, 'Low': 0.018638, 'Close': 0.018669, 'Volume': 486037.0, 'close_time': 1596670000000.0, 'quote_av': 9063.58, 'trades': 26.0, 'tb_base_av': 186314.0, 'tb_quote_av': 3476.0, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:40 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2020-08-05 22:43:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2020-08-05 22:43:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2020-08-05 22:43:00', 'Open': 0.018669, 'High': 0.018715, 'Low': 0.018649, 'Close': 0.018702, 'Volume': 2195660.0, 'close_time': 1596670000000.0, 'quote_av': 41039.7, 'trades': 96.0, 'tb_base_av': 1175340.0, 'tb_quote_av': 21967.6, 'ignore': 0.0}, {'Datetime': '2020-08-05 22:44:00', 'Open': 0.018712, 'High': 0.018716, 'Low': 0.018682, 'Close': 0.018682, 'Volume': 1485140.0, 'close_time': 1596670000000.0, 'quote_av': 27778.8, 'trades': 65.0, 'tb_base_av': 272016.0, 'tb_quote_av': 5087.78, 'ignore': 0.0}, {'Datetime': '2020-08-05 22:45:00', 'Open': 0.018703, 'High': 0.01874, 'Low': 0.018699, 'Close': 0.01871, 'Volume': 2683050.0, 'close_time': 1596670000000.0, 'quote_av': 50225.2, 'trades': 281.0, 'tb_base_av': 1604620.0, 'tb_quote_av': 30040.8, 'ignore': 0.0}, {'Datetime': '2020-08-05 22:46:00', 'Open': 0.018711, 'High': 0.018754, 'Low': 0.01871, 'Close': 0.018741, 'Volume': 1411200.0, 'close_time': 1596670000000.0, 'quote_av': 26442.6, 'trades': 234.0, 'tb_base_av': 777423.0, 'tb_quote_av': 14571.5, 'ignore': 0.0}, {'Datetime': '2020-08-05 22:47:00', 'Open': 0.01874, 'High': 0.018778, 'Low': 0.01874, 'Close': 0.018762, 'Volume': 1298840.0, 'close_time': 1596670000000.0, 'quote_av': 24369.3, 'trades': 131.0, 'tb_base_av': 831154.0, 'tb_quote_av': 15592.5, 'ignore': 0.0}, {'Datetime': '2020-08-05 22:48:00', 'Open': 0.018768, 'High': 0.018782, 'Low': 0.018761, 'Close': 0.018782, 'Volume': 399794.0, 'close_time': 1596670000000.0, 'quote_av': 7504.64, 'trades': 39.0, 'tb_base_av': 201483.0, 'tb_quote_av': 3783.49, 'ignore': 0.0}, {'Datetime': '2020-08-05 22:49:00', 'Open': 0.018778, 'High': 0.018786, 'Low': 0.018762, 'Close': 0.018771, 'Volume': 230185.0, 'close_time': 1596670000000.0, 'quote_av': 4321.25, 'trades': 18.0, 'tb_base_av': 163224.0, 'tb_quote_av': 3064.84, 'ignore': 0.0}, {'Datetime': '2020-08-05 22:50:00', 'Open': 0.018769, 'High': 0.018786, 'Low': 0.01876, 'Close': 0.01877, 'Volume': 633506.0, 'close_time': 1596670000000.0, 'quote_av': 11888.6, 'trades': 30.0, 'tb_base_av': 277051.0, 'tb_quote_av': 5199.58, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2020-09-09 16:01:00', 'Open': 0.012951, 'High': 0.012975, 'Low': 0.012941, 'Close': 0.012961, 'Volume': 1236670.0, 'close_time': 1599670000000.0, 'quote_av': 16026.5, 'trades': 210.0, 'tb_base_av': 664681.0, 'tb_quote_av': 8617.83, 'ignore': 0.0}, {'Datetime': '2020-09-09 16:02:00', 'Open': 0.012958, 'High': 0.012975, 'Low': 0.012938, 'Close': 0.012975, 'Volume': 1390940.0, 'close_time': 1599670000000.0, 'quote_av': 18030.2, 'trades': 111.0, 'tb_base_av': 969870.0, 'tb_quote_av': 12574.7, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:40 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2020-09-09 16:03:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2020-09-09 16:03:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2020-09-09 16:03:00', 'Open': 0.01297, 'High': 0.012977, 'Low': 0.012956, 'Close': 0.012977, 'Volume': 1286750.0, 'close_time': 1599670000000.0, 'quote_av': 16684.1, 'trades': 132.0, 'tb_base_av': 742105.0, 'tb_quote_av': 9624.34, 'ignore': 0.0}, {'Datetime': '2020-09-09 16:04:00', 'Open': 0.012976, 'High': 0.012978, 'Low': 0.012961, 'Close': 0.01297, 'Volume': 356814.0, 'close_time': 1599670000000.0, 'quote_av': 4629.04, 'trades': 78.0, 'tb_base_av': 189598.0, 'tb_quote_av': 2460.36, 'ignore': 0.0}, {'Datetime': '2020-09-09 16:05:00', 'Open': 0.012977, 'High': 0.013, 'Low': 0.012972, 'Close': 0.012988, 'Volume': 1607940.0, 'close_time': 1599670000000.0, 'quote_av': 20872.7, 'trades': 111.0, 'tb_base_av': 587189.0, 'tb_quote_av': 7625.57, 'ignore': 0.0}, {'Datetime': '2020-09-09 16:06:00', 'Open': 0.012978, 'High': 0.012993, 'Low': 0.012949, 'Close': 0.012949, 'Volume': 957717.0, 'close_time': 1599670000000.0, 'quote_av': 12422.3, 'trades': 47.0, 'tb_base_av': 87213.0, 'tb_quote_av': 1132.65, 'ignore': 0.0}, {'Datetime': '2020-09-09 16:07:00', 'Open': 0.012947, 'High': 0.012967, 'Low': 0.012875, 'Close': 0.012875, 'Volume': 1509000.0, 'close_time': 1599670000000.0, 'quote_av': 19483.8, 'trades': 112.0, 'tb_base_av': 328768.0, 'tb_quote_av': 4258.84, 'ignore': 0.0}, {'Datetime': '2020-09-09 16:08:00', 'Open': 0.012875, 'High': 0.012891, 'Low': 0.012776, 'Close': 0.012786, 'Volume': 8867120.0, 'close_time': 1599670000000.0, 'quote_av': 113629.0, 'trades': 343.0, 'tb_base_av': 1707070.0, 'tb_quote_av': 21873.6, 'ignore': 0.0}, {'Datetime': '2020-09-09 16:09:00', 'Open': 0.012797, 'High': 0.01283, 'Low': 0.012764, 'Close': 0.01283, 'Volume': 1975090.0, 'close_time': 1599670000000.0, 'quote_av': 25279.9, 'trades': 133.0, 'tb_base_av': 1215600.0, 'tb_quote_av': 15570.4, 'ignore': 0.0}, {'Datetime': '2020-09-09 16:10:00', 'Open': 0.012812, 'High': 0.01283, 'Low': 0.012811, 'Close': 0.012815, 'Volume': 369032.0, 'close_time': 1599670000000.0, 'quote_av': 4730.5, 'trades': 28.0, 'tb_base_av': 114258.0, 'tb_quote_av': 1465.27, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2020-10-14 09:21:00', 'Open': 0.011373, 'High': 0.011377, 'Low': 0.011366, 'Close': 0.011366, 'Volume': 191562.0, 'close_time': 1602670000000.0, 'quote_av': 2178.56, 'trades': 12.0, 'tb_base_av': 83588.0, 'tb_quote_av': 950.791, 'ignore': 0.0}, {'Datetime': '2020-10-14 09:22:00', 'Open': 0.011366, 'High': 0.011383, 'Low': 0.011366, 'Close': 0.011381, 'Volume': 167628.0, 'close_time': 1602670000000.0, 'quote_av': 1907.35, 'trades': 11.0, 'tb_base_av': 131167.0, 'tb_quote_av': 1492.64, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:40 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2020-10-14 09:23:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2020-10-14 09:23:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2020-10-14 09:23:00', 'Open': 0.01138, 'High': 0.011382, 'Low': 0.011365, 'Close': 0.01137, 'Volume': 181620.0, 'close_time': 1602670000000.0, 'quote_av': 2065.98, 'trades': 9.0, 'tb_base_av': 90078.0, 'tb_quote_av': 1024.98, 'ignore': 0.0}, {'Datetime': '2020-10-14 09:24:00', 'Open': 0.011368, 'High': 0.011381, 'Low': 0.011367, 'Close': 0.011371, 'Volume': 336346.0, 'close_time': 1602670000000.0, 'quote_av': 3826.02, 'trades': 15.0, 'tb_base_av': 188247.0, 'tb_quote_av': 2141.84, 'ignore': 0.0}, {'Datetime': '2020-10-14 09:25:00', 'Open': 0.011376, 'High': 0.011379, 'Low': 0.011365, 'Close': 0.011367, 'Volume': 179966.0, 'close_time': 1602670000000.0, 'quote_av': 2046.99, 'trades': 12.0, 'tb_base_av': 126367.0, 'tb_quote_av': 1437.68, 'ignore': 0.0}, {'Datetime': '2020-10-14 09:26:00', 'Open': 0.011365, 'High': 0.011365, 'Low': 0.011355, 'Close': 0.011355, 'Volume': 133773.0, 'close_time': 1602670000000.0, 'quote_av': 1519.84, 'trades': 24.0, 'tb_base_av': 38913.0, 'tb_quote_av': 442.091, 'ignore': 0.0}, {'Datetime': '2020-10-14 09:27:00', 'Open': 0.011355, 'High': 0.011361, 'Low': 0.011345, 'Close': 0.011348, 'Volume': 572541.0, 'close_time': 1602670000000.0, 'quote_av': 6498.71, 'trades': 24.0, 'tb_base_av': 254793.0, 'tb_quote_av': 2893.03, 'ignore': 0.0}, {'Datetime': '2020-10-14 09:28:00', 'Open': 0.011352, 'High': 0.011355, 'Low': 0.011345, 'Close': 0.011352, 'Volume': 316340.0, 'close_time': 1602670000000.0, 'quote_av': 3590.41, 'trades': 13.0, 'tb_base_av': 152931.0, 'tb_quote_av': 1736.0, 'ignore': 0.0}, {'Datetime': '2020-10-14 09:29:00', 'Open': 0.011352, 'High': 0.011352, 'Low': 0.011345, 'Close': 0.011346, 'Volume': 271054.0, 'close_time': 1602670000000.0, 'quote_av': 3075.98, 'trades': 9.0, 'tb_base_av': 116440.0, 'tb_quote_av': 1321.66, 'ignore': 0.0}, {'Datetime': '2020-10-14 09:30:00', 'Open': 0.011348, 'High': 0.011358, 'Low': 0.011342, 'Close': 0.011342, 'Volume': 257879.0, 'close_time': 1602670000000.0, 'quote_av': 2925.81, 'trades': 22.0, 'tb_base_av': 51618.0, 'tb_quote_av': 585.913, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2020-11-18 02:41:00', 'Open': 0.012235, 'High': 0.012244, 'Low': 0.012227, 'Close': 0.012241, 'Volume': 159276.0, 'close_time': 1605670000000.0, 'quote_av': 1948.96, 'trades': 16.0, 'tb_base_av': 15164.0, 'tb_quote_av': 185.66, 'ignore': 0.0}, {'Datetime': '2020-11-18 02:42:00', 'Open': 0.012246, 'High': 0.012246, 'Low': 0.012217, 'Close': 0.012217, 'Volume': 313242.0, 'close_time': 1605670000000.0, 'quote_av': 3832.31, 'trades': 14.0, 'tb_base_av': 29001.0, 'tb_quote_av': 354.505, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:40 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2020-11-18 02:43:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2020-11-18 02:43:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2020-11-18 02:43:00', 'Open': 0.012226, 'High': 0.012226, 'Low': 0.012218, 'Close': 0.012223, 'Volume': 81833.0, 'close_time': 1605670000000.0, 'quote_av': 1000.35, 'trades': 5.0, 'tb_base_av': 81829.0, 'tb_quote_av': 1000.31, 'ignore': 0.0}, {'Datetime': '2020-11-18 02:44:00', 'Open': 0.012225, 'High': 0.012225, 'Low': 0.012216, 'Close': 0.012216, 'Volume': 289840.0, 'close_time': 1605670000000.0, 'quote_av': 3541.49, 'trades': 16.0, 'tb_base_av': 152544.0, 'tb_quote_av': 1863.79, 'ignore': 0.0}, {'Datetime': '2020-11-18 02:45:00', 'Open': 0.012214, 'High': 0.012214, 'Low': 0.012201, 'Close': 0.012208, 'Volume': 75633.0, 'close_time': 1605670000000.0, 'quote_av': 923.578, 'trades': 21.0, 'tb_base_av': 10000.0, 'tb_quote_av': 122.08, 'ignore': 0.0}, {'Datetime': '2020-11-18 02:46:00', 'Open': 0.012206, 'High': 0.012206, 'Low': 0.0122, 'Close': 0.0122, 'Volume': 282295.0, 'close_time': 1605670000000.0, 'quote_av': 3445.08, 'trades': 15.0, 'tb_base_av': 174462.0, 'tb_quote_av': 2129.17, 'ignore': 0.0}, {'Datetime': '2020-11-18 02:47:00', 'Open': 0.012202, 'High': 0.012207, 'Low': 0.012197, 'Close': 0.012201, 'Volume': 497428.0, 'close_time': 1605670000000.0, 'quote_av': 6068.71, 'trades': 18.0, 'tb_base_av': 190463.0, 'tb_quote_av': 2324.05, 'ignore': 0.0}, {'Datetime': '2020-11-18 02:48:00', 'Open': 0.012199, 'High': 0.012209, 'Low': 0.012199, 'Close': 0.012208, 'Volume': 448073.0, 'close_time': 1605670000000.0, 'quote_av': 5468.12, 'trades': 24.0, 'tb_base_av': 267075.0, 'tb_quote_av': 3259.27, 'ignore': 0.0}, {'Datetime': '2020-11-18 02:49:00', 'Open': 0.012208, 'High': 0.012208, 'Low': 0.012193, 'Close': 0.012196, 'Volume': 236261.0, 'close_time': 1605670000000.0, 'quote_av': 2882.39, 'trades': 26.0, 'tb_base_av': 155545.0, 'tb_quote_av': 1897.65, 'ignore': 0.0}, {'Datetime': '2020-11-18 02:50:00', 'Open': 0.012198, 'High': 0.012198, 'Low': 0.012191, 'Close': 0.012192, 'Volume': 157104.0, 'close_time': 1605670000000.0, 'quote_av': 1915.68, 'trades': 15.0, 'tb_base_av': 60771.0, 'tb_quote_av': 741.104, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2020-12-22 20:01:00', 'Open': 0.015993, 'High': 0.016018, 'Low': 0.015993, 'Close': 0.016014, 'Volume': 573118.0, 'close_time': 1608670000000.0, 'quote_av': 9174.32, 'trades': 64.0, 'tb_base_av': 241606.0, 'tb_quote_av': 3868.39, 'ignore': 0.0}, {'Datetime': '2020-12-22 20:02:00', 'Open': 0.016005, 'High': 0.016025, 'Low': 0.016002, 'Close': 0.016025, 'Volume': 82356.0, 'close_time': 1608670000000.0, 'quote_av': 1318.77, 'trades': 22.0, 'tb_base_av': 18503.0, 'tb_quote_av': 296.409, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:40 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2020-12-22 20:03:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2020-12-22 20:03:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2020-12-22 20:03:00', 'Open': 0.016026, 'High': 0.016056, 'Low': 0.016025, 'Close': 0.016038, 'Volume': 435230.0, 'close_time': 1608670000000.0, 'quote_av': 6979.79, 'trades': 74.0, 'tb_base_av': 268126.0, 'tb_quote_av': 4300.68, 'ignore': 0.0}, {'Datetime': '2020-12-22 20:04:00', 'Open': 0.016038, 'High': 0.016039, 'Low': 0.01601, 'Close': 0.016013, 'Volume': 208584.0, 'close_time': 1608670000000.0, 'quote_av': 3342.72, 'trades': 26.0, 'tb_base_av': 46174.0, 'tb_quote_av': 739.951, 'ignore': 0.0}, {'Datetime': '2020-12-22 20:05:00', 'Open': 0.016012, 'High': 0.016024, 'Low': 0.01601, 'Close': 0.016012, 'Volume': 124829.0, 'close_time': 1608670000000.0, 'quote_av': 1999.32, 'trades': 18.0, 'tb_base_av': 40383.0, 'tb_quote_av': 646.967, 'ignore': 0.0}, {'Datetime': '2020-12-22 20:06:00', 'Open': 0.016005, 'High': 0.016045, 'Low': 0.016005, 'Close': 0.016038, 'Volume': 537031.0, 'close_time': 1608670000000.0, 'quote_av': 8609.15, 'trades': 49.0, 'tb_base_av': 401747.0, 'tb_quote_av': 6440.98, 'ignore': 0.0}, {'Datetime': '2020-12-22 20:07:00', 'Open': 0.016038, 'High': 0.016049, 'Low': 0.016028, 'Close': 0.016035, 'Volume': 150233.0, 'close_time': 1608670000000.0, 'quote_av': 2409.66, 'trades': 71.0, 'tb_base_av': 116396.0, 'tb_quote_av': 1866.9, 'ignore': 0.0}, {'Datetime': '2020-12-22 20:08:00', 'Open': 0.016032, 'High': 0.016038, 'Low': 0.016018, 'Close': 0.016031, 'Volume': 202800.0, 'close_time': 1608670000000.0, 'quote_av': 3251.14, 'trades': 38.0, 'tb_base_av': 178440.0, 'tb_quote_av': 2860.53, 'ignore': 0.0}, {'Datetime': '2020-12-22 20:09:00', 'Open': 0.016033, 'High': 0.01606, 'Low': 0.016019, 'Close': 0.016027, 'Volume': 1422530.0, 'close_time': 1608670000000.0, 'quote_av': 22825.8, 'trades': 68.0, 'tb_base_av': 1285570.0, 'tb_quote_av': 20629.9, 'ignore': 0.0}, {'Datetime': '2020-12-22 20:10:00', 'Open': 0.016036, 'High': 0.016053, 'Low': 0.016035, 'Close': 0.016045, 'Volume': 255497.0, 'close_time': 1608670000000.0, 'quote_av': 4099.25, 'trades': 54.0, 'tb_base_av': 236071.0, 'tb_quote_av': 3787.62, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2021-01-26 13:21:00', 'Open': 0.028594, 'High': 0.028698, 'Low': 0.02858, 'Close': 0.028662, 'Volume': 403103.0, 'close_time': 1611670000000.0, 'quote_av': 11547.4, 'trades': 59.0, 'tb_base_av': 196998.0, 'tb_quote_av': 5641.31, 'ignore': 0.0}, {'Datetime': '2021-01-26 13:22:00', 'Open': 0.028665, 'High': 0.028713, 'Low': 0.028631, 'Close': 0.028713, 'Volume': 355998.0, 'close_time': 1611670000000.0, 'quote_av': 10203.7, 'trades': 71.0, 'tb_base_av': 284600.0, 'tb_quote_av': 8158.43, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:40 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2021-01-26 13:23:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2021-01-26 13:23:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2021-01-26 13:23:00', 'Open': 0.028714, 'High': 0.028749, 'Low': 0.028676, 'Close': 0.028688, 'Volume': 487881.0, 'close_time': 1611670000000.0, 'quote_av': 14006.2, 'trades': 75.0, 'tb_base_av': 373018.0, 'tb_quote_av': 10709.5, 'ignore': 0.0}, {'Datetime': '2021-01-26 13:24:00', 'Open': 0.028667, 'High': 0.028691, 'Low': 0.028638, 'Close': 0.028649, 'Volume': 328759.0, 'close_time': 1611670000000.0, 'quote_av': 9422.12, 'trades': 52.0, 'tb_base_av': 189189.0, 'tb_quote_av': 5421.66, 'ignore': 0.0}, {'Datetime': '2021-01-26 13:25:00', 'Open': 0.028651, 'High': 0.028659, 'Low': 0.028626, 'Close': 0.028636, 'Volume': 364690.0, 'close_time': 1611670000000.0, 'quote_av': 10445.7, 'trades': 58.0, 'tb_base_av': 246009.0, 'tb_quote_av': 7047.06, 'ignore': 0.0}, {'Datetime': '2021-01-26 13:26:00', 'Open': 0.028627, 'High': 0.028648, 'Low': 0.028571, 'Close': 0.028617, 'Volume': 355738.0, 'close_time': 1611670000000.0, 'quote_av': 10175.1, 'trades': 64.0, 'tb_base_av': 197665.0, 'tb_quote_av': 5655.58, 'ignore': 0.0}, {'Datetime': '2021-01-26 13:27:00', 'Open': 0.028614, 'High': 0.028621, 'Low': 0.028508, 'Close': 0.028559, 'Volume': 1257840.0, 'close_time': 1611670000000.0, 'quote_av': 35920.2, 'trades': 100.0, 'tb_base_av': 838735.0, 'tb_quote_av': 23940.6, 'ignore': 0.0}, {'Datetime': '2021-01-26 13:28:00', 'Open': 0.02855, 'High': 0.028591, 'Low': 0.028502, 'Close': 0.028529, 'Volume': 246388.0, 'close_time': 1611670000000.0, 'quote_av': 7032.51, 'trades': 63.0, 'tb_base_av': 144613.0, 'tb_quote_av': 4128.7, 'ignore': 0.0}, {'Datetime': '2021-01-26 13:29:00', 'Open': 0.028511, 'High': 0.02855, 'Low': 0.028507, 'Close': 0.028518, 'Volume': 456428.0, 'close_time': 1611670000000.0, 'quote_av': 13021.2, 'trades': 72.0, 'tb_base_av': 137583.0, 'tb_quote_av': 3926.03, 'ignore': 0.0}, {'Datetime': '2021-01-26 13:30:00', 'Open': 0.028534, 'High': 0.028665, 'Low': 0.028534, 'Close': 0.02861, 'Volume': 1417230.0, 'close_time': 1611670000000.0, 'quote_av': 40526.6, 'trades': 148.0, 'tb_base_av': 618383.0, 'tb_quote_av': 17686.2, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2021-03-02 06:41:00', 'Open': 0.043896, 'High': 0.044054, 'Low': 0.043894, 'Close': 0.044029, 'Volume': 1253140.0, 'close_time': 1614670000000.0, 'quote_av': 55103.3, 'trades': 131.0, 'tb_base_av': 438783.0, 'tb_quote_av': 19301.6, 'ignore': 0.0}, {'Datetime': '2021-03-02 06:42:00', 'Open': 0.04405, 'High': 0.044063, 'Low': 0.043969, 'Close': 0.044047, 'Volume': 346556.0, 'close_time': 1614670000000.0, 'quote_av': 15257.1, 'trades': 61.0, 'tb_base_av': 204928.0, 'tb_quote_av': 9024.06, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:40 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2021-03-02 06:43:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2021-03-02 06:43:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2021-03-02 06:43:00', 'Open': 0.044043, 'High': 0.044127, 'Low': 0.044025, 'Close': 0.04407, 'Volume': 1238980.0, 'close_time': 1614670000000.0, 'quote_av': 54622.8, 'trades': 113.0, 'tb_base_av': 669517.0, 'tb_quote_av': 29523.3, 'ignore': 0.0}, {'Datetime': '2021-03-02 06:44:00', 'Open': 0.044016, 'High': 0.044091, 'Low': 0.043989, 'Close': 0.04408, 'Volume': 239578.0, 'close_time': 1614670000000.0, 'quote_av': 10554.6, 'trades': 39.0, 'tb_base_av': 184745.0, 'tb_quote_av': 8138.95, 'ignore': 0.0}, {'Datetime': '2021-03-02 06:45:00', 'Open': 0.04406, 'High': 0.04406, 'Low': 0.043999, 'Close': 0.044011, 'Volume': 355531.0, 'close_time': 1614670000000.0, 'quote_av': 15647.7, 'trades': 45.0, 'tb_base_av': 272114.0, 'tb_quote_av': 11977.3, 'ignore': 0.0}, {'Datetime': '2021-03-02 06:46:00', 'Open': 0.044015, 'High': 0.044031, 'Low': 0.043922, 'Close': 0.043968, 'Volume': 940104.0, 'close_time': 1614670000000.0, 'quote_av': 41330.6, 'trades': 85.0, 'tb_base_av': 355034.0, 'tb_quote_av': 15614.5, 'ignore': 0.0}, {'Datetime': '2021-03-02 06:47:00', 'Open': 0.043963, 'High': 0.044025, 'Low': 0.043954, 'Close': 0.043996, 'Volume': 507660.0, 'close_time': 1614670000000.0, 'quote_av': 22336.0, 'trades': 49.0, 'tb_base_av': 403271.0, 'tb_quote_av': 17743.8, 'ignore': 0.0}, {'Datetime': '2021-03-02 06:48:00', 'Open': 0.043996, 'High': 0.044024, 'Low': 0.043939, 'Close': 0.043942, 'Volume': 695867.0, 'close_time': 1614670000000.0, 'quote_av': 30605.6, 'trades': 82.0, 'tb_base_av': 301544.0, 'tb_quote_av': 13268.7, 'ignore': 0.0}, {'Datetime': '2021-03-02 06:49:00', 'Open': 0.043944, 'High': 0.043956, 'Low': 0.043915, 'Close': 0.043949, 'Volume': 198741.0, 'close_time': 1614670000000.0, 'quote_av': 8731.66, 'trades': 35.0, 'tb_base_av': 51877.0, 'tb_quote_av': 2279.62, 'ignore': 0.0}, {'Datetime': '2021-03-02 06:50:00', 'Open': 0.043925, 'High': 0.043929, 'Low': 0.043725, 'Close': 0.04376, 'Volume': 952498.0, 'close_time': 1614670000000.0, 'quote_av': 41714.2, 'trades': 141.0, 'tb_base_av': 267140.0, 'tb_quote_av': 11697.8, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2021-04-06 00:01:00', 'Open': 0.102654, 'High': 0.103152, 'Low': 0.102543, 'Close': 0.103011, 'Volume': 2409310.0, 'close_time': 1617670000000.0, 'quote_av': 247973.0, 'trades': 705.0, 'tb_base_av': 1573980.0, 'tb_quote_av': 162040.0, 'ignore': 0.0}, {'Datetime': '2021-04-06 00:02:00', 'Open': 0.103015, 'High': 0.103436, 'Low': 0.103011, 'Close': 0.10318, 'Volume': 4836030.0, 'close_time': 1617670000000.0, 'quote_av': 499440.0, 'trades': 1263.0, 'tb_base_av': 2520360.0, 'tb_quote_av': 260323.0, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:40 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2021-04-06 00:03:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2021-04-06 00:03:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2021-04-06 00:03:00', 'Open': 0.103131, 'High': 0.103177, 'Low': 0.10286, 'Close': 0.10286, 'Volume': 1938630.0, 'close_time': 1617670000000.0, 'quote_av': 199721.0, 'trades': 565.0, 'tb_base_av': 694409.0, 'tb_quote_av': 71546.6, 'ignore': 0.0}, {'Datetime': '2021-04-06 00:04:00', 'Open': 0.102861, 'High': 0.103074, 'Low': 0.102727, 'Close': 0.102899, 'Volume': 1640410.0, 'close_time': 1617670000000.0, 'quote_av': 168865.0, 'trades': 398.0, 'tb_base_av': 1239880.0, 'tb_quote_av': 127656.0, 'ignore': 0.0}, {'Datetime': '2021-04-06 00:05:00', 'Open': 0.102899, 'High': 0.103088, 'Low': 0.10289, 'Close': 0.103053, 'Volume': 1285930.0, 'close_time': 1617670000000.0, 'quote_av': 132424.0, 'trades': 332.0, 'tb_base_av': 601591.0, 'tb_quote_av': 61948.4, 'ignore': 0.0}, {'Datetime': '2021-04-06 00:06:00', 'Open': 0.102998, 'High': 0.103, 'Low': 0.102516, 'Close': 0.102838, 'Volume': 3484960.0, 'close_time': 1617670000000.0, 'quote_av': 358116.0, 'trades': 580.0, 'tb_base_av': 1272300.0, 'tb_quote_av': 130762.0, 'ignore': 0.0}, {'Datetime': '2021-04-06 00:07:00', 'Open': 0.102865, 'High': 0.103211, 'Low': 0.102666, 'Close': 0.102845, 'Volume': 2869120.0, 'close_time': 1617670000000.0, 'quote_av': 295348.0, 'trades': 618.0, 'tb_base_av': 1614690.0, 'tb_quote_av': 166296.0, 'ignore': 0.0}, {'Datetime': '2021-04-06 00:08:00', 'Open': 0.102808, 'High': 0.102808, 'Low': 0.102532, 'Close': 0.102589, 'Volume': 945939.0, 'close_time': 1617670000000.0, 'quote_av': 97112.7, 'trades': 263.0, 'tb_base_av': 333395.0, 'tb_quote_av': 34226.8, 'ignore': 0.0}, {'Datetime': '2021-04-06 00:09:00', 'Open': 0.102577, 'High': 0.102755, 'Low': 0.102505, 'Close': 0.102644, 'Volume': 1123650.0, 'close_time': 1617670000000.0, 'quote_av': 115285.0, 'trades': 281.0, 'tb_base_av': 587289.0, 'tb_quote_av': 60279.7, 'ignore': 0.0}, {'Datetime': '2021-04-06 00:10:00', 'Open': 0.102623, 'High': 0.102623, 'Low': 0.102027, 'Close': 0.102027, 'Volume': 3260700.0, 'close_time': 1617670000000.0, 'quote_av': 333555.0, 'trades': 890.0, 'tb_base_av': 990150.0, 'tb_quote_av': 101307.0, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2021-05-10 17:21:00', 'Open': 0.219399, 'High': 0.219852, 'Low': 0.219197, 'Close': 0.219541, 'Volume': 697345.0, 'close_time': 1620670000000.0, 'quote_av': 153046.0, 'trades': 296.0, 'tb_base_av': 303110.0, 'tb_quote_av': 66541.7, 'ignore': 0.0}, {'Datetime': '2021-05-10 17:22:00', 'Open': 0.219539, 'High': 0.219787, 'Low': 0.219299, 'Close': 0.219384, 'Volume': 771438.0, 'close_time': 1620670000000.0, 'quote_av': 169372.0, 'trades': 255.0, 'tb_base_av': 442681.0, 'tb_quote_av': 97199.8, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:40 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2021-05-10 17:23:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2021-05-10 17:23:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2021-05-10 17:23:00', 'Open': 0.219373, 'High': 0.219397, 'Low': 0.218988, 'Close': 0.21904, 'Volume': 700541.0, 'close_time': 1620670000000.0, 'quote_av': 153503.0, 'trades': 261.0, 'tb_base_av': 307889.0, 'tb_quote_av': 67480.4, 'ignore': 0.0}, {'Datetime': '2021-05-10 17:24:00', 'Open': 0.219013, 'High': 0.219239, 'Low': 0.218758, 'Close': 0.219023, 'Volume': 1618050.0, 'close_time': 1620670000000.0, 'quote_av': 354346.0, 'trades': 384.0, 'tb_base_av': 900475.0, 'tb_quote_av': 197274.0, 'ignore': 0.0}, {'Datetime': '2021-05-10 17:25:00', 'Open': 0.219028, 'High': 0.219086, 'Low': 0.218238, 'Close': 0.218243, 'Volume': 1061930.0, 'close_time': 1620670000000.0, 'quote_av': 232159.0, 'trades': 481.0, 'tb_base_av': 332743.0, 'tb_quote_av': 72763.7, 'ignore': 0.0}, {'Datetime': '2021-05-10 17:26:00', 'Open': 0.218233, 'High': 0.218743, 'Low': 0.218142, 'Close': 0.218597, 'Volume': 1286080.0, 'close_time': 1620670000000.0, 'quote_av': 281007.0, 'trades': 392.0, 'tb_base_av': 744687.0, 'tb_quote_av': 162719.0, 'ignore': 0.0}, {'Datetime': '2021-05-10 17:27:00', 'Open': 0.218623, 'High': 0.218994, 'Low': 0.218392, 'Close': 0.21849, 'Volume': 944468.0, 'close_time': 1620670000000.0, 'quote_av': 206629.0, 'trades': 290.0, 'tb_base_av': 359993.0, 'tb_quote_av': 78739.2, 'ignore': 0.0}, {'Datetime': '2021-05-10 17:28:00', 'Open': 0.218435, 'High': 0.218843, 'Low': 0.218411, 'Close': 0.218511, 'Volume': 585629.0, 'close_time': 1620670000000.0, 'quote_av': 128040.0, 'trades': 176.0, 'tb_base_av': 361850.0, 'tb_quote_av': 79101.8, 'ignore': 0.0}, {'Datetime': '2021-05-10 17:29:00', 'Open': 0.21851, 'High': 0.218893, 'Low': 0.218337, 'Close': 0.218781, 'Volume': 1326730.0, 'close_time': 1620670000000.0, 'quote_av': 290072.0, 'trades': 271.0, 'tb_base_av': 495754.0, 'tb_quote_av': 108433.0, 'ignore': 0.0}, {'Datetime': '2021-05-10 17:30:00', 'Open': 0.218781, 'High': 0.21882, 'Low': 0.218479, 'Close': 0.218804, 'Volume': 972586.0, 'close_time': 1620670000000.0, 'quote_av': 212639.0, 'trades': 229.0, 'tb_base_av': 561553.0, 'tb_quote_av': 122778.0, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2021-06-14 10:41:00', 'Open': 0.11056, 'High': 0.11067, 'Low': 0.11051, 'Close': 0.11053, 'Volume': 318682.0, 'close_time': 1623670000000.0, 'quote_av': 35244.3, 'trades': 97.0, 'tb_base_av': 233344.0, 'tb_quote_av': 25809.4, 'ignore': 0.0}, {'Datetime': '2021-06-14 10:42:00', 'Open': 0.11054, 'High': 0.1106, 'Low': 0.11048, 'Close': 0.11055, 'Volume': 168712.0, 'close_time': 1623670000000.0, 'quote_av': 18650.4, 'trades': 79.0, 'tb_base_av': 97184.0, 'tb_quote_av': 10745.1, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:41 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1050, "Table 'vetusdt-f' already exists")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 35, in change_db_data
    conn.execute(text(text_msg))
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1050, "Table 'vetusdt-f' already exists")
[SQL: CREATE TABLE `crypto_data`.`vetusdt-f`(
                `Datetime` DATETIME NOT NULL,
                `Open` FLOAT NOT NULL,
                `High` FLOAT NOT NULL,
                `Low` FLOAT NOT NULL,
                `Close` FLOAT NOT NULL,
                `Volume` FLOAT NOT NULL,
                `close_time` FLOAT NOT NULL,
                `quote_av` FLOAT NOT NULL,
                `trades` FLOAT NOT NULL,
                `tb_base_av` FLOAT NOT NULL,
                `tb_quote_av` FLOAT NOT NULL,
                `ignore` FLOAT NOT NULL,
                PRIMARY KEY(`Datetime`)
                );]
(Background on this error at: https://sqlalche.me/e/20/e3q8)

2025-02-19 14:41 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2020-02-14 08:03:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2020-02-14 08:03:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2020-02-14 08:03:00', 'Open': 0.007731, 'High': 0.007731, 'Low': 0.007689, 'Close': 0.007689, 'Volume': 70074.0, 'close_time': 1581670000000.0, 'quote_av': 540.701, 'trades': 5.0, 'tb_base_av': 50064.0, 'tb_quote_av': 386.244, 'ignore': 0.0}, {'Datetime': '2020-02-14 08:04:00', 'Open': 0.007689, 'High': 0.007729, 'Low': 0.007685, 'Close': 0.007729, 'Volume': 838629.0, 'close_time': 1581670000000.0, 'quote_av': 6464.46, 'trades': 41.0, 'tb_base_av': 663954.0, 'tb_quote_av': 5121.04, 'ignore': 0.0}, {'Datetime': '2020-02-14 08:05:00', 'Open': 0.007729, 'High': 0.007736, 'Low': 0.007683, 'Close': 0.007724, 'Volume': 602488.0, 'close_time': 1581670000000.0, 'quote_av': 4653.36, 'trades': 69.0, 'tb_base_av': 499488.0, 'tb_quote_av': 3860.27, 'ignore': 0.0}, {'Datetime': '2020-02-14 08:06:00', 'Open': 0.007724, 'High': 0.007749, 'Low': 0.007701, 'Close': 0.007747, 'Volume': 376875.0, 'close_time': 1581670000000.0, 'quote_av': 2908.07, 'trades': 95.0, 'tb_base_av': 144352.0, 'tb_quote_av': 1115.35, 'ignore': 0.0}, {'Datetime': '2020-02-14 08:07:00', 'Open': 0.007747, 'High': 0.007748, 'Low': 0.007746, 'Close': 0.007748, 'Volume': 350974.0, 'close_time': 1581670000000.0, 'quote_av': 2718.67, 'trades': 116.0, 'tb_base_av': 16623.0, 'tb_quote_av': 128.786, 'ignore': 0.0}, {'Datetime': '2020-02-14 08:08:00', 'Open': 0.007748, 'High': 0.007749, 'Low': 0.007719, 'Close': 0.007725, 'Volume': 783338.0, 'close_time': 1581670000000.0, 'quote_av': 6067.9, 'trades': 122.0, 'tb_base_av': 114663.0, 'tb_quote_av': 888.42, 'ignore': 0.0}, {'Datetime': '2020-02-14 08:09:00', 'Open': 0.007725, 'High': 0.007725, 'Low': 0.007709, 'Close': 0.007713, 'Volume': 236534.0, 'close_time': 1581670000000.0, 'quote_av': 1825.12, 'trades': 99.0, 'tb_base_av': 164467.0, 'tb_quote_av': 1269.09, 'ignore': 0.0}, {'Datetime': '2020-02-14 08:10:00', 'Open': 0.007714, 'High': 0.007725, 'Low': 0.007714, 'Close': 0.007716, 'Volume': 107248.0, 'close_time': 1581670000000.0, 'quote_av': 827.355, 'trades': 27.0, 'tb_base_av': 104349.0, 'tb_quote_av': 804.989, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2020-03-20 01:21:00', 'Open': 0.002916, 'High': 0.002916, 'Low': 0.002916, 'Close': 0.002916, 'Volume': 17925.0, 'close_time': 1584670000000.0, 'quote_av': 52.2693, 'trades': 2.0, 'tb_base_av': 17925.0, 'tb_quote_av': 52.2693, 'ignore': 0.0}, {'Datetime': '2020-03-20 01:22:00', 'Open': 0.002916, 'High': 0.002916, 'Low': 0.002911, 'Close': 0.002911, 'Volume': 33823.0, 'close_time': 1584670000000.0, 'quote_av': 98.5563, 'trades': 4.0, 'tb_base_av': 31778.0, 'tb_quote_av': 92.6013, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:41 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2020-03-20 01:23:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2020-03-20 01:23:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2020-03-20 01:23:00', 'Open': 0.002908, 'High': 0.002911, 'Low': 0.002908, 'Close': 0.002911, 'Volume': 45012.0, 'close_time': 1584670000000.0, 'quote_av': 131.017, 'trades': 10.0, 'tb_base_av': 40664.0, 'tb_quote_av': 118.373, 'ignore': 0.0}, {'Datetime': '2020-03-20 01:24:00', 'Open': 0.002909, 'High': 0.002909, 'Low': 0.002909, 'Close': 0.002909, 'Volume': 21338.0, 'close_time': 1584670000000.0, 'quote_av': 62.0722, 'trades': 2.0, 'tb_base_av': 0.0, 'tb_quote_av': 0.0, 'ignore': 0.0}, {'Datetime': '2020-03-20 01:25:00', 'Open': 0.002908, 'High': 0.002908, 'Low': 0.002904, 'Close': 0.002904, 'Volume': 35182.0, 'close_time': 1584670000000.0, 'quote_av': 102.247, 'trades': 4.0, 'tb_base_av': 7704.0, 'tb_quote_av': 22.4032, 'ignore': 0.0}, {'Datetime': '2020-03-20 01:26:00', 'Open': 0.002907, 'High': 0.002907, 'Low': 0.002907, 'Close': 0.002907, 'Volume': 13909.0, 'close_time': 1584670000000.0, 'quote_av': 40.4335, 'trades': 7.0, 'tb_base_av': 13909.0, 'tb_quote_av': 40.4335, 'ignore': 0.0}, {'Datetime': '2020-03-20 01:27:00', 'Open': 0.002907, 'High': 0.00291, 'Low': 0.002907, 'Close': 0.00291, 'Volume': 45013.0, 'close_time': 1584670000000.0, 'quote_av': 130.931, 'trades': 8.0, 'tb_base_av': 43351.0, 'tb_quote_av': 126.1, 'ignore': 0.0}, {'Datetime': '2020-03-20 01:28:00', 'Open': 0.002907, 'High': 0.002909, 'Low': 0.0029, 'Close': 0.0029, 'Volume': 128246.0, 'close_time': 1584670000000.0, 'quote_av': 372.182, 'trades': 7.0, 'tb_base_av': 12060.0, 'tb_quote_av': 35.0825, 'ignore': 0.0}, {'Datetime': '2020-03-20 01:29:00', 'Open': 0.002897, 'High': 0.002897, 'Low': 0.00288, 'Close': 0.00288, 'Volume': 678332.0, 'close_time': 1584670000000.0, 'quote_av': 1959.32, 'trades': 28.0, 'tb_base_av': 118801.0, 'tb_quote_av': 343.278, 'ignore': 0.0}, {'Datetime': '2020-03-20 01:30:00', 'Open': 0.002879, 'High': 0.002879, 'Low': 0.002851, 'Close': 0.002851, 'Volume': 1042260.0, 'close_time': 1584670000000.0, 'quote_av': 2988.47, 'trades': 45.0, 'tb_base_av': 305716.0, 'tb_quote_av': 879.231, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2020-04-23 18:41:00', 'Open': 0.00403, 'High': 0.004035, 'Low': 0.00403, 'Close': 0.004032, 'Volume': 529748.0, 'close_time': 1587670000000.0, 'quote_av': 2135.69, 'trades': 15.0, 'tb_base_av': 523431.0, 'tb_quote_av': 2110.22, 'ignore': 0.0}, {'Datetime': '2020-04-23 18:42:00', 'Open': 0.004032, 'High': 0.004032, 'Low': 0.004032, 'Close': 0.004032, 'Volume': 0.0, 'close_time': 1587670000000.0, 'quote_av': 0.0, 'trades': 0.0, 'tb_base_av': 0.0, 'tb_quote_av': 0.0, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:41 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2020-04-23 18:43:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2020-04-23 18:43:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2020-04-23 18:43:00', 'Open': 0.004032, 'High': 0.004032, 'Low': 0.004032, 'Close': 0.004032, 'Volume': 0.0, 'close_time': 1587670000000.0, 'quote_av': 0.0, 'trades': 0.0, 'tb_base_av': 0.0, 'tb_quote_av': 0.0, 'ignore': 0.0}, {'Datetime': '2020-04-23 18:44:00', 'Open': 0.004034, 'High': 0.004034, 'Low': 0.004034, 'Close': 0.004034, 'Volume': 2804.0, 'close_time': 1587670000000.0, 'quote_av': 11.3113, 'trades': 2.0, 'tb_base_av': 2804.0, 'tb_quote_av': 11.3113, 'ignore': 0.0}, {'Datetime': '2020-04-23 18:45:00', 'Open': 0.004034, 'High': 0.004035, 'Low': 0.004034, 'Close': 0.004035, 'Volume': 79490.0, 'close_time': 1587670000000.0, 'quote_av': 320.71, 'trades': 5.0, 'tb_base_av': 79490.0, 'tb_quote_av': 320.71, 'ignore': 0.0}, {'Datetime': '2020-04-23 18:46:00', 'Open': 0.004034, 'High': 0.004036, 'Low': 0.004033, 'Close': 0.004033, 'Volume': 168313.0, 'close_time': 1587670000000.0, 'quote_av': 679.04, 'trades': 6.0, 'tb_base_av': 68313.0, 'tb_quote_av': 275.649, 'ignore': 0.0}, {'Datetime': '2020-04-23 18:47:00', 'Open': 0.004036, 'High': 0.004036, 'Low': 0.004036, 'Close': 0.004036, 'Volume': 41040.0, 'close_time': 1587670000000.0, 'quote_av': 165.637, 'trades': 2.0, 'tb_base_av': 41040.0, 'tb_quote_av': 165.637, 'ignore': 0.0}, {'Datetime': '2020-04-23 18:48:00', 'Open': 0.004036, 'High': 0.004037, 'Low': 0.004036, 'Close': 0.004037, 'Volume': 442303.0, 'close_time': 1587670000000.0, 'quote_av': 1785.5, 'trades': 6.0, 'tb_base_av': 380907.0, 'tb_quote_av': 1537.7, 'ignore': 0.0}, {'Datetime': '2020-04-23 18:49:00', 'Open': 0.004036, 'High': 0.004036, 'Low': 0.004036, 'Close': 0.004036, 'Volume': 59984.0, 'close_time': 1587670000000.0, 'quote_av': 242.095, 'trades': 4.0, 'tb_base_av': 59984.0, 'tb_quote_av': 242.095, 'ignore': 0.0}, {'Datetime': '2020-04-23 18:50:00', 'Open': 0.004037, 'High': 0.004038, 'Low': 0.004037, 'Close': 0.004038, 'Volume': 70045.0, 'close_time': 1587670000000.0, 'quote_av': 282.842, 'trades': 4.0, 'tb_base_av': 70045.0, 'tb_quote_av': 282.842, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2020-05-28 12:01:00', 'Open': 0.005302, 'High': 0.005306, 'Low': 0.005296, 'Close': 0.005301, 'Volume': 1705550.0, 'close_time': 1590670000000.0, 'quote_av': 9039.9, 'trades': 53.0, 'tb_base_av': 277856.0, 'tb_quote_av': 1473.27, 'ignore': 0.0}, {'Datetime': '2020-05-28 12:02:00', 'Open': 0.005301, 'High': 0.005308, 'Low': 0.005294, 'Close': 0.005307, 'Volume': 2461100.0, 'close_time': 1590670000000.0, 'quote_av': 13045.1, 'trades': 101.0, 'tb_base_av': 1446980.0, 'tb_quote_av': 7667.62, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:41 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2020-05-28 12:03:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2020-05-28 12:03:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2020-05-28 12:03:00', 'Open': 0.005308, 'High': 0.005313, 'Low': 0.005305, 'Close': 0.005308, 'Volume': 1973770.0, 'close_time': 1590670000000.0, 'quote_av': 10476.2, 'trades': 50.0, 'tb_base_av': 576164.0, 'tb_quote_av': 3059.02, 'ignore': 0.0}, {'Datetime': '2020-05-28 12:04:00', 'Open': 0.005307, 'High': 0.005307, 'Low': 0.0053, 'Close': 0.005303, 'Volume': 427924.0, 'close_time': 1590670000000.0, 'quote_av': 2269.7, 'trades': 23.0, 'tb_base_av': 23629.0, 'tb_quote_av': 125.309, 'ignore': 0.0}, {'Datetime': '2020-05-28 12:05:00', 'Open': 0.005303, 'High': 0.005308, 'Low': 0.005303, 'Close': 0.005306, 'Volume': 633151.0, 'close_time': 1590670000000.0, 'quote_av': 3359.28, 'trades': 29.0, 'tb_base_av': 522626.0, 'tb_quote_av': 2773.01, 'ignore': 0.0}, {'Datetime': '2020-05-28 12:06:00', 'Open': 0.005307, 'High': 0.005308, 'Low': 0.005299, 'Close': 0.005302, 'Volume': 1814480.0, 'close_time': 1590670000000.0, 'quote_av': 9620.75, 'trades': 64.0, 'tb_base_av': 795132.0, 'tb_quote_av': 4216.63, 'ignore': 0.0}, {'Datetime': '2020-05-28 12:07:00', 'Open': 0.005302, 'High': 0.005313, 'Low': 0.005298, 'Close': 0.005313, 'Volume': 1571550.0, 'close_time': 1590670000000.0, 'quote_av': 8342.64, 'trades': 65.0, 'tb_base_av': 1138180.0, 'tb_quote_av': 6043.41, 'ignore': 0.0}, {'Datetime': '2020-05-28 12:08:00', 'Open': 0.005317, 'High': 0.005328, 'Low': 0.005226, 'Close': 0.00526, 'Volume': 41764200.0, 'close_time': 1590670000000.0, 'quote_av': 220192.0, 'trades': 1096.0, 'tb_base_av': 14064200.0, 'tb_quote_av': 74083.1, 'ignore': 0.0}, {'Datetime': '2020-05-28 12:09:00', 'Open': 0.005262, 'High': 0.005285, 'Low': 0.00526, 'Close': 0.005277, 'Volume': 5281950.0, 'close_time': 1590670000000.0, 'quote_av': 27864.9, 'trades': 257.0, 'tb_base_av': 3856700.0, 'tb_quote_av': 20347.0, 'ignore': 0.0}, {'Datetime': '2020-05-28 12:10:00', 'Open': 0.005278, 'High': 0.005284, 'Low': 0.005277, 'Close': 0.005282, 'Volume': 3960950.0, 'close_time': 1590670000000.0, 'quote_av': 20917.5, 'trades': 82.0, 'tb_base_av': 2652380.0, 'tb_quote_av': 14009.4, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2020-07-02 05:21:00', 'Open': 0.009375, 'High': 0.00938, 'Low': 0.009373, 'Close': 0.009374, 'Volume': 527408.0, 'close_time': 1593670000000.0, 'quote_av': 4945.07, 'trades': 24.0, 'tb_base_av': 314816.0, 'tb_quote_av': 2952.22, 'ignore': 0.0}, {'Datetime': '2020-07-02 05:22:00', 'Open': 0.009374, 'High': 0.009374, 'Low': 0.009349, 'Close': 0.009353, 'Volume': 1565400.0, 'close_time': 1593670000000.0, 'quote_av': 14658.2, 'trades': 152.0, 'tb_base_av': 288792.0, 'tb_quote_av': 2704.33, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:41 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2020-07-02 05:23:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2020-07-02 05:23:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2020-07-02 05:23:00', 'Open': 0.009354, 'High': 0.009358, 'Low': 0.009346, 'Close': 0.009356, 'Volume': 1865100.0, 'close_time': 1593670000000.0, 'quote_av': 17443.9, 'trades': 69.0, 'tb_base_av': 1336870.0, 'tb_quote_av': 12504.8, 'ignore': 0.0}, {'Datetime': '2020-07-02 05:24:00', 'Open': 0.009356, 'High': 0.009362, 'Low': 0.009355, 'Close': 0.009356, 'Volume': 222281.0, 'close_time': 1593670000000.0, 'quote_av': 2080.01, 'trades': 37.0, 'tb_base_av': 136211.0, 'tb_quote_av': 1274.77, 'ignore': 0.0}, {'Datetime': '2020-07-02 05:25:00', 'Open': 0.009356, 'High': 0.009356, 'Low': 0.00932, 'Close': 0.00934, 'Volume': 4286020.0, 'close_time': 1593670000000.0, 'quote_av': 40000.0, 'trades': 258.0, 'tb_base_av': 713431.0, 'tb_quote_av': 6660.38, 'ignore': 0.0}, {'Datetime': '2020-07-02 05:26:00', 'Open': 0.00934, 'High': 0.009355, 'Low': 0.00933, 'Close': 0.009337, 'Volume': 1886500.0, 'close_time': 1593670000000.0, 'quote_av': 17632.6, 'trades': 125.0, 'tb_base_av': 976961.0, 'tb_quote_av': 9131.5, 'ignore': 0.0}, {'Datetime': '2020-07-02 05:27:00', 'Open': 0.009337, 'High': 0.009348, 'Low': 0.009334, 'Close': 0.009338, 'Volume': 1732600.0, 'close_time': 1593670000000.0, 'quote_av': 16182.5, 'trades': 54.0, 'tb_base_av': 887412.0, 'tb_quote_av': 8288.13, 'ignore': 0.0}, {'Datetime': '2020-07-02 05:28:00', 'Open': 0.009337, 'High': 0.009338, 'Low': 0.009332, 'Close': 0.009332, 'Volume': 501897.0, 'close_time': 1593670000000.0, 'quote_av': 4685.48, 'trades': 39.0, 'tb_base_av': 245184.0, 'tb_quote_av': 2289.22, 'ignore': 0.0}, {'Datetime': '2020-07-02 05:29:00', 'Open': 0.009333, 'High': 0.009342, 'Low': 0.009332, 'Close': 0.009342, 'Volume': 445570.0, 'close_time': 1593670000000.0, 'quote_av': 4159.45, 'trades': 24.0, 'tb_base_av': 345570.0, 'tb_quote_av': 3226.13, 'ignore': 0.0}, {'Datetime': '2020-07-02 05:30:00', 'Open': 0.009341, 'High': 0.009341, 'Low': 0.009338, 'Close': 0.009338, 'Volume': 125655.0, 'close_time': 1593670000000.0, 'quote_av': 1173.55, 'trades': 15.0, 'tb_base_av': 10757.0, 'tb_quote_av': 100.46, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2020-08-05 22:41:00', 'Open': 0.01871, 'High': 0.018712, 'Low': 0.018635, 'Close': 0.018653, 'Volume': 2377670.0, 'close_time': 1596670000000.0, 'quote_av': 44411.5, 'trades': 105.0, 'tb_base_av': 216949.0, 'tb_quote_av': 4054.31, 'ignore': 0.0}, {'Datetime': '2020-08-05 22:42:00', 'Open': 0.018647, 'High': 0.018669, 'Low': 0.018638, 'Close': 0.018669, 'Volume': 486037.0, 'close_time': 1596670000000.0, 'quote_av': 9063.58, 'trades': 26.0, 'tb_base_av': 186314.0, 'tb_quote_av': 3476.0, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:41 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2020-08-05 22:43:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2020-08-05 22:43:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2020-08-05 22:43:00', 'Open': 0.018669, 'High': 0.018715, 'Low': 0.018649, 'Close': 0.018702, 'Volume': 2195660.0, 'close_time': 1596670000000.0, 'quote_av': 41039.7, 'trades': 96.0, 'tb_base_av': 1175340.0, 'tb_quote_av': 21967.6, 'ignore': 0.0}, {'Datetime': '2020-08-05 22:44:00', 'Open': 0.018712, 'High': 0.018716, 'Low': 0.018682, 'Close': 0.018682, 'Volume': 1485140.0, 'close_time': 1596670000000.0, 'quote_av': 27778.8, 'trades': 65.0, 'tb_base_av': 272016.0, 'tb_quote_av': 5087.78, 'ignore': 0.0}, {'Datetime': '2020-08-05 22:45:00', 'Open': 0.018703, 'High': 0.01874, 'Low': 0.018699, 'Close': 0.01871, 'Volume': 2683050.0, 'close_time': 1596670000000.0, 'quote_av': 50225.2, 'trades': 281.0, 'tb_base_av': 1604620.0, 'tb_quote_av': 30040.8, 'ignore': 0.0}, {'Datetime': '2020-08-05 22:46:00', 'Open': 0.018711, 'High': 0.018754, 'Low': 0.01871, 'Close': 0.018741, 'Volume': 1411200.0, 'close_time': 1596670000000.0, 'quote_av': 26442.6, 'trades': 234.0, 'tb_base_av': 777423.0, 'tb_quote_av': 14571.5, 'ignore': 0.0}, {'Datetime': '2020-08-05 22:47:00', 'Open': 0.01874, 'High': 0.018778, 'Low': 0.01874, 'Close': 0.018762, 'Volume': 1298840.0, 'close_time': 1596670000000.0, 'quote_av': 24369.3, 'trades': 131.0, 'tb_base_av': 831154.0, 'tb_quote_av': 15592.5, 'ignore': 0.0}, {'Datetime': '2020-08-05 22:48:00', 'Open': 0.018768, 'High': 0.018782, 'Low': 0.018761, 'Close': 0.018782, 'Volume': 399794.0, 'close_time': 1596670000000.0, 'quote_av': 7504.64, 'trades': 39.0, 'tb_base_av': 201483.0, 'tb_quote_av': 3783.49, 'ignore': 0.0}, {'Datetime': '2020-08-05 22:49:00', 'Open': 0.018778, 'High': 0.018786, 'Low': 0.018762, 'Close': 0.018771, 'Volume': 230185.0, 'close_time': 1596670000000.0, 'quote_av': 4321.25, 'trades': 18.0, 'tb_base_av': 163224.0, 'tb_quote_av': 3064.84, 'ignore': 0.0}, {'Datetime': '2020-08-05 22:50:00', 'Open': 0.018769, 'High': 0.018786, 'Low': 0.01876, 'Close': 0.01877, 'Volume': 633506.0, 'close_time': 1596670000000.0, 'quote_av': 11888.6, 'trades': 30.0, 'tb_base_av': 277051.0, 'tb_quote_av': 5199.58, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2020-09-09 16:01:00', 'Open': 0.012951, 'High': 0.012975, 'Low': 0.012941, 'Close': 0.012961, 'Volume': 1236670.0, 'close_time': 1599670000000.0, 'quote_av': 16026.5, 'trades': 210.0, 'tb_base_av': 664681.0, 'tb_quote_av': 8617.83, 'ignore': 0.0}, {'Datetime': '2020-09-09 16:02:00', 'Open': 0.012958, 'High': 0.012975, 'Low': 0.012938, 'Close': 0.012975, 'Volume': 1390940.0, 'close_time': 1599670000000.0, 'quote_av': 18030.2, 'trades': 111.0, 'tb_base_av': 969870.0, 'tb_quote_av': 12574.7, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:41 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2020-09-09 16:03:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2020-09-09 16:03:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2020-09-09 16:03:00', 'Open': 0.01297, 'High': 0.012977, 'Low': 0.012956, 'Close': 0.012977, 'Volume': 1286750.0, 'close_time': 1599670000000.0, 'quote_av': 16684.1, 'trades': 132.0, 'tb_base_av': 742105.0, 'tb_quote_av': 9624.34, 'ignore': 0.0}, {'Datetime': '2020-09-09 16:04:00', 'Open': 0.012976, 'High': 0.012978, 'Low': 0.012961, 'Close': 0.01297, 'Volume': 356814.0, 'close_time': 1599670000000.0, 'quote_av': 4629.04, 'trades': 78.0, 'tb_base_av': 189598.0, 'tb_quote_av': 2460.36, 'ignore': 0.0}, {'Datetime': '2020-09-09 16:05:00', 'Open': 0.012977, 'High': 0.013, 'Low': 0.012972, 'Close': 0.012988, 'Volume': 1607940.0, 'close_time': 1599670000000.0, 'quote_av': 20872.7, 'trades': 111.0, 'tb_base_av': 587189.0, 'tb_quote_av': 7625.57, 'ignore': 0.0}, {'Datetime': '2020-09-09 16:06:00', 'Open': 0.012978, 'High': 0.012993, 'Low': 0.012949, 'Close': 0.012949, 'Volume': 957717.0, 'close_time': 1599670000000.0, 'quote_av': 12422.3, 'trades': 47.0, 'tb_base_av': 87213.0, 'tb_quote_av': 1132.65, 'ignore': 0.0}, {'Datetime': '2020-09-09 16:07:00', 'Open': 0.012947, 'High': 0.012967, 'Low': 0.012875, 'Close': 0.012875, 'Volume': 1509000.0, 'close_time': 1599670000000.0, 'quote_av': 19483.8, 'trades': 112.0, 'tb_base_av': 328768.0, 'tb_quote_av': 4258.84, 'ignore': 0.0}, {'Datetime': '2020-09-09 16:08:00', 'Open': 0.012875, 'High': 0.012891, 'Low': 0.012776, 'Close': 0.012786, 'Volume': 8867120.0, 'close_time': 1599670000000.0, 'quote_av': 113629.0, 'trades': 343.0, 'tb_base_av': 1707070.0, 'tb_quote_av': 21873.6, 'ignore': 0.0}, {'Datetime': '2020-09-09 16:09:00', 'Open': 0.012797, 'High': 0.01283, 'Low': 0.012764, 'Close': 0.01283, 'Volume': 1975090.0, 'close_time': 1599670000000.0, 'quote_av': 25279.9, 'trades': 133.0, 'tb_base_av': 1215600.0, 'tb_quote_av': 15570.4, 'ignore': 0.0}, {'Datetime': '2020-09-09 16:10:00', 'Open': 0.012812, 'High': 0.01283, 'Low': 0.012811, 'Close': 0.012815, 'Volume': 369032.0, 'close_time': 1599670000000.0, 'quote_av': 4730.5, 'trades': 28.0, 'tb_base_av': 114258.0, 'tb_quote_av': 1465.27, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2020-10-14 09:21:00', 'Open': 0.011373, 'High': 0.011377, 'Low': 0.011366, 'Close': 0.011366, 'Volume': 191562.0, 'close_time': 1602670000000.0, 'quote_av': 2178.56, 'trades': 12.0, 'tb_base_av': 83588.0, 'tb_quote_av': 950.791, 'ignore': 0.0}, {'Datetime': '2020-10-14 09:22:00', 'Open': 0.011366, 'High': 0.011383, 'Low': 0.011366, 'Close': 0.011381, 'Volume': 167628.0, 'close_time': 1602670000000.0, 'quote_av': 1907.35, 'trades': 11.0, 'tb_base_av': 131167.0, 'tb_quote_av': 1492.64, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:41 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2020-10-14 09:23:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2020-10-14 09:23:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2020-10-14 09:23:00', 'Open': 0.01138, 'High': 0.011382, 'Low': 0.011365, 'Close': 0.01137, 'Volume': 181620.0, 'close_time': 1602670000000.0, 'quote_av': 2065.98, 'trades': 9.0, 'tb_base_av': 90078.0, 'tb_quote_av': 1024.98, 'ignore': 0.0}, {'Datetime': '2020-10-14 09:24:00', 'Open': 0.011368, 'High': 0.011381, 'Low': 0.011367, 'Close': 0.011371, 'Volume': 336346.0, 'close_time': 1602670000000.0, 'quote_av': 3826.02, 'trades': 15.0, 'tb_base_av': 188247.0, 'tb_quote_av': 2141.84, 'ignore': 0.0}, {'Datetime': '2020-10-14 09:25:00', 'Open': 0.011376, 'High': 0.011379, 'Low': 0.011365, 'Close': 0.011367, 'Volume': 179966.0, 'close_time': 1602670000000.0, 'quote_av': 2046.99, 'trades': 12.0, 'tb_base_av': 126367.0, 'tb_quote_av': 1437.68, 'ignore': 0.0}, {'Datetime': '2020-10-14 09:26:00', 'Open': 0.011365, 'High': 0.011365, 'Low': 0.011355, 'Close': 0.011355, 'Volume': 133773.0, 'close_time': 1602670000000.0, 'quote_av': 1519.84, 'trades': 24.0, 'tb_base_av': 38913.0, 'tb_quote_av': 442.091, 'ignore': 0.0}, {'Datetime': '2020-10-14 09:27:00', 'Open': 0.011355, 'High': 0.011361, 'Low': 0.011345, 'Close': 0.011348, 'Volume': 572541.0, 'close_time': 1602670000000.0, 'quote_av': 6498.71, 'trades': 24.0, 'tb_base_av': 254793.0, 'tb_quote_av': 2893.03, 'ignore': 0.0}, {'Datetime': '2020-10-14 09:28:00', 'Open': 0.011352, 'High': 0.011355, 'Low': 0.011345, 'Close': 0.011352, 'Volume': 316340.0, 'close_time': 1602670000000.0, 'quote_av': 3590.41, 'trades': 13.0, 'tb_base_av': 152931.0, 'tb_quote_av': 1736.0, 'ignore': 0.0}, {'Datetime': '2020-10-14 09:29:00', 'Open': 0.011352, 'High': 0.011352, 'Low': 0.011345, 'Close': 0.011346, 'Volume': 271054.0, 'close_time': 1602670000000.0, 'quote_av': 3075.98, 'trades': 9.0, 'tb_base_av': 116440.0, 'tb_quote_av': 1321.66, 'ignore': 0.0}, {'Datetime': '2020-10-14 09:30:00', 'Open': 0.011348, 'High': 0.011358, 'Low': 0.011342, 'Close': 0.011342, 'Volume': 257879.0, 'close_time': 1602670000000.0, 'quote_av': 2925.81, 'trades': 22.0, 'tb_base_av': 51618.0, 'tb_quote_av': 585.913, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2020-11-18 02:41:00', 'Open': 0.012235, 'High': 0.012244, 'Low': 0.012227, 'Close': 0.012241, 'Volume': 159276.0, 'close_time': 1605670000000.0, 'quote_av': 1948.96, 'trades': 16.0, 'tb_base_av': 15164.0, 'tb_quote_av': 185.66, 'ignore': 0.0}, {'Datetime': '2020-11-18 02:42:00', 'Open': 0.012246, 'High': 0.012246, 'Low': 0.012217, 'Close': 0.012217, 'Volume': 313242.0, 'close_time': 1605670000000.0, 'quote_av': 3832.31, 'trades': 14.0, 'tb_base_av': 29001.0, 'tb_quote_av': 354.505, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:41 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2020-11-18 02:43:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2020-11-18 02:43:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2020-11-18 02:43:00', 'Open': 0.012226, 'High': 0.012226, 'Low': 0.012218, 'Close': 0.012223, 'Volume': 81833.0, 'close_time': 1605670000000.0, 'quote_av': 1000.35, 'trades': 5.0, 'tb_base_av': 81829.0, 'tb_quote_av': 1000.31, 'ignore': 0.0}, {'Datetime': '2020-11-18 02:44:00', 'Open': 0.012225, 'High': 0.012225, 'Low': 0.012216, 'Close': 0.012216, 'Volume': 289840.0, 'close_time': 1605670000000.0, 'quote_av': 3541.49, 'trades': 16.0, 'tb_base_av': 152544.0, 'tb_quote_av': 1863.79, 'ignore': 0.0}, {'Datetime': '2020-11-18 02:45:00', 'Open': 0.012214, 'High': 0.012214, 'Low': 0.012201, 'Close': 0.012208, 'Volume': 75633.0, 'close_time': 1605670000000.0, 'quote_av': 923.578, 'trades': 21.0, 'tb_base_av': 10000.0, 'tb_quote_av': 122.08, 'ignore': 0.0}, {'Datetime': '2020-11-18 02:46:00', 'Open': 0.012206, 'High': 0.012206, 'Low': 0.0122, 'Close': 0.0122, 'Volume': 282295.0, 'close_time': 1605670000000.0, 'quote_av': 3445.08, 'trades': 15.0, 'tb_base_av': 174462.0, 'tb_quote_av': 2129.17, 'ignore': 0.0}, {'Datetime': '2020-11-18 02:47:00', 'Open': 0.012202, 'High': 0.012207, 'Low': 0.012197, 'Close': 0.012201, 'Volume': 497428.0, 'close_time': 1605670000000.0, 'quote_av': 6068.71, 'trades': 18.0, 'tb_base_av': 190463.0, 'tb_quote_av': 2324.05, 'ignore': 0.0}, {'Datetime': '2020-11-18 02:48:00', 'Open': 0.012199, 'High': 0.012209, 'Low': 0.012199, 'Close': 0.012208, 'Volume': 448073.0, 'close_time': 1605670000000.0, 'quote_av': 5468.12, 'trades': 24.0, 'tb_base_av': 267075.0, 'tb_quote_av': 3259.27, 'ignore': 0.0}, {'Datetime': '2020-11-18 02:49:00', 'Open': 0.012208, 'High': 0.012208, 'Low': 0.012193, 'Close': 0.012196, 'Volume': 236261.0, 'close_time': 1605670000000.0, 'quote_av': 2882.39, 'trades': 26.0, 'tb_base_av': 155545.0, 'tb_quote_av': 1897.65, 'ignore': 0.0}, {'Datetime': '2020-11-18 02:50:00', 'Open': 0.012198, 'High': 0.012198, 'Low': 0.012191, 'Close': 0.012192, 'Volume': 157104.0, 'close_time': 1605670000000.0, 'quote_av': 1915.68, 'trades': 15.0, 'tb_base_av': 60771.0, 'tb_quote_av': 741.104, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2020-12-22 20:01:00', 'Open': 0.015993, 'High': 0.016018, 'Low': 0.015993, 'Close': 0.016014, 'Volume': 573118.0, 'close_time': 1608670000000.0, 'quote_av': 9174.32, 'trades': 64.0, 'tb_base_av': 241606.0, 'tb_quote_av': 3868.39, 'ignore': 0.0}, {'Datetime': '2020-12-22 20:02:00', 'Open': 0.016005, 'High': 0.016025, 'Low': 0.016002, 'Close': 0.016025, 'Volume': 82356.0, 'close_time': 1608670000000.0, 'quote_av': 1318.77, 'trades': 22.0, 'tb_base_av': 18503.0, 'tb_quote_av': 296.409, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:41 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2020-12-22 20:03:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2020-12-22 20:03:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2020-12-22 20:03:00', 'Open': 0.016026, 'High': 0.016056, 'Low': 0.016025, 'Close': 0.016038, 'Volume': 435230.0, 'close_time': 1608670000000.0, 'quote_av': 6979.79, 'trades': 74.0, 'tb_base_av': 268126.0, 'tb_quote_av': 4300.68, 'ignore': 0.0}, {'Datetime': '2020-12-22 20:04:00', 'Open': 0.016038, 'High': 0.016039, 'Low': 0.01601, 'Close': 0.016013, 'Volume': 208584.0, 'close_time': 1608670000000.0, 'quote_av': 3342.72, 'trades': 26.0, 'tb_base_av': 46174.0, 'tb_quote_av': 739.951, 'ignore': 0.0}, {'Datetime': '2020-12-22 20:05:00', 'Open': 0.016012, 'High': 0.016024, 'Low': 0.01601, 'Close': 0.016012, 'Volume': 124829.0, 'close_time': 1608670000000.0, 'quote_av': 1999.32, 'trades': 18.0, 'tb_base_av': 40383.0, 'tb_quote_av': 646.967, 'ignore': 0.0}, {'Datetime': '2020-12-22 20:06:00', 'Open': 0.016005, 'High': 0.016045, 'Low': 0.016005, 'Close': 0.016038, 'Volume': 537031.0, 'close_time': 1608670000000.0, 'quote_av': 8609.15, 'trades': 49.0, 'tb_base_av': 401747.0, 'tb_quote_av': 6440.98, 'ignore': 0.0}, {'Datetime': '2020-12-22 20:07:00', 'Open': 0.016038, 'High': 0.016049, 'Low': 0.016028, 'Close': 0.016035, 'Volume': 150233.0, 'close_time': 1608670000000.0, 'quote_av': 2409.66, 'trades': 71.0, 'tb_base_av': 116396.0, 'tb_quote_av': 1866.9, 'ignore': 0.0}, {'Datetime': '2020-12-22 20:08:00', 'Open': 0.016032, 'High': 0.016038, 'Low': 0.016018, 'Close': 0.016031, 'Volume': 202800.0, 'close_time': 1608670000000.0, 'quote_av': 3251.14, 'trades': 38.0, 'tb_base_av': 178440.0, 'tb_quote_av': 2860.53, 'ignore': 0.0}, {'Datetime': '2020-12-22 20:09:00', 'Open': 0.016033, 'High': 0.01606, 'Low': 0.016019, 'Close': 0.016027, 'Volume': 1422530.0, 'close_time': 1608670000000.0, 'quote_av': 22825.8, 'trades': 68.0, 'tb_base_av': 1285570.0, 'tb_quote_av': 20629.9, 'ignore': 0.0}, {'Datetime': '2020-12-22 20:10:00', 'Open': 0.016036, 'High': 0.016053, 'Low': 0.016035, 'Close': 0.016045, 'Volume': 255497.0, 'close_time': 1608670000000.0, 'quote_av': 4099.25, 'trades': 54.0, 'tb_base_av': 236071.0, 'tb_quote_av': 3787.62, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2021-01-26 13:21:00', 'Open': 0.028594, 'High': 0.028698, 'Low': 0.02858, 'Close': 0.028662, 'Volume': 403103.0, 'close_time': 1611670000000.0, 'quote_av': 11547.4, 'trades': 59.0, 'tb_base_av': 196998.0, 'tb_quote_av': 5641.31, 'ignore': 0.0}, {'Datetime': '2021-01-26 13:22:00', 'Open': 0.028665, 'High': 0.028713, 'Low': 0.028631, 'Close': 0.028713, 'Volume': 355998.0, 'close_time': 1611670000000.0, 'quote_av': 10203.7, 'trades': 71.0, 'tb_base_av': 284600.0, 'tb_quote_av': 8158.43, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:41 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2021-01-26 13:23:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2021-01-26 13:23:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2021-01-26 13:23:00', 'Open': 0.028714, 'High': 0.028749, 'Low': 0.028676, 'Close': 0.028688, 'Volume': 487881.0, 'close_time': 1611670000000.0, 'quote_av': 14006.2, 'trades': 75.0, 'tb_base_av': 373018.0, 'tb_quote_av': 10709.5, 'ignore': 0.0}, {'Datetime': '2021-01-26 13:24:00', 'Open': 0.028667, 'High': 0.028691, 'Low': 0.028638, 'Close': 0.028649, 'Volume': 328759.0, 'close_time': 1611670000000.0, 'quote_av': 9422.12, 'trades': 52.0, 'tb_base_av': 189189.0, 'tb_quote_av': 5421.66, 'ignore': 0.0}, {'Datetime': '2021-01-26 13:25:00', 'Open': 0.028651, 'High': 0.028659, 'Low': 0.028626, 'Close': 0.028636, 'Volume': 364690.0, 'close_time': 1611670000000.0, 'quote_av': 10445.7, 'trades': 58.0, 'tb_base_av': 246009.0, 'tb_quote_av': 7047.06, 'ignore': 0.0}, {'Datetime': '2021-01-26 13:26:00', 'Open': 0.028627, 'High': 0.028648, 'Low': 0.028571, 'Close': 0.028617, 'Volume': 355738.0, 'close_time': 1611670000000.0, 'quote_av': 10175.1, 'trades': 64.0, 'tb_base_av': 197665.0, 'tb_quote_av': 5655.58, 'ignore': 0.0}, {'Datetime': '2021-01-26 13:27:00', 'Open': 0.028614, 'High': 0.028621, 'Low': 0.028508, 'Close': 0.028559, 'Volume': 1257840.0, 'close_time': 1611670000000.0, 'quote_av': 35920.2, 'trades': 100.0, 'tb_base_av': 838735.0, 'tb_quote_av': 23940.6, 'ignore': 0.0}, {'Datetime': '2021-01-26 13:28:00', 'Open': 0.02855, 'High': 0.028591, 'Low': 0.028502, 'Close': 0.028529, 'Volume': 246388.0, 'close_time': 1611670000000.0, 'quote_av': 7032.51, 'trades': 63.0, 'tb_base_av': 144613.0, 'tb_quote_av': 4128.7, 'ignore': 0.0}, {'Datetime': '2021-01-26 13:29:00', 'Open': 0.028511, 'High': 0.02855, 'Low': 0.028507, 'Close': 0.028518, 'Volume': 456428.0, 'close_time': 1611670000000.0, 'quote_av': 13021.2, 'trades': 72.0, 'tb_base_av': 137583.0, 'tb_quote_av': 3926.03, 'ignore': 0.0}, {'Datetime': '2021-01-26 13:30:00', 'Open': 0.028534, 'High': 0.028665, 'Low': 0.028534, 'Close': 0.02861, 'Volume': 1417230.0, 'close_time': 1611670000000.0, 'quote_av': 40526.6, 'trades': 148.0, 'tb_base_av': 618383.0, 'tb_quote_av': 17686.2, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2021-03-02 06:41:00', 'Open': 0.043896, 'High': 0.044054, 'Low': 0.043894, 'Close': 0.044029, 'Volume': 1253140.0, 'close_time': 1614670000000.0, 'quote_av': 55103.3, 'trades': 131.0, 'tb_base_av': 438783.0, 'tb_quote_av': 19301.6, 'ignore': 0.0}, {'Datetime': '2021-03-02 06:42:00', 'Open': 0.04405, 'High': 0.044063, 'Low': 0.043969, 'Close': 0.044047, 'Volume': 346556.0, 'close_time': 1614670000000.0, 'quote_av': 15257.1, 'trades': 61.0, 'tb_base_av': 204928.0, 'tb_quote_av': 9024.06, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:41 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2021-03-02 06:43:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2021-03-02 06:43:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2021-03-02 06:43:00', 'Open': 0.044043, 'High': 0.044127, 'Low': 0.044025, 'Close': 0.04407, 'Volume': 1238980.0, 'close_time': 1614670000000.0, 'quote_av': 54622.8, 'trades': 113.0, 'tb_base_av': 669517.0, 'tb_quote_av': 29523.3, 'ignore': 0.0}, {'Datetime': '2021-03-02 06:44:00', 'Open': 0.044016, 'High': 0.044091, 'Low': 0.043989, 'Close': 0.04408, 'Volume': 239578.0, 'close_time': 1614670000000.0, 'quote_av': 10554.6, 'trades': 39.0, 'tb_base_av': 184745.0, 'tb_quote_av': 8138.95, 'ignore': 0.0}, {'Datetime': '2021-03-02 06:45:00', 'Open': 0.04406, 'High': 0.04406, 'Low': 0.043999, 'Close': 0.044011, 'Volume': 355531.0, 'close_time': 1614670000000.0, 'quote_av': 15647.7, 'trades': 45.0, 'tb_base_av': 272114.0, 'tb_quote_av': 11977.3, 'ignore': 0.0}, {'Datetime': '2021-03-02 06:46:00', 'Open': 0.044015, 'High': 0.044031, 'Low': 0.043922, 'Close': 0.043968, 'Volume': 940104.0, 'close_time': 1614670000000.0, 'quote_av': 41330.6, 'trades': 85.0, 'tb_base_av': 355034.0, 'tb_quote_av': 15614.5, 'ignore': 0.0}, {'Datetime': '2021-03-02 06:47:00', 'Open': 0.043963, 'High': 0.044025, 'Low': 0.043954, 'Close': 0.043996, 'Volume': 507660.0, 'close_time': 1614670000000.0, 'quote_av': 22336.0, 'trades': 49.0, 'tb_base_av': 403271.0, 'tb_quote_av': 17743.8, 'ignore': 0.0}, {'Datetime': '2021-03-02 06:48:00', 'Open': 0.043996, 'High': 0.044024, 'Low': 0.043939, 'Close': 0.043942, 'Volume': 695867.0, 'close_time': 1614670000000.0, 'quote_av': 30605.6, 'trades': 82.0, 'tb_base_av': 301544.0, 'tb_quote_av': 13268.7, 'ignore': 0.0}, {'Datetime': '2021-03-02 06:49:00', 'Open': 0.043944, 'High': 0.043956, 'Low': 0.043915, 'Close': 0.043949, 'Volume': 198741.0, 'close_time': 1614670000000.0, 'quote_av': 8731.66, 'trades': 35.0, 'tb_base_av': 51877.0, 'tb_quote_av': 2279.62, 'ignore': 0.0}, {'Datetime': '2021-03-02 06:50:00', 'Open': 0.043925, 'High': 0.043929, 'Low': 0.043725, 'Close': 0.04376, 'Volume': 952498.0, 'close_time': 1614670000000.0, 'quote_av': 41714.2, 'trades': 141.0, 'tb_base_av': 267140.0, 'tb_quote_av': 11697.8, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2021-04-06 00:01:00', 'Open': 0.102654, 'High': 0.103152, 'Low': 0.102543, 'Close': 0.103011, 'Volume': 2409310.0, 'close_time': 1617670000000.0, 'quote_av': 247973.0, 'trades': 705.0, 'tb_base_av': 1573980.0, 'tb_quote_av': 162040.0, 'ignore': 0.0}, {'Datetime': '2021-04-06 00:02:00', 'Open': 0.103015, 'High': 0.103436, 'Low': 0.103011, 'Close': 0.10318, 'Volume': 4836030.0, 'close_time': 1617670000000.0, 'quote_av': 499440.0, 'trades': 1263.0, 'tb_base_av': 2520360.0, 'tb_quote_av': 260323.0, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:41 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2021-04-06 00:03:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2021-04-06 00:03:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2021-04-06 00:03:00', 'Open': 0.103131, 'High': 0.103177, 'Low': 0.10286, 'Close': 0.10286, 'Volume': 1938630.0, 'close_time': 1617670000000.0, 'quote_av': 199721.0, 'trades': 565.0, 'tb_base_av': 694409.0, 'tb_quote_av': 71546.6, 'ignore': 0.0}, {'Datetime': '2021-04-06 00:04:00', 'Open': 0.102861, 'High': 0.103074, 'Low': 0.102727, 'Close': 0.102899, 'Volume': 1640410.0, 'close_time': 1617670000000.0, 'quote_av': 168865.0, 'trades': 398.0, 'tb_base_av': 1239880.0, 'tb_quote_av': 127656.0, 'ignore': 0.0}, {'Datetime': '2021-04-06 00:05:00', 'Open': 0.102899, 'High': 0.103088, 'Low': 0.10289, 'Close': 0.103053, 'Volume': 1285930.0, 'close_time': 1617670000000.0, 'quote_av': 132424.0, 'trades': 332.0, 'tb_base_av': 601591.0, 'tb_quote_av': 61948.4, 'ignore': 0.0}, {'Datetime': '2021-04-06 00:06:00', 'Open': 0.102998, 'High': 0.103, 'Low': 0.102516, 'Close': 0.102838, 'Volume': 3484960.0, 'close_time': 1617670000000.0, 'quote_av': 358116.0, 'trades': 580.0, 'tb_base_av': 1272300.0, 'tb_quote_av': 130762.0, 'ignore': 0.0}, {'Datetime': '2021-04-06 00:07:00', 'Open': 0.102865, 'High': 0.103211, 'Low': 0.102666, 'Close': 0.102845, 'Volume': 2869120.0, 'close_time': 1617670000000.0, 'quote_av': 295348.0, 'trades': 618.0, 'tb_base_av': 1614690.0, 'tb_quote_av': 166296.0, 'ignore': 0.0}, {'Datetime': '2021-04-06 00:08:00', 'Open': 0.102808, 'High': 0.102808, 'Low': 0.102532, 'Close': 0.102589, 'Volume': 945939.0, 'close_time': 1617670000000.0, 'quote_av': 97112.7, 'trades': 263.0, 'tb_base_av': 333395.0, 'tb_quote_av': 34226.8, 'ignore': 0.0}, {'Datetime': '2021-04-06 00:09:00', 'Open': 0.102577, 'High': 0.102755, 'Low': 0.102505, 'Close': 0.102644, 'Volume': 1123650.0, 'close_time': 1617670000000.0, 'quote_av': 115285.0, 'trades': 281.0, 'tb_base_av': 587289.0, 'tb_quote_av': 60279.7, 'ignore': 0.0}, {'Datetime': '2021-04-06 00:10:00', 'Open': 0.102623, 'High': 0.102623, 'Low': 0.102027, 'Close': 0.102027, 'Volume': 3260700.0, 'close_time': 1617670000000.0, 'quote_av': 333555.0, 'trades': 890.0, 'tb_base_av': 990150.0, 'tb_quote_av': 101307.0, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2021-05-10 17:21:00', 'Open': 0.219399, 'High': 0.219852, 'Low': 0.219197, 'Close': 0.219541, 'Volume': 697345.0, 'close_time': 1620670000000.0, 'quote_av': 153046.0, 'trades': 296.0, 'tb_base_av': 303110.0, 'tb_quote_av': 66541.7, 'ignore': 0.0}, {'Datetime': '2021-05-10 17:22:00', 'Open': 0.219539, 'High': 0.219787, 'Low': 0.219299, 'Close': 0.219384, 'Volume': 771438.0, 'close_time': 1620670000000.0, 'quote_av': 169372.0, 'trades': 255.0, 'tb_base_av': 442681.0, 'tb_quote_av': 97199.8, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:41 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2021-05-10 17:23:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2021-05-10 17:23:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2021-05-10 17:23:00', 'Open': 0.219373, 'High': 0.219397, 'Low': 0.218988, 'Close': 0.21904, 'Volume': 700541.0, 'close_time': 1620670000000.0, 'quote_av': 153503.0, 'trades': 261.0, 'tb_base_av': 307889.0, 'tb_quote_av': 67480.4, 'ignore': 0.0}, {'Datetime': '2021-05-10 17:24:00', 'Open': 0.219013, 'High': 0.219239, 'Low': 0.218758, 'Close': 0.219023, 'Volume': 1618050.0, 'close_time': 1620670000000.0, 'quote_av': 354346.0, 'trades': 384.0, 'tb_base_av': 900475.0, 'tb_quote_av': 197274.0, 'ignore': 0.0}, {'Datetime': '2021-05-10 17:25:00', 'Open': 0.219028, 'High': 0.219086, 'Low': 0.218238, 'Close': 0.218243, 'Volume': 1061930.0, 'close_time': 1620670000000.0, 'quote_av': 232159.0, 'trades': 481.0, 'tb_base_av': 332743.0, 'tb_quote_av': 72763.7, 'ignore': 0.0}, {'Datetime': '2021-05-10 17:26:00', 'Open': 0.218233, 'High': 0.218743, 'Low': 0.218142, 'Close': 0.218597, 'Volume': 1286080.0, 'close_time': 1620670000000.0, 'quote_av': 281007.0, 'trades': 392.0, 'tb_base_av': 744687.0, 'tb_quote_av': 162719.0, 'ignore': 0.0}, {'Datetime': '2021-05-10 17:27:00', 'Open': 0.218623, 'High': 0.218994, 'Low': 0.218392, 'Close': 0.21849, 'Volume': 944468.0, 'close_time': 1620670000000.0, 'quote_av': 206629.0, 'trades': 290.0, 'tb_base_av': 359993.0, 'tb_quote_av': 78739.2, 'ignore': 0.0}, {'Datetime': '2021-05-10 17:28:00', 'Open': 0.218435, 'High': 0.218843, 'Low': 0.218411, 'Close': 0.218511, 'Volume': 585629.0, 'close_time': 1620670000000.0, 'quote_av': 128040.0, 'trades': 176.0, 'tb_base_av': 361850.0, 'tb_quote_av': 79101.8, 'ignore': 0.0}, {'Datetime': '2021-05-10 17:29:00', 'Open': 0.21851, 'High': 0.218893, 'Low': 0.218337, 'Close': 0.218781, 'Volume': 1326730.0, 'close_time': 1620670000000.0, 'quote_av': 290072.0, 'trades': 271.0, 'tb_base_av': 495754.0, 'tb_quote_av': 108433.0, 'ignore': 0.0}, {'Datetime': '2021-05-10 17:30:00', 'Open': 0.218781, 'High': 0.21882, 'Low': 0.218479, 'Close': 0.218804, 'Volume': 972586.0, 'close_time': 1620670000000.0, 'quote_av': 212639.0, 'trades': 229.0, 'tb_base_av': 561553.0, 'tb_quote_av': 122778.0, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2021-06-14 10:41:00', 'Open': 0.11056, 'High': 0.11067, 'Low': 0.11051, 'Close': 0.11053, 'Volume': 318682.0, 'close_time': 1623670000000.0, 'quote_av': 35244.3, 'trades': 97.0, 'tb_base_av': 233344.0, 'tb_quote_av': 25809.4, 'ignore': 0.0}, {'Datetime': '2021-06-14 10:42:00', 'Open': 0.11054, 'High': 0.1106, 'Low': 0.11048, 'Close': 0.11055, 'Volume': 168712.0, 'close_time': 1623670000000.0, 'quote_av': 18650.4, 'trades': 79.0, 'tb_base_av': 97184.0, 'tb_quote_av': 10745.1, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:41 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2021-06-14 10:43:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2021-06-14 10:43:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2021-06-14 10:43:00', 'Open': 0.11056, 'High': 0.11071, 'Low': 0.11051, 'Close': 0.11064, 'Volume': 469110.0, 'close_time': 1623670000000.0, 'quote_av': 51887.2, 'trades': 163.0, 'tb_base_av': 298877.0, 'tb_quote_av': 33058.5, 'ignore': 0.0}, {'Datetime': '2021-06-14 10:44:00', 'Open': 0.11063, 'High': 0.11068, 'Low': 0.11055, 'Close': 0.11066, 'Volume': 146254.0, 'close_time': 1623670000000.0, 'quote_av': 16180.2, 'trades': 65.0, 'tb_base_av': 51430.0, 'tb_quote_av': 5689.67, 'ignore': 0.0}, {'Datetime': '2021-06-14 10:45:00', 'Open': 0.11066, 'High': 0.11085, 'Low': 0.11056, 'Close': 0.11079, 'Volume': 849732.0, 'close_time': 1623670000000.0, 'quote_av': 94061.9, 'trades': 236.0, 'tb_base_av': 456030.0, 'tb_quote_av': 50491.2, 'ignore': 0.0}, {'Datetime': '2021-06-14 10:46:00', 'Open': 0.11078, 'High': 0.11087, 'Low': 0.11075, 'Close': 0.11086, 'Volume': 216985.0, 'close_time': 1623670000000.0, 'quote_av': 24044.3, 'trades': 146.0, 'tb_base_av': 143002.0, 'tb_quote_av': 15847.1, 'ignore': 0.0}, {'Datetime': '2021-06-14 10:47:00', 'Open': 0.11083, 'High': 0.11086, 'Low': 0.11078, 'Close': 0.11085, 'Volume': 163246.0, 'close_time': 1623670000000.0, 'quote_av': 18091.6, 'trades': 94.0, 'tb_base_av': 73582.0, 'tb_quote_av': 8155.39, 'ignore': 0.0}, {'Datetime': '2021-06-14 10:48:00', 'Open': 0.11085, 'High': 0.11089, 'Low': 0.1108, 'Close': 0.11084, 'Volume': 327804.0, 'close_time': 1623670000000.0, 'quote_av': 36335.1, 'trades': 106.0, 'tb_base_av': 102805.0, 'tb_quote_av': 11396.3, 'ignore': 0.0}, {'Datetime': '2021-06-14 10:49:00', 'Open': 0.11082, 'High': 0.11085, 'Low': 0.11072, 'Close': 0.11081, 'Volume': 652771.0, 'close_time': 1623670000000.0, 'quote_av': 72306.1, 'trades': 144.0, 'tb_base_av': 314754.0, 'tb_quote_av': 34871.0, 'ignore': 0.0}, {'Datetime': '2021-06-14 10:50:00', 'Open': 0.11081, 'High': 0.11088, 'Low': 0.11075, 'Close': 0.11083, 'Volume': 407424.0, 'close_time': 1623670000000.0, 'quote_av': 45148.2, 'trades': 111.0, 'tb_base_av': 296470.0, 'tb_quote_av': 32854.1, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2021-07-19 04:01:00', 'Open': 0.06573, 'High': 0.06578, 'Low': 0.0657, 'Close': 0.06575, 'Volume': 1155670.0, 'close_time': 1626670000000.0, 'quote_av': 75995.2, 'trades': 140.0, 'tb_base_av': 1058030.0, 'tb_quote_av': 69575.0, 'ignore': 0.0}, {'Datetime': '2021-07-19 04:02:00', 'Open': 0.06577, 'High': 0.06578, 'Low': 0.06573, 'Close': 0.06574, 'Volume': 254631.0, 'close_time': 1626670000000.0, 'quote_av': 16742.5, 'trades': 92.0, 'tb_base_av': 41344.0, 'tb_quote_av': 2719.16, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:41 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2021-07-19 04:03:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2021-07-19 04:03:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2021-07-19 04:03:00', 'Open': 0.06574, 'High': 0.06578, 'Low': 0.06572, 'Close': 0.06575, 'Volume': 425054.0, 'close_time': 1626670000000.0, 'quote_av': 27950.3, 'trades': 89.0, 'tb_base_av': 236373.0, 'tb_quote_av': 15545.0, 'ignore': 0.0}, {'Datetime': '2021-07-19 04:04:00', 'Open': 0.06574, 'High': 0.06575, 'Low': 0.06564, 'Close': 0.06567, 'Volume': 348165.0, 'close_time': 1626670000000.0, 'quote_av': 22871.0, 'trades': 96.0, 'tb_base_av': 107365.0, 'tb_quote_av': 7052.32, 'ignore': 0.0}, {'Datetime': '2021-07-19 04:05:00', 'Open': 0.06567, 'High': 0.0657, 'Low': 0.06564, 'Close': 0.06568, 'Volume': 247416.0, 'close_time': 1626670000000.0, 'quote_av': 16246.6, 'trades': 87.0, 'tb_base_av': 172202.0, 'tb_quote_av': 11308.0, 'ignore': 0.0}, {'Datetime': '2021-07-19 04:06:00', 'Open': 0.06567, 'High': 0.0657, 'Low': 0.06565, 'Close': 0.06569, 'Volume': 242348.0, 'close_time': 1626670000000.0, 'quote_av': 15915.3, 'trades': 60.0, 'tb_base_av': 135984.0, 'tb_quote_av': 8931.27, 'ignore': 0.0}, {'Datetime': '2021-07-19 04:07:00', 'Open': 0.06569, 'High': 0.06573, 'Low': 0.06564, 'Close': 0.06565, 'Volume': 205198.0, 'close_time': 1626670000000.0, 'quote_av': 13480.8, 'trades': 83.0, 'tb_base_av': 33625.0, 'tb_quote_av': 2209.12, 'ignore': 0.0}, {'Datetime': '2021-07-19 04:08:00', 'Open': 0.06565, 'High': 0.06565, 'Low': 0.06546, 'Close': 0.06548, 'Volume': 597047.0, 'close_time': 1626670000000.0, 'quote_av': 39126.4, 'trades': 179.0, 'tb_base_av': 225905.0, 'tb_quote_av': 14803.8, 'ignore': 0.0}, {'Datetime': '2021-07-19 04:09:00', 'Open': 0.06547, 'High': 0.06556, 'Low': 0.06542, 'Close': 0.0655, 'Volume': 1032070.0, 'close_time': 1626670000000.0, 'quote_av': 67595.7, 'trades': 172.0, 'tb_base_av': 305269.0, 'tb_quote_av': 19995.6, 'ignore': 0.0}, {'Datetime': '2021-07-19 04:10:00', 'Open': 0.06549, 'High': 0.0656, 'Low': 0.06549, 'Close': 0.06554, 'Volume': 366054.0, 'close_time': 1626670000000.0, 'quote_av': 23993.2, 'trades': 114.0, 'tb_base_av': 120061.0, 'tb_quote_av': 7869.53, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2021-08-22 21:21:00', 'Open': 0.12466, 'High': 0.12473, 'Low': 0.12466, 'Close': 0.12472, 'Volume': 47036.0, 'close_time': 1629670000000.0, 'quote_av': 5865.4, 'trades': 50.0, 'tb_base_av': 17801.0, 'tb_quote_av': 2219.6, 'ignore': 0.0}, {'Datetime': '2021-08-22 21:22:00', 'Open': 0.12472, 'High': 0.12472, 'Low': 0.12443, 'Close': 0.12471, 'Volume': 505865.0, 'close_time': 1629670000000.0, 'quote_av': 63028.7, 'trades': 155.0, 'tb_base_av': 210570.0, 'tb_quote_av': 26239.0, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:41 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2021-08-22 21:23:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2021-08-22 21:23:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2021-08-22 21:23:00', 'Open': 0.12473, 'High': 0.12475, 'Low': 0.12432, 'Close': 0.12432, 'Volume': 462761.0, 'close_time': 1629670000000.0, 'quote_av': 57620.9, 'trades': 164.0, 'tb_base_av': 133987.0, 'tb_quote_av': 16678.8, 'ignore': 0.0}, {'Datetime': '2021-08-22 21:24:00', 'Open': 0.12433, 'High': 0.12454, 'Low': 0.12431, 'Close': 0.1244, 'Volume': 274125.0, 'close_time': 1629670000000.0, 'quote_av': 34113.7, 'trades': 106.0, 'tb_base_av': 157717.0, 'tb_quote_av': 19623.1, 'ignore': 0.0}, {'Datetime': '2021-08-22 21:25:00', 'Open': 0.12441, 'High': 0.12443, 'Low': 0.12432, 'Close': 0.12435, 'Volume': 177552.0, 'close_time': 1629670000000.0, 'quote_av': 22083.7, 'trades': 105.0, 'tb_base_av': 73720.0, 'tb_quote_av': 9170.97, 'ignore': 0.0}, {'Datetime': '2021-08-22 21:26:00', 'Open': 0.12432, 'High': 0.12433, 'Low': 0.124, 'Close': 0.12405, 'Volume': 428869.0, 'close_time': 1629670000000.0, 'quote_av': 53232.1, 'trades': 167.0, 'tb_base_av': 126326.0, 'tb_quote_av': 15682.7, 'ignore': 0.0}, {'Datetime': '2021-08-22 21:27:00', 'Open': 0.1241, 'High': 0.1241, 'Low': 0.12397, 'Close': 0.12403, 'Volume': 184998.0, 'close_time': 1629670000000.0, 'quote_av': 22949.5, 'trades': 125.0, 'tb_base_av': 95345.0, 'tb_quote_av': 11830.0, 'ignore': 0.0}, {'Datetime': '2021-08-22 21:28:00', 'Open': 0.12401, 'High': 0.12416, 'Low': 0.12398, 'Close': 0.12415, 'Volume': 391905.0, 'close_time': 1629670000000.0, 'quote_av': 48621.7, 'trades': 219.0, 'tb_base_av': 246960.0, 'tb_quote_av': 30640.1, 'ignore': 0.0}, {'Datetime': '2021-08-22 21:29:00', 'Open': 0.12416, 'High': 0.12434, 'Low': 0.12415, 'Close': 0.12432, 'Volume': 423929.0, 'close_time': 1629670000000.0, 'quote_av': 52657.8, 'trades': 111.0, 'tb_base_av': 366955.0, 'tb_quote_av': 45579.9, 'ignore': 0.0}, {'Datetime': '2021-08-22 21:30:00', 'Open': 0.1243, 'High': 0.12442, 'Low': 0.1243, 'Close': 0.12442, 'Volume': 190309.0, 'close_time': 1629670000000.0, 'quote_av': 23670.2, 'trades': 74.0, 'tb_base_av': 134335.0, 'tb_quote_av': 16709.3, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2021-09-26 14:41:00', 'Open': 0.09094, 'High': 0.09136, 'Low': 0.09094, 'Close': 0.09133, 'Volume': 776619.0, 'close_time': 1632670000000.0, 'quote_av': 70778.9, 'trades': 202.0, 'tb_base_av': 592241.0, 'tb_quote_av': 53972.3, 'ignore': 0.0}, {'Datetime': '2021-09-26 14:42:00', 'Open': 0.09137, 'High': 0.09177, 'Low': 0.09137, 'Close': 0.09147, 'Volume': 1589460.0, 'close_time': 1632670000000.0, 'quote_av': 145599.0, 'trades': 362.0, 'tb_base_av': 885239.0, 'tb_quote_av': 81069.8, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:41 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2021-09-26 14:43:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2021-09-26 14:43:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2021-09-26 14:43:00', 'Open': 0.09147, 'High': 0.09162, 'Low': 0.09136, 'Close': 0.09146, 'Volume': 893360.0, 'close_time': 1632670000000.0, 'quote_av': 81689.4, 'trades': 167.0, 'tb_base_av': 217597.0, 'tb_quote_av': 19906.4, 'ignore': 0.0}, {'Datetime': '2021-09-26 14:44:00', 'Open': 0.09145, 'High': 0.09162, 'Low': 0.0914, 'Close': 0.0915, 'Volume': 475763.0, 'close_time': 1632670000000.0, 'quote_av': 43538.0, 'trades': 129.0, 'tb_base_av': 222143.0, 'tb_quote_av': 20334.9, 'ignore': 0.0}, {'Datetime': '2021-09-26 14:45:00', 'Open': 0.09152, 'High': 0.09155, 'Low': 0.0911, 'Close': 0.0911, 'Volume': 519979.0, 'close_time': 1632670000000.0, 'quote_av': 47468.1, 'trades': 137.0, 'tb_base_av': 106197.0, 'tb_quote_av': 9693.02, 'ignore': 0.0}, {'Datetime': '2021-09-26 14:46:00', 'Open': 0.09111, 'High': 0.0912, 'Low': 0.09104, 'Close': 0.09106, 'Volume': 1169440.0, 'close_time': 1632670000000.0, 'quote_av': 106560.0, 'trades': 206.0, 'tb_base_av': 640353.0, 'tb_quote_av': 58354.2, 'ignore': 0.0}, {'Datetime': '2021-09-26 14:47:00', 'Open': 0.09109, 'High': 0.09125, 'Low': 0.09105, 'Close': 0.09107, 'Volume': 591012.0, 'close_time': 1632670000000.0, 'quote_av': 53859.4, 'trades': 150.0, 'tb_base_av': 344732.0, 'tb_quote_av': 31416.2, 'ignore': 0.0}, {'Datetime': '2021-09-26 14:48:00', 'Open': 0.09106, 'High': 0.09131, 'Low': 0.09101, 'Close': 0.09128, 'Volume': 1094720.0, 'close_time': 1632670000000.0, 'quote_av': 99801.7, 'trades': 207.0, 'tb_base_av': 465311.0, 'tb_quote_av': 42409.6, 'ignore': 0.0}, {'Datetime': '2021-09-26 14:49:00', 'Open': 0.09127, 'High': 0.09136, 'Low': 0.09117, 'Close': 0.09121, 'Volume': 694531.0, 'close_time': 1632670000000.0, 'quote_av': 63407.8, 'trades': 123.0, 'tb_base_av': 320112.0, 'tb_quote_av': 29230.8, 'ignore': 0.0}, {'Datetime': '2021-09-26 14:50:00', 'Open': 0.0912, 'High': 0.09155, 'Low': 0.09119, 'Close': 0.09155, 'Volume': 505414.0, 'close_time': 1632670000000.0, 'quote_av': 46204.5, 'trades': 120.0, 'tb_base_av': 397611.0, 'tb_quote_av': 36355.3, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2021-10-31 08:01:00', 'Open': 0.13247, 'High': 0.13258, 'Low': 0.13217, 'Close': 0.13225, 'Volume': 1455490.0, 'close_time': 1635670000000.0, 'quote_av': 192686.0, 'trades': 598.0, 'tb_base_av': 430955.0, 'tb_quote_av': 57068.8, 'ignore': 0.0}, {'Datetime': '2021-10-31 08:02:00', 'Open': 0.13224, 'High': 0.13225, 'Low': 0.13184, 'Close': 0.13196, 'Volume': 2081570.0, 'close_time': 1635670000000.0, 'quote_av': 274752.0, 'trades': 649.0, 'tb_base_av': 676325.0, 'tb_quote_av': 89255.4, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:42 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1050, "Table 'vetusdt-f' already exists")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 35, in change_db_data
    conn.execute(text(text_msg))
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1050, "Table 'vetusdt-f' already exists")
[SQL: CREATE TABLE `crypto_data`.`vetusdt-f`(
                `Datetime` DATETIME NOT NULL,
                `Open` FLOAT NOT NULL,
                `High` FLOAT NOT NULL,
                `Low` FLOAT NOT NULL,
                `Close` FLOAT NOT NULL,
                `Volume` FLOAT NOT NULL,
                `close_time` FLOAT NOT NULL,
                `quote_av` FLOAT NOT NULL,
                `trades` FLOAT NOT NULL,
                `tb_base_av` FLOAT NOT NULL,
                `tb_quote_av` FLOAT NOT NULL,
                `ignore` FLOAT NOT NULL,
                PRIMARY KEY(`Datetime`)
                );]
(Background on this error at: https://sqlalche.me/e/20/e3q8)

2025-02-19 14:42 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2020-02-14 08:03:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2020-02-14 08:03:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2020-02-14 08:03:00', 'Open': 0.007731, 'High': 0.007731, 'Low': 0.007689, 'Close': 0.007689, 'Volume': 70074.0, 'close_time': 1581670000000.0, 'quote_av': 540.701, 'trades': 5.0, 'tb_base_av': 50064.0, 'tb_quote_av': 386.244, 'ignore': 0.0}, {'Datetime': '2020-02-14 08:04:00', 'Open': 0.007689, 'High': 0.007729, 'Low': 0.007685, 'Close': 0.007729, 'Volume': 838629.0, 'close_time': 1581670000000.0, 'quote_av': 6464.46, 'trades': 41.0, 'tb_base_av': 663954.0, 'tb_quote_av': 5121.04, 'ignore': 0.0}, {'Datetime': '2020-02-14 08:05:00', 'Open': 0.007729, 'High': 0.007736, 'Low': 0.007683, 'Close': 0.007724, 'Volume': 602488.0, 'close_time': 1581670000000.0, 'quote_av': 4653.36, 'trades': 69.0, 'tb_base_av': 499488.0, 'tb_quote_av': 3860.27, 'ignore': 0.0}, {'Datetime': '2020-02-14 08:06:00', 'Open': 0.007724, 'High': 0.007749, 'Low': 0.007701, 'Close': 0.007747, 'Volume': 376875.0, 'close_time': 1581670000000.0, 'quote_av': 2908.07, 'trades': 95.0, 'tb_base_av': 144352.0, 'tb_quote_av': 1115.35, 'ignore': 0.0}, {'Datetime': '2020-02-14 08:07:00', 'Open': 0.007747, 'High': 0.007748, 'Low': 0.007746, 'Close': 0.007748, 'Volume': 350974.0, 'close_time': 1581670000000.0, 'quote_av': 2718.67, 'trades': 116.0, 'tb_base_av': 16623.0, 'tb_quote_av': 128.786, 'ignore': 0.0}, {'Datetime': '2020-02-14 08:08:00', 'Open': 0.007748, 'High': 0.007749, 'Low': 0.007719, 'Close': 0.007725, 'Volume': 783338.0, 'close_time': 1581670000000.0, 'quote_av': 6067.9, 'trades': 122.0, 'tb_base_av': 114663.0, 'tb_quote_av': 888.42, 'ignore': 0.0}, {'Datetime': '2020-02-14 08:09:00', 'Open': 0.007725, 'High': 0.007725, 'Low': 0.007709, 'Close': 0.007713, 'Volume': 236534.0, 'close_time': 1581670000000.0, 'quote_av': 1825.12, 'trades': 99.0, 'tb_base_av': 164467.0, 'tb_quote_av': 1269.09, 'ignore': 0.0}, {'Datetime': '2020-02-14 08:10:00', 'Open': 0.007714, 'High': 0.007725, 'Low': 0.007714, 'Close': 0.007716, 'Volume': 107248.0, 'close_time': 1581670000000.0, 'quote_av': 827.355, 'trades': 27.0, 'tb_base_av': 104349.0, 'tb_quote_av': 804.989, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2020-03-20 01:21:00', 'Open': 0.002916, 'High': 0.002916, 'Low': 0.002916, 'Close': 0.002916, 'Volume': 17925.0, 'close_time': 1584670000000.0, 'quote_av': 52.2693, 'trades': 2.0, 'tb_base_av': 17925.0, 'tb_quote_av': 52.2693, 'ignore': 0.0}, {'Datetime': '2020-03-20 01:22:00', 'Open': 0.002916, 'High': 0.002916, 'Low': 0.002911, 'Close': 0.002911, 'Volume': 33823.0, 'close_time': 1584670000000.0, 'quote_av': 98.5563, 'trades': 4.0, 'tb_base_av': 31778.0, 'tb_quote_av': 92.6013, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:42 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2020-03-20 01:23:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2020-03-20 01:23:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2020-03-20 01:23:00', 'Open': 0.002908, 'High': 0.002911, 'Low': 0.002908, 'Close': 0.002911, 'Volume': 45012.0, 'close_time': 1584670000000.0, 'quote_av': 131.017, 'trades': 10.0, 'tb_base_av': 40664.0, 'tb_quote_av': 118.373, 'ignore': 0.0}, {'Datetime': '2020-03-20 01:24:00', 'Open': 0.002909, 'High': 0.002909, 'Low': 0.002909, 'Close': 0.002909, 'Volume': 21338.0, 'close_time': 1584670000000.0, 'quote_av': 62.0722, 'trades': 2.0, 'tb_base_av': 0.0, 'tb_quote_av': 0.0, 'ignore': 0.0}, {'Datetime': '2020-03-20 01:25:00', 'Open': 0.002908, 'High': 0.002908, 'Low': 0.002904, 'Close': 0.002904, 'Volume': 35182.0, 'close_time': 1584670000000.0, 'quote_av': 102.247, 'trades': 4.0, 'tb_base_av': 7704.0, 'tb_quote_av': 22.4032, 'ignore': 0.0}, {'Datetime': '2020-03-20 01:26:00', 'Open': 0.002907, 'High': 0.002907, 'Low': 0.002907, 'Close': 0.002907, 'Volume': 13909.0, 'close_time': 1584670000000.0, 'quote_av': 40.4335, 'trades': 7.0, 'tb_base_av': 13909.0, 'tb_quote_av': 40.4335, 'ignore': 0.0}, {'Datetime': '2020-03-20 01:27:00', 'Open': 0.002907, 'High': 0.00291, 'Low': 0.002907, 'Close': 0.00291, 'Volume': 45013.0, 'close_time': 1584670000000.0, 'quote_av': 130.931, 'trades': 8.0, 'tb_base_av': 43351.0, 'tb_quote_av': 126.1, 'ignore': 0.0}, {'Datetime': '2020-03-20 01:28:00', 'Open': 0.002907, 'High': 0.002909, 'Low': 0.0029, 'Close': 0.0029, 'Volume': 128246.0, 'close_time': 1584670000000.0, 'quote_av': 372.182, 'trades': 7.0, 'tb_base_av': 12060.0, 'tb_quote_av': 35.0825, 'ignore': 0.0}, {'Datetime': '2020-03-20 01:29:00', 'Open': 0.002897, 'High': 0.002897, 'Low': 0.00288, 'Close': 0.00288, 'Volume': 678332.0, 'close_time': 1584670000000.0, 'quote_av': 1959.32, 'trades': 28.0, 'tb_base_av': 118801.0, 'tb_quote_av': 343.278, 'ignore': 0.0}, {'Datetime': '2020-03-20 01:30:00', 'Open': 0.002879, 'High': 0.002879, 'Low': 0.002851, 'Close': 0.002851, 'Volume': 1042260.0, 'close_time': 1584670000000.0, 'quote_av': 2988.47, 'trades': 45.0, 'tb_base_av': 305716.0, 'tb_quote_av': 879.231, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2020-04-23 18:41:00', 'Open': 0.00403, 'High': 0.004035, 'Low': 0.00403, 'Close': 0.004032, 'Volume': 529748.0, 'close_time': 1587670000000.0, 'quote_av': 2135.69, 'trades': 15.0, 'tb_base_av': 523431.0, 'tb_quote_av': 2110.22, 'ignore': 0.0}, {'Datetime': '2020-04-23 18:42:00', 'Open': 0.004032, 'High': 0.004032, 'Low': 0.004032, 'Close': 0.004032, 'Volume': 0.0, 'close_time': 1587670000000.0, 'quote_av': 0.0, 'trades': 0.0, 'tb_base_av': 0.0, 'tb_quote_av': 0.0, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:42 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2020-04-23 18:43:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2020-04-23 18:43:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2020-04-23 18:43:00', 'Open': 0.004032, 'High': 0.004032, 'Low': 0.004032, 'Close': 0.004032, 'Volume': 0.0, 'close_time': 1587670000000.0, 'quote_av': 0.0, 'trades': 0.0, 'tb_base_av': 0.0, 'tb_quote_av': 0.0, 'ignore': 0.0}, {'Datetime': '2020-04-23 18:44:00', 'Open': 0.004034, 'High': 0.004034, 'Low': 0.004034, 'Close': 0.004034, 'Volume': 2804.0, 'close_time': 1587670000000.0, 'quote_av': 11.3113, 'trades': 2.0, 'tb_base_av': 2804.0, 'tb_quote_av': 11.3113, 'ignore': 0.0}, {'Datetime': '2020-04-23 18:45:00', 'Open': 0.004034, 'High': 0.004035, 'Low': 0.004034, 'Close': 0.004035, 'Volume': 79490.0, 'close_time': 1587670000000.0, 'quote_av': 320.71, 'trades': 5.0, 'tb_base_av': 79490.0, 'tb_quote_av': 320.71, 'ignore': 0.0}, {'Datetime': '2020-04-23 18:46:00', 'Open': 0.004034, 'High': 0.004036, 'Low': 0.004033, 'Close': 0.004033, 'Volume': 168313.0, 'close_time': 1587670000000.0, 'quote_av': 679.04, 'trades': 6.0, 'tb_base_av': 68313.0, 'tb_quote_av': 275.649, 'ignore': 0.0}, {'Datetime': '2020-04-23 18:47:00', 'Open': 0.004036, 'High': 0.004036, 'Low': 0.004036, 'Close': 0.004036, 'Volume': 41040.0, 'close_time': 1587670000000.0, 'quote_av': 165.637, 'trades': 2.0, 'tb_base_av': 41040.0, 'tb_quote_av': 165.637, 'ignore': 0.0}, {'Datetime': '2020-04-23 18:48:00', 'Open': 0.004036, 'High': 0.004037, 'Low': 0.004036, 'Close': 0.004037, 'Volume': 442303.0, 'close_time': 1587670000000.0, 'quote_av': 1785.5, 'trades': 6.0, 'tb_base_av': 380907.0, 'tb_quote_av': 1537.7, 'ignore': 0.0}, {'Datetime': '2020-04-23 18:49:00', 'Open': 0.004036, 'High': 0.004036, 'Low': 0.004036, 'Close': 0.004036, 'Volume': 59984.0, 'close_time': 1587670000000.0, 'quote_av': 242.095, 'trades': 4.0, 'tb_base_av': 59984.0, 'tb_quote_av': 242.095, 'ignore': 0.0}, {'Datetime': '2020-04-23 18:50:00', 'Open': 0.004037, 'High': 0.004038, 'Low': 0.004037, 'Close': 0.004038, 'Volume': 70045.0, 'close_time': 1587670000000.0, 'quote_av': 282.842, 'trades': 4.0, 'tb_base_av': 70045.0, 'tb_quote_av': 282.842, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2020-05-28 12:01:00', 'Open': 0.005302, 'High': 0.005306, 'Low': 0.005296, 'Close': 0.005301, 'Volume': 1705550.0, 'close_time': 1590670000000.0, 'quote_av': 9039.9, 'trades': 53.0, 'tb_base_av': 277856.0, 'tb_quote_av': 1473.27, 'ignore': 0.0}, {'Datetime': '2020-05-28 12:02:00', 'Open': 0.005301, 'High': 0.005308, 'Low': 0.005294, 'Close': 0.005307, 'Volume': 2461100.0, 'close_time': 1590670000000.0, 'quote_av': 13045.1, 'trades': 101.0, 'tb_base_av': 1446980.0, 'tb_quote_av': 7667.62, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:42 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2020-05-28 12:03:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2020-05-28 12:03:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2020-05-28 12:03:00', 'Open': 0.005308, 'High': 0.005313, 'Low': 0.005305, 'Close': 0.005308, 'Volume': 1973770.0, 'close_time': 1590670000000.0, 'quote_av': 10476.2, 'trades': 50.0, 'tb_base_av': 576164.0, 'tb_quote_av': 3059.02, 'ignore': 0.0}, {'Datetime': '2020-05-28 12:04:00', 'Open': 0.005307, 'High': 0.005307, 'Low': 0.0053, 'Close': 0.005303, 'Volume': 427924.0, 'close_time': 1590670000000.0, 'quote_av': 2269.7, 'trades': 23.0, 'tb_base_av': 23629.0, 'tb_quote_av': 125.309, 'ignore': 0.0}, {'Datetime': '2020-05-28 12:05:00', 'Open': 0.005303, 'High': 0.005308, 'Low': 0.005303, 'Close': 0.005306, 'Volume': 633151.0, 'close_time': 1590670000000.0, 'quote_av': 3359.28, 'trades': 29.0, 'tb_base_av': 522626.0, 'tb_quote_av': 2773.01, 'ignore': 0.0}, {'Datetime': '2020-05-28 12:06:00', 'Open': 0.005307, 'High': 0.005308, 'Low': 0.005299, 'Close': 0.005302, 'Volume': 1814480.0, 'close_time': 1590670000000.0, 'quote_av': 9620.75, 'trades': 64.0, 'tb_base_av': 795132.0, 'tb_quote_av': 4216.63, 'ignore': 0.0}, {'Datetime': '2020-05-28 12:07:00', 'Open': 0.005302, 'High': 0.005313, 'Low': 0.005298, 'Close': 0.005313, 'Volume': 1571550.0, 'close_time': 1590670000000.0, 'quote_av': 8342.64, 'trades': 65.0, 'tb_base_av': 1138180.0, 'tb_quote_av': 6043.41, 'ignore': 0.0}, {'Datetime': '2020-05-28 12:08:00', 'Open': 0.005317, 'High': 0.005328, 'Low': 0.005226, 'Close': 0.00526, 'Volume': 41764200.0, 'close_time': 1590670000000.0, 'quote_av': 220192.0, 'trades': 1096.0, 'tb_base_av': 14064200.0, 'tb_quote_av': 74083.1, 'ignore': 0.0}, {'Datetime': '2020-05-28 12:09:00', 'Open': 0.005262, 'High': 0.005285, 'Low': 0.00526, 'Close': 0.005277, 'Volume': 5281950.0, 'close_time': 1590670000000.0, 'quote_av': 27864.9, 'trades': 257.0, 'tb_base_av': 3856700.0, 'tb_quote_av': 20347.0, 'ignore': 0.0}, {'Datetime': '2020-05-28 12:10:00', 'Open': 0.005278, 'High': 0.005284, 'Low': 0.005277, 'Close': 0.005282, 'Volume': 3960950.0, 'close_time': 1590670000000.0, 'quote_av': 20917.5, 'trades': 82.0, 'tb_base_av': 2652380.0, 'tb_quote_av': 14009.4, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2020-07-02 05:21:00', 'Open': 0.009375, 'High': 0.00938, 'Low': 0.009373, 'Close': 0.009374, 'Volume': 527408.0, 'close_time': 1593670000000.0, 'quote_av': 4945.07, 'trades': 24.0, 'tb_base_av': 314816.0, 'tb_quote_av': 2952.22, 'ignore': 0.0}, {'Datetime': '2020-07-02 05:22:00', 'Open': 0.009374, 'High': 0.009374, 'Low': 0.009349, 'Close': 0.009353, 'Volume': 1565400.0, 'close_time': 1593670000000.0, 'quote_av': 14658.2, 'trades': 152.0, 'tb_base_av': 288792.0, 'tb_quote_av': 2704.33, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:42 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1821, in _execute_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2358, in _handle_dbapi_exception
    raise exc_info[1].with_traceback(exc_info[2])
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1815, in _execute_context
    context = constructor(
              ^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 1509, in _init_compiled
    key: (
KeyboardInterrupt

2025-02-19 14:42 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2020-08-05 22:43:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2020-08-05 22:43:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2020-08-05 22:43:00', 'Open': 0.018669, 'High': 0.018715, 'Low': 0.018649, 'Close': 0.018702, 'Volume': 2195660.0, 'close_time': 1596670000000.0, 'quote_av': 41039.7, 'trades': 96.0, 'tb_base_av': 1175340.0, 'tb_quote_av': 21967.6, 'ignore': 0.0}, {'Datetime': '2020-08-05 22:44:00', 'Open': 0.018712, 'High': 0.018716, 'Low': 0.018682, 'Close': 0.018682, 'Volume': 1485140.0, 'close_time': 1596670000000.0, 'quote_av': 27778.8, 'trades': 65.0, 'tb_base_av': 272016.0, 'tb_quote_av': 5087.78, 'ignore': 0.0}, {'Datetime': '2020-08-05 22:45:00', 'Open': 0.018703, 'High': 0.01874, 'Low': 0.018699, 'Close': 0.01871, 'Volume': 2683050.0, 'close_time': 1596670000000.0, 'quote_av': 50225.2, 'trades': 281.0, 'tb_base_av': 1604620.0, 'tb_quote_av': 30040.8, 'ignore': 0.0}, {'Datetime': '2020-08-05 22:46:00', 'Open': 0.018711, 'High': 0.018754, 'Low': 0.01871, 'Close': 0.018741, 'Volume': 1411200.0, 'close_time': 1596670000000.0, 'quote_av': 26442.6, 'trades': 234.0, 'tb_base_av': 777423.0, 'tb_quote_av': 14571.5, 'ignore': 0.0}, {'Datetime': '2020-08-05 22:47:00', 'Open': 0.01874, 'High': 0.018778, 'Low': 0.01874, 'Close': 0.018762, 'Volume': 1298840.0, 'close_time': 1596670000000.0, 'quote_av': 24369.3, 'trades': 131.0, 'tb_base_av': 831154.0, 'tb_quote_av': 15592.5, 'ignore': 0.0}, {'Datetime': '2020-08-05 22:48:00', 'Open': 0.018768, 'High': 0.018782, 'Low': 0.018761, 'Close': 0.018782, 'Volume': 399794.0, 'close_time': 1596670000000.0, 'quote_av': 7504.64, 'trades': 39.0, 'tb_base_av': 201483.0, 'tb_quote_av': 3783.49, 'ignore': 0.0}, {'Datetime': '2020-08-05 22:49:00', 'Open': 0.018778, 'High': 0.018786, 'Low': 0.018762, 'Close': 0.018771, 'Volume': 230185.0, 'close_time': 1596670000000.0, 'quote_av': 4321.25, 'trades': 18.0, 'tb_base_av': 163224.0, 'tb_quote_av': 3064.84, 'ignore': 0.0}, {'Datetime': '2020-08-05 22:50:00', 'Open': 0.018769, 'High': 0.018786, 'Low': 0.01876, 'Close': 0.01877, 'Volume': 633506.0, 'close_time': 1596670000000.0, 'quote_av': 11888.6, 'trades': 30.0, 'tb_base_av': 277051.0, 'tb_quote_av': 5199.58, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2020-09-09 16:01:00', 'Open': 0.012951, 'High': 0.012975, 'Low': 0.012941, 'Close': 0.012961, 'Volume': 1236670.0, 'close_time': 1599670000000.0, 'quote_av': 16026.5, 'trades': 210.0, 'tb_base_av': 664681.0, 'tb_quote_av': 8617.83, 'ignore': 0.0}, {'Datetime': '2020-09-09 16:02:00', 'Open': 0.012958, 'High': 0.012975, 'Low': 0.012938, 'Close': 0.012975, 'Volume': 1390940.0, 'close_time': 1599670000000.0, 'quote_av': 18030.2, 'trades': 111.0, 'tb_base_av': 969870.0, 'tb_quote_av': 12574.7, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:42 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1097, in insert
    keys, data_list = self.insert_data()
                      ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1047, in insert_data
    for i, (_, ser) in enumerate(temp.items()):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/frame.py", line 1500, in items
    yield k, self._get_item_cache(k)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/frame.py", line 4639, in _get_item_cache
    res = self._ixs(loc, axis=1)
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/frame.py", line 4010, in _ixs
    col_mgr = self._mgr.iget(i)
              ^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/internals/managers.py", line 1021, in iget
    nb = type(block)(
         ^^^^^^^^^^^^
KeyboardInterrupt

2025-02-19 14:42 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1821, in _execute_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2358, in _handle_dbapi_exception
    raise exc_info[1].with_traceback(exc_info[2])
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1815, in _execute_context
    context = constructor(
              ^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 1397, in _init_compiled
    compiled.construct_params(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/compiler.py", line 1881, in construct_params
    pd[escaped_name] = params[bindparam.key]
    ~~^^^^^^^^^^^^^^
KeyboardInterrupt

2025-02-19 14:42 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1821, in _execute_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2358, in _handle_dbapi_exception
    raise exc_info[1].with_traceback(exc_info[2])
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1815, in _execute_context
    context = constructor(
              ^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 1397, in _init_compiled
    compiled.construct_params(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/compiler.py", line 1881, in construct_params
    pd[escaped_name] = params[bindparam.key]
    ~~^^^^^^^^^^^^^^
KeyboardInterrupt

2025-02-19 14:42 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1821, in _execute_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2358, in _handle_dbapi_exception
    raise exc_info[1].with_traceback(exc_info[2])
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1815, in _execute_context
    context = constructor(
              ^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 1397, in _init_compiled
    compiled.construct_params(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/compiler.py", line 1881, in construct_params
    pd[escaped_name] = params[bindparam.key]
    ~~^^^^^^^^^^^^^^
KeyboardInterrupt

2025-02-19 14:42 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1821, in _execute_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2358, in _handle_dbapi_exception
    raise exc_info[1].with_traceback(exc_info[2])
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1815, in _execute_context
    context = constructor(
              ^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 1397, in _init_compiled
    compiled.construct_params(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/compiler.py", line 1881, in construct_params
    pd[escaped_name] = params[bindparam.key]
    ~~^^^^^^^^^^^^^^
KeyboardInterrupt

2025-02-19 14:42 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1821, in _execute_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2358, in _handle_dbapi_exception
    raise exc_info[1].with_traceback(exc_info[2])
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1815, in _execute_context
    context = constructor(
              ^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 1397, in _init_compiled
    compiled.construct_params(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/compiler.py", line 1881, in construct_params
    pd[escaped_name] = params[bindparam.key]
    ~~^^^^^^^^^^^^^^
KeyboardInterrupt

2025-02-19 14:42 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2021-04-06 00:03:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2021-04-06 00:03:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2021-04-06 00:03:00', 'Open': 0.103131, 'High': 0.103177, 'Low': 0.10286, 'Close': 0.10286, 'Volume': 1938630.0, 'close_time': 1617670000000.0, 'quote_av': 199721.0, 'trades': 565.0, 'tb_base_av': 694409.0, 'tb_quote_av': 71546.6, 'ignore': 0.0}, {'Datetime': '2021-04-06 00:04:00', 'Open': 0.102861, 'High': 0.103074, 'Low': 0.102727, 'Close': 0.102899, 'Volume': 1640410.0, 'close_time': 1617670000000.0, 'quote_av': 168865.0, 'trades': 398.0, 'tb_base_av': 1239880.0, 'tb_quote_av': 127656.0, 'ignore': 0.0}, {'Datetime': '2021-04-06 00:05:00', 'Open': 0.102899, 'High': 0.103088, 'Low': 0.10289, 'Close': 0.103053, 'Volume': 1285930.0, 'close_time': 1617670000000.0, 'quote_av': 132424.0, 'trades': 332.0, 'tb_base_av': 601591.0, 'tb_quote_av': 61948.4, 'ignore': 0.0}, {'Datetime': '2021-04-06 00:06:00', 'Open': 0.102998, 'High': 0.103, 'Low': 0.102516, 'Close': 0.102838, 'Volume': 3484960.0, 'close_time': 1617670000000.0, 'quote_av': 358116.0, 'trades': 580.0, 'tb_base_av': 1272300.0, 'tb_quote_av': 130762.0, 'ignore': 0.0}, {'Datetime': '2021-04-06 00:07:00', 'Open': 0.102865, 'High': 0.103211, 'Low': 0.102666, 'Close': 0.102845, 'Volume': 2869120.0, 'close_time': 1617670000000.0, 'quote_av': 295348.0, 'trades': 618.0, 'tb_base_av': 1614690.0, 'tb_quote_av': 166296.0, 'ignore': 0.0}, {'Datetime': '2021-04-06 00:08:00', 'Open': 0.102808, 'High': 0.102808, 'Low': 0.102532, 'Close': 0.102589, 'Volume': 945939.0, 'close_time': 1617670000000.0, 'quote_av': 97112.7, 'trades': 263.0, 'tb_base_av': 333395.0, 'tb_quote_av': 34226.8, 'ignore': 0.0}, {'Datetime': '2021-04-06 00:09:00', 'Open': 0.102577, 'High': 0.102755, 'Low': 0.102505, 'Close': 0.102644, 'Volume': 1123650.0, 'close_time': 1617670000000.0, 'quote_av': 115285.0, 'trades': 281.0, 'tb_base_av': 587289.0, 'tb_quote_av': 60279.7, 'ignore': 0.0}, {'Datetime': '2021-04-06 00:10:00', 'Open': 0.102623, 'High': 0.102623, 'Low': 0.102027, 'Close': 0.102027, 'Volume': 3260700.0, 'close_time': 1617670000000.0, 'quote_av': 333555.0, 'trades': 890.0, 'tb_base_av': 990150.0, 'tb_quote_av': 101307.0, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2021-05-10 17:21:00', 'Open': 0.219399, 'High': 0.219852, 'Low': 0.219197, 'Close': 0.219541, 'Volume': 697345.0, 'close_time': 1620670000000.0, 'quote_av': 153046.0, 'trades': 296.0, 'tb_base_av': 303110.0, 'tb_quote_av': 66541.7, 'ignore': 0.0}, {'Datetime': '2021-05-10 17:22:00', 'Open': 0.219539, 'High': 0.219787, 'Low': 0.219299, 'Close': 0.219384, 'Volume': 771438.0, 'close_time': 1620670000000.0, 'quote_av': 169372.0, 'trades': 255.0, 'tb_base_av': 442681.0, 'tb_quote_av': 97199.8, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:42 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2021-05-10 17:23:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2021-05-10 17:23:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2021-05-10 17:23:00', 'Open': 0.219373, 'High': 0.219397, 'Low': 0.218988, 'Close': 0.21904, 'Volume': 700541.0, 'close_time': 1620670000000.0, 'quote_av': 153503.0, 'trades': 261.0, 'tb_base_av': 307889.0, 'tb_quote_av': 67480.4, 'ignore': 0.0}, {'Datetime': '2021-05-10 17:24:00', 'Open': 0.219013, 'High': 0.219239, 'Low': 0.218758, 'Close': 0.219023, 'Volume': 1618050.0, 'close_time': 1620670000000.0, 'quote_av': 354346.0, 'trades': 384.0, 'tb_base_av': 900475.0, 'tb_quote_av': 197274.0, 'ignore': 0.0}, {'Datetime': '2021-05-10 17:25:00', 'Open': 0.219028, 'High': 0.219086, 'Low': 0.218238, 'Close': 0.218243, 'Volume': 1061930.0, 'close_time': 1620670000000.0, 'quote_av': 232159.0, 'trades': 481.0, 'tb_base_av': 332743.0, 'tb_quote_av': 72763.7, 'ignore': 0.0}, {'Datetime': '2021-05-10 17:26:00', 'Open': 0.218233, 'High': 0.218743, 'Low': 0.218142, 'Close': 0.218597, 'Volume': 1286080.0, 'close_time': 1620670000000.0, 'quote_av': 281007.0, 'trades': 392.0, 'tb_base_av': 744687.0, 'tb_quote_av': 162719.0, 'ignore': 0.0}, {'Datetime': '2021-05-10 17:27:00', 'Open': 0.218623, 'High': 0.218994, 'Low': 0.218392, 'Close': 0.21849, 'Volume': 944468.0, 'close_time': 1620670000000.0, 'quote_av': 206629.0, 'trades': 290.0, 'tb_base_av': 359993.0, 'tb_quote_av': 78739.2, 'ignore': 0.0}, {'Datetime': '2021-05-10 17:28:00', 'Open': 0.218435, 'High': 0.218843, 'Low': 0.218411, 'Close': 0.218511, 'Volume': 585629.0, 'close_time': 1620670000000.0, 'quote_av': 128040.0, 'trades': 176.0, 'tb_base_av': 361850.0, 'tb_quote_av': 79101.8, 'ignore': 0.0}, {'Datetime': '2021-05-10 17:29:00', 'Open': 0.21851, 'High': 0.218893, 'Low': 0.218337, 'Close': 0.218781, 'Volume': 1326730.0, 'close_time': 1620670000000.0, 'quote_av': 290072.0, 'trades': 271.0, 'tb_base_av': 495754.0, 'tb_quote_av': 108433.0, 'ignore': 0.0}, {'Datetime': '2021-05-10 17:30:00', 'Open': 0.218781, 'High': 0.21882, 'Low': 0.218479, 'Close': 0.218804, 'Volume': 972586.0, 'close_time': 1620670000000.0, 'quote_av': 212639.0, 'trades': 229.0, 'tb_base_av': 561553.0, 'tb_quote_av': 122778.0, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2021-06-14 10:41:00', 'Open': 0.11056, 'High': 0.11067, 'Low': 0.11051, 'Close': 0.11053, 'Volume': 318682.0, 'close_time': 1623670000000.0, 'quote_av': 35244.3, 'trades': 97.0, 'tb_base_av': 233344.0, 'tb_quote_av': 25809.4, 'ignore': 0.0}, {'Datetime': '2021-06-14 10:42:00', 'Open': 0.11054, 'High': 0.1106, 'Low': 0.11048, 'Close': 0.11055, 'Volume': 168712.0, 'close_time': 1623670000000.0, 'quote_av': 18650.4, 'trades': 79.0, 'tb_base_av': 97184.0, 'tb_quote_av': 10745.1, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:42 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2021-06-14 10:43:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2021-06-14 10:43:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2021-06-14 10:43:00', 'Open': 0.11056, 'High': 0.11071, 'Low': 0.11051, 'Close': 0.11064, 'Volume': 469110.0, 'close_time': 1623670000000.0, 'quote_av': 51887.2, 'trades': 163.0, 'tb_base_av': 298877.0, 'tb_quote_av': 33058.5, 'ignore': 0.0}, {'Datetime': '2021-06-14 10:44:00', 'Open': 0.11063, 'High': 0.11068, 'Low': 0.11055, 'Close': 0.11066, 'Volume': 146254.0, 'close_time': 1623670000000.0, 'quote_av': 16180.2, 'trades': 65.0, 'tb_base_av': 51430.0, 'tb_quote_av': 5689.67, 'ignore': 0.0}, {'Datetime': '2021-06-14 10:45:00', 'Open': 0.11066, 'High': 0.11085, 'Low': 0.11056, 'Close': 0.11079, 'Volume': 849732.0, 'close_time': 1623670000000.0, 'quote_av': 94061.9, 'trades': 236.0, 'tb_base_av': 456030.0, 'tb_quote_av': 50491.2, 'ignore': 0.0}, {'Datetime': '2021-06-14 10:46:00', 'Open': 0.11078, 'High': 0.11087, 'Low': 0.11075, 'Close': 0.11086, 'Volume': 216985.0, 'close_time': 1623670000000.0, 'quote_av': 24044.3, 'trades': 146.0, 'tb_base_av': 143002.0, 'tb_quote_av': 15847.1, 'ignore': 0.0}, {'Datetime': '2021-06-14 10:47:00', 'Open': 0.11083, 'High': 0.11086, 'Low': 0.11078, 'Close': 0.11085, 'Volume': 163246.0, 'close_time': 1623670000000.0, 'quote_av': 18091.6, 'trades': 94.0, 'tb_base_av': 73582.0, 'tb_quote_av': 8155.39, 'ignore': 0.0}, {'Datetime': '2021-06-14 10:48:00', 'Open': 0.11085, 'High': 0.11089, 'Low': 0.1108, 'Close': 0.11084, 'Volume': 327804.0, 'close_time': 1623670000000.0, 'quote_av': 36335.1, 'trades': 106.0, 'tb_base_av': 102805.0, 'tb_quote_av': 11396.3, 'ignore': 0.0}, {'Datetime': '2021-06-14 10:49:00', 'Open': 0.11082, 'High': 0.11085, 'Low': 0.11072, 'Close': 0.11081, 'Volume': 652771.0, 'close_time': 1623670000000.0, 'quote_av': 72306.1, 'trades': 144.0, 'tb_base_av': 314754.0, 'tb_quote_av': 34871.0, 'ignore': 0.0}, {'Datetime': '2021-06-14 10:50:00', 'Open': 0.11081, 'High': 0.11088, 'Low': 0.11075, 'Close': 0.11083, 'Volume': 407424.0, 'close_time': 1623670000000.0, 'quote_av': 45148.2, 'trades': 111.0, 'tb_base_av': 296470.0, 'tb_quote_av': 32854.1, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2021-07-19 04:01:00', 'Open': 0.06573, 'High': 0.06578, 'Low': 0.0657, 'Close': 0.06575, 'Volume': 1155670.0, 'close_time': 1626670000000.0, 'quote_av': 75995.2, 'trades': 140.0, 'tb_base_av': 1058030.0, 'tb_quote_av': 69575.0, 'ignore': 0.0}, {'Datetime': '2021-07-19 04:02:00', 'Open': 0.06577, 'High': 0.06578, 'Low': 0.06573, 'Close': 0.06574, 'Volume': 254631.0, 'close_time': 1626670000000.0, 'quote_av': 16742.5, 'trades': 92.0, 'tb_base_av': 41344.0, 'tb_quote_av': 2719.16, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:42 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2021-07-19 04:03:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2021-07-19 04:03:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2021-07-19 04:03:00', 'Open': 0.06574, 'High': 0.06578, 'Low': 0.06572, 'Close': 0.06575, 'Volume': 425054.0, 'close_time': 1626670000000.0, 'quote_av': 27950.3, 'trades': 89.0, 'tb_base_av': 236373.0, 'tb_quote_av': 15545.0, 'ignore': 0.0}, {'Datetime': '2021-07-19 04:04:00', 'Open': 0.06574, 'High': 0.06575, 'Low': 0.06564, 'Close': 0.06567, 'Volume': 348165.0, 'close_time': 1626670000000.0, 'quote_av': 22871.0, 'trades': 96.0, 'tb_base_av': 107365.0, 'tb_quote_av': 7052.32, 'ignore': 0.0}, {'Datetime': '2021-07-19 04:05:00', 'Open': 0.06567, 'High': 0.0657, 'Low': 0.06564, 'Close': 0.06568, 'Volume': 247416.0, 'close_time': 1626670000000.0, 'quote_av': 16246.6, 'trades': 87.0, 'tb_base_av': 172202.0, 'tb_quote_av': 11308.0, 'ignore': 0.0}, {'Datetime': '2021-07-19 04:06:00', 'Open': 0.06567, 'High': 0.0657, 'Low': 0.06565, 'Close': 0.06569, 'Volume': 242348.0, 'close_time': 1626670000000.0, 'quote_av': 15915.3, 'trades': 60.0, 'tb_base_av': 135984.0, 'tb_quote_av': 8931.27, 'ignore': 0.0}, {'Datetime': '2021-07-19 04:07:00', 'Open': 0.06569, 'High': 0.06573, 'Low': 0.06564, 'Close': 0.06565, 'Volume': 205198.0, 'close_time': 1626670000000.0, 'quote_av': 13480.8, 'trades': 83.0, 'tb_base_av': 33625.0, 'tb_quote_av': 2209.12, 'ignore': 0.0}, {'Datetime': '2021-07-19 04:08:00', 'Open': 0.06565, 'High': 0.06565, 'Low': 0.06546, 'Close': 0.06548, 'Volume': 597047.0, 'close_time': 1626670000000.0, 'quote_av': 39126.4, 'trades': 179.0, 'tb_base_av': 225905.0, 'tb_quote_av': 14803.8, 'ignore': 0.0}, {'Datetime': '2021-07-19 04:09:00', 'Open': 0.06547, 'High': 0.06556, 'Low': 0.06542, 'Close': 0.0655, 'Volume': 1032070.0, 'close_time': 1626670000000.0, 'quote_av': 67595.7, 'trades': 172.0, 'tb_base_av': 305269.0, 'tb_quote_av': 19995.6, 'ignore': 0.0}, {'Datetime': '2021-07-19 04:10:00', 'Open': 0.06549, 'High': 0.0656, 'Low': 0.06549, 'Close': 0.06554, 'Volume': 366054.0, 'close_time': 1626670000000.0, 'quote_av': 23993.2, 'trades': 114.0, 'tb_base_av': 120061.0, 'tb_quote_av': 7869.53, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2021-08-22 21:21:00', 'Open': 0.12466, 'High': 0.12473, 'Low': 0.12466, 'Close': 0.12472, 'Volume': 47036.0, 'close_time': 1629670000000.0, 'quote_av': 5865.4, 'trades': 50.0, 'tb_base_av': 17801.0, 'tb_quote_av': 2219.6, 'ignore': 0.0}, {'Datetime': '2021-08-22 21:22:00', 'Open': 0.12472, 'High': 0.12472, 'Low': 0.12443, 'Close': 0.12471, 'Volume': 505865.0, 'close_time': 1629670000000.0, 'quote_av': 63028.7, 'trades': 155.0, 'tb_base_av': 210570.0, 'tb_quote_av': 26239.0, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-02-19 14:42 ERROR Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry '2021-08-22 21:23:00' for key 'vetusdt-f.PRIMARY'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/b0457812963/RL_mamba/SynapseX/Database/SQL_operate.py", line 61, in write_Dateframe
    df.to_sql(symbol_name, con=conn,
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 170, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 182, in executemany
    return self._do_execute_many(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 215, in _do_execute_many
    rows += self.execute(sql + postfix)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/b0457812963/RL_mamba/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '2021-08-22 21:23:00' for key 'vetusdt-f.PRIMARY'")
[SQL: INSERT INTO `vetusdt-f` (`Datetime`, `Open`, `High`, `Low`, `Close`, `Volume`, close_time, quote_av, trades, tb_base_av, tb_quote_av, `ignore`) VALUES (%(Datetime)s, %(Open)s, %(High)s, %(Low)s, %(Close)s, %(Volume)s, %(close_time)s, %(quote_av)s, %(trades)s, %(tb_base_av)s, %(tb_quote_av)s, %(ignore)s)]
[parameters: [{'Datetime': '2021-08-22 21:23:00', 'Open': 0.12473, 'High': 0.12475, 'Low': 0.12432, 'Close': 0.12432, 'Volume': 462761.0, 'close_time': 1629670000000.0, 'quote_av': 57620.9, 'trades': 164.0, 'tb_base_av': 133987.0, 'tb_quote_av': 16678.8, 'ignore': 0.0}, {'Datetime': '2021-08-22 21:24:00', 'Open': 0.12433, 'High': 0.12454, 'Low': 0.12431, 'Close': 0.1244, 'Volume': 274125.0, 'close_time': 1629670000000.0, 'quote_av': 34113.7, 'trades': 106.0, 'tb_base_av': 157717.0, 'tb_quote_av': 19623.1, 'ignore': 0.0}, {'Datetime': '2021-08-22 21:25:00', 'Open': 0.12441, 'High': 0.12443, 'Low': 0.12432, 'Close': 0.12435, 'Volume': 177552.0, 'close_time': 1629670000000.0, 'quote_av': 22083.7, 'trades': 105.0, 'tb_base_av': 73720.0, 'tb_quote_av': 9170.97, 'ignore': 0.0}, {'Datetime': '2021-08-22 21:26:00', 'Open': 0.12432, 'High': 0.12433, 'Low': 0.124, 'Close': 0.12405, 'Volume': 428869.0, 'close_time': 1629670000000.0, 'quote_av': 53232.1, 'trades': 167.0, 'tb_base_av': 126326.0, 'tb_quote_av': 15682.7, 'ignore': 0.0}, {'Datetime': '2021-08-22 21:27:00', 'Open': 0.1241, 'High': 0.1241, 'Low': 0.12397, 'Close': 0.12403, 'Volume': 184998.0, 'close_time': 1629670000000.0, 'quote_av': 22949.5, 'trades': 125.0, 'tb_base_av': 95345.0, 'tb_quote_av': 11830.0, 'ignore': 0.0}, {'Datetime': '2021-08-22 21:28:00', 'Open': 0.12401, 'High': 0.12416, 'Low': 0.12398, 'Close': 0.12415, 'Volume': 391905.0, 'close_time': 1629670000000.0, 'quote_av': 48621.7, 'trades': 219.0, 'tb_base_av': 246960.0, 'tb_quote_av': 30640.1, 'ignore': 0.0}, {'Datetime': '2021-08-22 21:29:00', 'Open': 0.12416, 'High': 0.12434, 'Low': 0.12415, 'Close': 0.12432, 'Volume': 423929.0, 'close_time': 1629670000000.0, 'quote_av': 52657.8, 'trades': 111.0, 'tb_base_av': 366955.0, 'tb_quote_av': 45579.9, 'ignore': 0.0}, {'Datetime': '2021-08-22 21:30:00', 'Open': 0.1243, 'High': 0.12442, 'Low': 0.1243, 'Close': 0.12442, 'Volume': 190309.0, 'close_time': 1629670000000.0, 'quote_av': 23670.2, 'trades': 74.0, 'tb_base_av': 134335.0, 'tb_quote_av': 16709.3, 'ignore': 0.0}  ... displaying 10 of 50000 total bound parameter sets ...  {'Datetime': '2021-09-26 14:41:00', 'Open': 0.09094, 'High': 0.09136, 'Low': 0.09094, 'Close': 0.09133, 'Volume': 776619.0, 'close_time': 1632670000000.0, 'quote_av': 70778.9, 'trades': 202.0, 'tb_base_av': 592241.0, 'tb_quote_av': 53972.3, 'ignore': 0.0}, {'Datetime': '2021-09-26 14:42:00', 'Open': 0.09137, 'High': 0.09177, 'Low': 0.09137, 'Close': 0.09147, 'Volume': 1589460.0, 'close_time': 1632670000000.0, 'quote_av': 145599.0, 'trades': 362.0, 'tb_base_av': 885239.0, 'tb_quote_av': 81069.8, 'ignore': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

